<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Plastic - frozenkp's Blog</title>
    <link href="../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Plastic", url: "#_top", children: [
              {title: "Solution", url: "#solution" },
          ]},
        ];

    </script>
    <script src="../../../../js/base.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Trashy_Or_Classy/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Trashy_Or_Classy/" class="btn btn-xs btn-link">
        Trashy Or Classy
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../BambooFox_CTF/infant-gogogo/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../BambooFox_CTF/infant-gogogo/" class="btn btn-xs btn-link">
        infant-gogogo
      </a>
    </div>
    
  </div>

    

    <h1 id="plastic">Plastic</h1>
<blockquote>
<p>Challenge Link: <a href="https://asisctf.com/challenges/">Plastic</a></p>
<p>Category: misc</p>
<p>Writeup: <a href="https://github.com/frozenkp/CTF/tree/master/2018/ASIS_CTF_qual/misc/Plastic">Plastic</a></p>
</blockquote>
<p>Are LaTeX and <a href="https://asisctf.com/tasks/plastic_b3a67f6e7ad52d6ca559d1aafa79c6fd6a80c73360664e7330dd6303d60b789b">PlAsTiC</a> the Same? It seems that they have very different compounds.</p>
<h2 id="solution">Solution</h2>
<p>檔案載下來是一個 PNG 檔</p>
<div class="highlight"><pre><span></span><code>% file plastic
plastic: PNG image data, 1612 x 74, 8-bit/color RGBA, non-interlaced
</code></pre></div>
<p><img alt="" src="https://i.imgur.com/lSItWe9.png" /></p>
<p>用 strings 看一下，可以發現奇怪的資料</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;x:xmpmeta</span> <span class="na">xmlns:x=</span><span class="s">&quot;adobe:ns:meta/&quot;</span> <span class="na">x:xmptk=</span><span class="s">&quot;XMP Core 5.4.0&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;rdf:RDF</span> <span class="na">xmlns:rdf=</span><span class="s">&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;rdf:Description</span> <span class="na">rdf:about=</span><span class="s">&quot;&quot;</span>
            <span class="na">xmlns:exif=</span><span class="s">&quot;http://ns.adobe.com/exif/1.0/&quot;</span>
            <span class="na">xmlns:tiff=</span><span class="s">&quot;http://ns.adobe.com/tiff/1.0/&quot;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;exif:UserComment&gt;</span>
            <span class="nt">&lt;rdf:Alt&gt;</span>
               <span class="nt">&lt;rdf:li</span> <span class="na">xml:lang=</span><span class="s">&quot;x-default&quot;</span><span class="nt">&gt;</span>AAAFWHjabVRfbBRFGJ/ZOeifa+m2hVJaoNf2iohQtndX9ipS29IeVuwVe/1zbfc4<span class="ni">&amp;#xA;</span>5/bm7pbu7V5255DjaDISozExaggxSIxC+2KRqBhjCPFBQwgmPggtSnySFx98IP57<span class="ni">&amp;#xA;</span>ML4590dEw2w2+33fzHzz+37fbyeW0TWbStIdKCDHuvUvngi7jxPL1kwj7DZjx4hK<span class="ni">&amp;#xA;</span>7Vk3ttSUxsOTbmpmGgB85cLHYntFZXtHp7trx2M7H9/1RI+/78DgoWeC4zNhJarG<span class="ni">&amp;#xA;</span>U7pp0ym3kdX1tapqZ02TayYY6l4gOXuOf8t5p92qjm17pXZDnVjf0LhxExMYYg62<span class="ni">&amp;#xA;</span>jq1nFaySVbHqlc3NW1pat27b3sacrIZtYHWsnrWwVraNbWeucAzbRNcMMqWaumlN<span class="ni">&amp;#xA;</span>ps04maIa1Uk4YxGcjukkksZJQ0toKqa8pMk4piQq1sWwupC0zKwRP1jYOGebWUsl<span class="ni">&amp;#xA;</span>k+QE7QTlsbZ7j7N7rzQVDE0cGlKCoeLCUAarZFzcJXX3+fd5fL19/j6/S+qWJLnH<span class="ni">&amp;#xA;</span>I/XxIXsLrkf2eX0Sj/YCEbLaVY/X1ztXKtbAaRIumcSeKadd2if/Y4aDofEiO6Jj<span class="ni">&amp;#xA;</span>1fnk/qdmOV02tTQjycQjPFH/0xx+MDSWpZhXFyrOLPcPyHxfyVkbch4cHgk88Dn0<span class="ni">&amp;#xA;</span>QcqtWJYSmzWwLawxKq4qcVPNpolBi0jme6QMjeSxRTVVJ4vVStYmvNIFnCTz3Cxg<span class="ni">&amp;#xA;</span>tiP5IseLri4eibsSpsVfg7qK0Yd35HHatnPpGF+ZxjRl/3+uEHzU3HyWJvyRvGZk<span class="ni">&amp;#xA;</span>OFJDLR2UyOouarpoLkNccc3ivOg5bmDV0jhWl5rCFlYp12t1QWajh8cuPss2XnyO<span class="ni">&amp;#xA;</span>bWLN08FQgAO8c+T5CWdocmqa+yHtJOHEJAI6TtrcD/LCOgd2lhouiqyJbZ4eMw2s<span class="ni">&amp;#xA;</span>mpzp2blyhqV5uWzxaOQoJ3RYUwtqwlZuKSLz4As4KjY8xHO8RP1STH5kvHNgqHTk<span class="ni">&amp;#xA;</span>KnEmkoUfg2ocyOCXfrLwp/oT28pTasf4mcNcrUsLctkqKDK9Vwr0uPgDWG2h05mR<span class="ni">&amp;#xA;</span>AGsr9fRAXoklXIOh0dCiku+V0l4l6stkbCWa7R1RomNeGXPx+5RofNyQlehonyFN<span class="ni">&amp;#xA;</span>ECVKU96x9nZlkR+ZPR4VGx9I698al7MRuSi6wyRH4oPlq+B27uSkZZqUQVAJ6kEL<span class="ni">&amp;#xA;</span>6AR7gAfIYB5gkAIZkAenwevgDfAWOAPOgrfBOXAevAveAx+AS+Ay+Ah8Aj4Fn4HP<span class="ni">&amp;#xA;</span>wVVwDXwBboBvwC3wPfgR3Ae/Qwesg82wDXZBD4xCDFWYgjY8BV+Gr8I34Tl4Hr4P<span class="ni">&amp;#xA;</span>V+CH8DK8Aq/Dm/AWvAvvwfvwF/gb/EP4WvhWuC2sCd8Jd4UfhHvCz8Kvwl8IoCrk<span class="ni">&amp;#xA;</span>RLWoDjWhVtSButBu1IP60SAKoHl0FNnoFHoJvYbOoLPoHXQBLaNL6Aq6iq6hr9B1<span class="ni">&amp;#xA;</span>dAPddFQ4ahwdjh0Ov2O/Y6DUQQGWr4s8+M9wDP0NfUGwlA==<span class="ni">&amp;#xA;</span><span class="nt">&lt;/rdf:li&gt;</span>
            <span class="nt">&lt;/rdf:Alt&gt;</span>
         <span class="nt">&lt;/exif:UserComment&gt;</span>
         <span class="nt">&lt;tiff:Orientation&gt;</span>1<span class="nt">&lt;/tiff:Orientation&gt;</span>
      <span class="nt">&lt;/rdf:Description&gt;</span>
   <span class="nt">&lt;/rdf:RDF&gt;</span>
<span class="nt">&lt;/x:xmpmeta&gt;</span>
</code></pre></div>
<p>把中間那段整理一下，看起來是 23 段經過 base64 的字串，不過解開看不出來是啥</p>
<div class="highlight"><pre><span></span><code>AAAFWHjabVRfbBRFGJ/ZOeifa+m2hVJaoNf2iohQtndX9ipS29IeVuwVe/1zbfc4
5/bm7pbu7V5255DjaDISozExaggxSIxC+2KRqBhjCPFBQwgmPggtSnySFx98IP57
ML4590dEw2w2+33fzHzz+37fbyeW0TWbStIdKCDHuvUvngi7jxPL1kwj7DZjx4hK
7Vk3ttSUxsOTbmpmGgB85cLHYntFZXtHp7trx2M7H9/1RI+/78DgoWeC4zNhJarG
U7pp0ym3kdX1tapqZ02TayYY6l4gOXuOf8t5p92qjm17pXZDnVjf0LhxExMYYg62
jq1nFaySVbHqlc3NW1pat27b3sacrIZtYHWsnrWwVraNbWeucAzbRNcMMqWaumlN
ps04maIa1Uk4YxGcjukkksZJQ0toKqa8pMk4piQq1sWwupC0zKwRP1jYOGebWUsl
k+QE7QTlsbZ7j7N7rzQVDE0cGlKCoeLCUAarZFzcJXX3+fd5fL19/j6/S+qWJLnH
I/XxIXsLrkf2eX0Sj/YCEbLaVY/X1ztXKtbAaRIumcSeKadd2if/Y4aDofEiO6Jj
1fnk/qdmOV02tTQjycQjPFH/0xx+MDSWpZhXFyrOLPcPyHxfyVkbch4cHgk88Dn0
QcqtWJYSmzWwLawxKq4qcVPNpolBi0jme6QMjeSxRTVVJ4vVStYmvNIFnCTz3Cxg
tiP5IseLri4eibsSpsVfg7qK0Yd35HHatnPpGF+ZxjRl/3+uEHzU3HyWJvyRvGZk
OFJDLR2UyOouarpoLkNccc3ivOg5bmDV0jhWl5rCFlYp12t1QWajh8cuPss2XnyO
bWLN08FQgAO8c+T5CWdocmqa+yHtJOHEJAI6TtrcD/LCOgd2lhouiqyJbZ4eMw2s
mpzp2blyhqV5uWzxaOQoJ3RYUwtqwlZuKSLz4As4KjY8xHO8RP1STH5kvHNgqHTk
KnEmkoUfg2ocyOCXfrLwp/oT28pTasf4mcNcrUsLctkqKDK9Vwr0uPgDWG2h05mR
AGsr9fRAXoklXIOh0dCiku+V0l4l6stkbCWa7R1RomNeGXPx+5RofNyQlehonyFN
ECVKU96x9nZlkR+ZPR4VGx9I698al7MRuSi6wyRH4oPlq+B27uSkZZqUQVAJ6kEL
6AR7gAfIYB5gkAIZkAenwevgDfAWOAPOgrfBOXAevAveAx+AS+Ay+Ah8Aj4Fn4HP
wVVwDXwBboBvwC3wPfgR3Ae/Qwesg82wDXZBD4xCDFWYgjY8BV+Gr8I34Tl4Hr4P
V+CH8DK8Aq/Dm/AWvAvvwfvwF/gb/EP4WvhWuC2sCd8Jd4UfhHvCz8Kvwl8IoCrk
RLWoDjWhVtSButBu1IP60SAKoHl0FNnoFHoJvYbOoLPoHXQBLaNL6Aq6iq6hr9B1
dAPddFQ4ahwdjh0Ov2O/Y6DUQQGWr4s8+M9wDP0NfUGwlA==
</code></pre></div>
<p>後來將所有的字串合起來解開後，出現的是一個 data Orz</p>
<p>接著用 binwalk 跑一下，發現裡面還有裝其他東西</p>
<div class="highlight"><pre><span></span><code>% file tmp
tmp: data

% binwalk tmp

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
4             0x4             Zlib compressed data, best compression
</code></pre></div>
<p>解開後出現的是 Apple binary property list ，不過不重要，直接 strings 就可以在裡面找到 flag 了</p>
<div class="highlight"><pre><span></span><code>% file 4
4: Apple binary property list

% strings 4 | grep ASIS
={\bf ASIS}\{50m3\_4pps\_u5E\_M37adat4\_dOn7\_I9n0Re\_th3M!!\}
</code></pre></div>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Trashy_Or_Classy/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Trashy_Or_Classy/" class="btn btn-xs btn-link">
        Trashy Or Classy
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../BambooFox_CTF/infant-gogogo/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../BambooFox_CTF/infant-gogogo/" class="btn btn-xs btn-link">
        infant-gogogo
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
      <p>
        <a href="https://github.com/frozenkp/frozenkp.github.io/edit/master/docs/Writeups/2018/ASIS_CTF_qual/Plastic.md">Edit on frozenkp/frozenkp</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>