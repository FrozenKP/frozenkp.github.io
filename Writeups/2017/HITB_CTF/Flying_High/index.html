<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Flying_High - frozenkp's Blog</title>
    <link href="../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Flying_High", url: "#_top", children: [
              {title: "\u5206\u6790", url: "#_1" },
              {title: "\u5617\u8a66", url: "#_2" },
              {title: "\u89e3\u6cd5", url: "#_3" },
          ]},
        ];

    </script>
    <script src="../../../../js/base.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Pasty/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Pasty/" class="btn btn-xs btn-link">
        Pasty
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../2017_Dating_in_Singapore/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../2017_Dating_in_Singapore/" class="btn btn-xs btn-link">
        2017, Dating in Singapore
      </a>
    </div>
    
  </div>

    

    <h1 id="flying_high">Flying_High</h1>
<blockquote>
<p>Challenge Link: <a href="http://hitb.xctf.org.cn/contest_challenge/">Flying_High</a></p>
<p>Category: MISC</p>
<p>Writeup: <a href="https://github.com/frozenkp/CTF/tree/master/2017/HITB_CTF/MISC/Flying_High">Flying_High</a></p>
</blockquote>
<p>We found a crashed drone, are you able to recover information what this drone was doing?
<a href="http://hitb.xctf.org.cn/media/task/158195de-cd06-4837-98e5-1129101fb2e4.gz">Flying_High.tar.gz</a>:43ce56686b4f38b68108140825434f76bfed47530a92f3a6469c202746c257f2</p>
<h2 id="_1">分析</h2>
<p>附件打開後有四個binanry檔</p>
<div class="highlight"><pre><span></span><code>image0.bin
image1.bin
image2.bin
image3.bin
</code></pre></div>
<p>用binwalk發現裡面有很多檔案</p>
<div class="highlight"><pre><span></span><code>DECIMAL HEXADECIMAL DESCRIPTION
0 0x0 UBIFS filesystem superblock node, CRC: 0x3A905A7, flags: 0x0, min I/O unit size: 2048, erase block size: 126976, erase block count: 58, max erase blocks: 58, format version: 4, compression type: none
…
262144 0x40000 UBIFS filesystem master node, CRC: 0x40782ADA, highest inode: 72, commit number: 61
264192 0x40800 UBIFS filesystem master node, CRC: 0x6D072259, highest inode: 72, commit number: 62
266240 0x41000 UBIFS filesystem master node, CRC: 0x13DCBFF9, highest inode: 72, commit number: 63
268288 0x41800 UBIFS filesystem master node, CRC: 0x1EDB0C74, highest inode: 73, commit number: 64
270336 0x42000 UBIFS filesystem master node, CRC: 0x5E9D0073, highest inode: 73, commit number: 65
272384 0x42800 UBIFS filesystem master node, CRC: 0xFF510C2, highest inode: 74, commit number: 66
274432 0x43000 UBIFS filesystem master node, CRC: 0xB70FE71F, highest inode: 74, commit number: 67
1525808 0x174830 XML document, version: &quot;1.0&quot;
1527856 0x175030 XML document, version: &quot;1.0&quot;
1529904 0x175830 XML document, version: &quot;1.0&quot;
1531952 0x176030 XML document, version: &quot;1.0&quot;
1534000 0x176830 XML document, version: &quot;1.0&quot;
1536048 0x177030 XML document, version: &quot;1.0&quot;
1538168 0x177878 XML document, version: &quot;1.0&quot;
1540144 0x178030 XML document, version: &quot;1.0&quot;
1542192 0x178830 XML document, version: &quot;1.0&quot;
1544240 0x179030 XML document, version: &quot;1.0&quot;
1546288 0x179830 XML document, version: &quot;1.0&quot;
1548336 0x17A030 XML document, version: &quot;1.0&quot;
1550384 0x17A830 XML document, version: &quot;1.0&quot;
1552432 0x17B030 XML document, version: &quot;1.0&quot;
1554480 0x17B830 XML document, version: &quot;1.0&quot;
1556528 0x17C030 XML document, version: &quot;1.0&quot;
1558576 0x17C830 XML document, version: &quot;1.0&quot;
1560624 0x17D030 Zip archive data, at least v2.0 to extract, compressed size: 3725, uncompressed size: 23763, name: FVT1_MB\FVT1_MB.xml
1564398 0x17DEEE Zip archive data, at least v2.0 to extract, compressed size: 1414, uncompressed size: 5298, name: FVT1_MB\SETTINGS\SETTINGS_FVT1_MB_TESTER_1.xml
1565936 0x17E4F0 Zip archive data, at least v2.0 to extract, compressed size: 433, uncompressed size: 1440, name: FVT1_MB\TRACE.xml
1566416 0x17E6D0 Zip archive data, at least v2.0 to extract, compressed size: 1340, uncompressed size: 20339, name: HMI_1_TESTER.xml
1567802 0x17EC3A Zip archive data, at least v2.0 to extract, compressed size: 304, uncompressed size: 815, name: MAIN.xml
…
</code></pre></div>
<h2 id="_2">嘗試</h2>
<p>每個binanry都dump出來看看，內含多個xml檔
- 稍微看了下，不太明白內容是啥
- 用strings掃過，沒找到hitb, flag之類的字眼</p>
<h2 id="_3">解法</h2>
<ul>
<li>
<p>用<code>file</code>確定檔案型別 -&gt; 發現UBIfs
<div class="highlight"><pre><span></span><code>% file image0.bin
image0.bin: UBIfs image, sequence number 1, length 4096, CRC 0x03a905a7
</code></pre></div></p>
</li>
<li>
<p>利用<a href="https://github.com/jrspruitt/ubi_reader/">ubireader</a>拉出完整的目錄結構</p>
</li>
<li>在image3.bin中發現一支影片</li>
</ul>
<p><img alt="flying_high" src="http://i.imgur.com/q4GsGiX.jpg" /></p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Pasty/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Pasty/" class="btn btn-xs btn-link">
        Pasty
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../2017_Dating_in_Singapore/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../2017_Dating_in_Singapore/" class="btn btn-xs btn-link">
        2017, Dating in Singapore
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
      <p>
        <a href="https://github.com/frozenkp/frozenkp.github.io/edit/master/docs/Writeups/2017/HITB_CTF/Flying_High.md">Edit on frozenkp/frozenkp</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>