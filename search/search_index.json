{
    "docs": [
        {
            "location": "/", 
            "text": "Welcome to frozenkp's Blog", 
            "title": "HOME"
        }, 
        {
            "location": "/#welcome-to-frozenkps-blog", 
            "text": "", 
            "title": "Welcome to frozenkp's Blog"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/", 
            "text": "inBINcible\n\n\n\n\nChallenge Link: Nope\n\n\nCategory: reverse\n\n\nWriteup: \ninBINcible\n\n\n\n\nGet the key. The flag is: \u201cNcN_\u201d + sha1sum(key)\n\n\ninbincible\n\n\n\u89c0\u5bdf\n\n\n\u9019\u652f\u7a0b\u5f0f\u57f7\u884c\u5f8c\u76f4\u63a5\u8f38\u51fa \nNope!\n \uff0c\u6c92\u6709\u4efb\u4f55\u8f38\u5165\n\n\n% ./inbincible                   \nNope!\n\n\n\n\n\u8d77\u624b\u5f0f\n\n\n\u9019\u500b\u57f7\u884c\u6a94\u662f 32 \u4f4d\u5143\u7684\uff0c\u4e14\u662f static link\n\n\n% file inbincible\ninbincible: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, not stripped\n\n\n\n\n\u767c\u73fe \nmain.main\n \u61c9\u8a72\u662f go \u7684\u57f7\u884c\u6a94\n\n\n% objdump -M intel -d inbincible\ninbincible\uff1a     \u6a94\u6848\u683c\u5f0f elf32-i386\n\n\nDisassembly of section .text:\n\n08048c00 \nmain.main\n:\n 8048c00:       65 8b 0d 00 00 00 00    mov    ecx,DWORD PTR gs:0x0\n 8048c07:       8b 89 f8 ff ff ff       mov    ecx,DWORD PTR [ecx-0x8]\n 8048c0d:       8d 44 24 c0             lea    eax,[esp-0x40]\n 8048c11:       3b 01                   cmp    eax,DWORD PTR [ecx]\n 8048c13:       77 0b                   ja     8048c20 \nmain.main+0x20\n\n 8048c15:       31 ff                   xor    edi,edi\n 8048c17:       31 c0                   xor    eax,eax\n ...\n\n\n\n\ngo \u8d77\u624b\u5f0f\n\n\n\u7e3d\u5171\u6709\u5169\u500b\u51fd\u5f0f\u5728 main package \u4e2d\n\n\n% go tool objdump inbincible | grep \nTEXT main\\.\n \nTEXT main.main(SB) /home/n/ctf/ncn_quals_2014/rev400/main.go\nTEXT main.func.001(SB) /home/n/ctf/ncn_quals_2014/rev400/main.go\nTEXT main.init(SB) /home/n/ctf/ncn_quals_2014/rev400/main.go\n\n\n\n\n\u5206\u6790 main\n\n\n\u904e\u7a0b\u4e2d\u767c\u73fe\u6709\u53d6\u51fa \nos.Args\n\uff0c\u53ef\u80fd\u662f\u85c9\u7531\u53c3\u6578\u8f38\u5165\n\n\n   0x8048ef1 \nmain.main+753\n:   cmp    DWORD PTR ds:0x814e17c,0x1\n   0x8048ef8 \nmain.main+760\n:   jbe    0x804937d \nmain.main+1917\n\n=\n 0x8048efe \nmain.main+766\n:   mov    ebx,DWORD PTR ds:0x814e178\n   0x8048f04 \nmain.main+772\n:   add    ebx,0x8\n   0x8048f07 \nmain.main+775\n:   mov    esi,DWORD PTR [ebx+0x4]\n\n\n\n\ngdb-peda$ x/10gx 0x814e178\n0x814e178 \nos.Args\n:    0x0000000218300000      0x0000000000000002\n0x814e188 \npersistent\n: 0xf7fc91a400000000      0x00000000f7ff9000\n0x814e198 \nreflect.dummy\n:      0x0000000000000000      0x0000000000000000\n0x814e1a8 \nsync.allPools\n:      0x000000000814e03c      0x0000000000000000\n0x814e1b8 \nsyscall.envs\n:       0x0000004e1830e000      0x000000000000004e\n\n\n\n\n\u63a5\u8457\u6bd4\u8f03 \nesi\n \u548c \nebp\n \uff0c\u6b64\u6642\u7684 \nebp\n \u662f\u56fa\u5b9a\u7684 \n0x10\n \uff0c\u800c \nesi\n \u662f\u53c3\u6578\u7684\u9577\u5ea6\n\n\n\u731c\u6e2c\u53c3\u6578\u9577\u5ea6\u61c9\u8a72\u8981\u662f \n0x10\n\n\n   0x8048f07 \nmain.main+775\n:   mov    esi,DWORD PTR [ebx+0x4]\n   0x8048f0a \nmain.main+778\n:   mov    ebx,DWORD PTR [esp+0x6c]\n   0x8048f0e \nmain.main+782\n:   mov    ebp,DWORD PTR [ebx+0x4]\n=\n 0x8048f11 \nmain.main+785\n:   cmp    esi,ebp\n   0x8048f13 \nmain.main+787\n:   je     0x8049048 \nmain.main+1096\n\n   0x8048f19 \nmain.main+793\n:   xor    ecx,ecx\n   0x8048f1b \nmain.main+795\n:   mov    ebp,DWORD PTR [esp+0x88]\n\n\n\n\n\u5206\u6790 func.001\n\n\n\u5728\u4e2d\u9593\u767c\u73fe reverse \u984c\u5e38\u898b\u7684 xor \uff0c\u76ee\u6a19\u662f \necx\n \u53ca \nebp\n \n\n\n\u6b64\u6642\u7684 \necx\n \u662f \n0x12\n \uff0c\nebp\n \u5247\u662f\u53c3\u6578\u7684\u7b2c\u4e00\u500b\u5b57\nx47 ( 'G' )\n\n\n0x8049456 \nmain.func+150\n:   xor    ecx,ebp\n\n\n\n\n\u63a5\u8457\u6bd4\u8f03\u4e86 \ncl\n \u53ca \nal\n\n\n\u6b64\u6642\u7684 \ncl\n \u662f xor \u7684\u7d50\u679c\uff0c\nal\n \u662f\u524d\u9762\u53d6\u51fa\u7684\u503c\n\n\n0x804946a \nmain.func+170\n:   cmp    cl,al\n\n\n\n\n\u5982\u679c\u5169\u8005\u4e00\u6a23\u7684\u8a71\uff0c\u6703\u900f\u904e go channel \u9001\u51fa 0x1 \u7d66 main\n\n\n\u731c\u6e2c\u53ef\u80fd\u662f\u53ea\u8981 16 \u500b\u5b57\u7d93\u904e xor \u4ee5\u5f8c\u90fd\u4e00\u6a23\u5c31\u53ef\u4ee5\u901a\u904e\u4e86\n\n\n\u89e3\u6cd5\n\n\n\u56e0\u70ba xor \u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e00\u6a23\u7684 key \u4f86\u627e\u5230\u539f\u59cb\u5b57\u4e32\uff0c\u6240\u4ee5\u53ea\u8981\u53d6\u51fa xor key \u4ee5\u53ca\u6700\u5f8c\u7684\u7b54\u6848\u5c31\u53ef\u4ee5\u4e86\n\n\nxor key\n\n\n\u5be6\u969b\u67e5\u770b\u8a72\u4f4d\u7f6e\u5f8c\u767c\u73fe key \u53ea\u6709 5 bytes \uff0c\u7d93\u904e\u6e2c\u8a66\u5f8c\u767c\u73fe\u9019 5 bytes \u6703\u4e00\u76f4\u5faa\u74b0\n\n\n\u4e5f\u5c31\u662f \n0x12, 0x45, 0x33, 0x87, 0x65, 0x12, 0x45, 0x33, 0x87, 0x65, 0x12, 0x45, 0x33, 0x87, 0x65, 0x12\n\n\ngdb-peda$ x/2gx 0x18300024-0x8\n0x1830001c:     0x4533876500000000      0x0000000000000012\n\n\n\n\nans\n\n\ngdb-peda$ x/2gx 0x18300040\n0x18300040:     0x0306330bb6447555      0x3344b247716002e9\n\n\n\n\nxor\n\n\n\u5c07\u5169\u500b\u5b57\u4e32\u7d93\u904e xor \u4ee5\u5f8c\u5c31\u53ef\u4ee5\u5f97\u5230\u539f\u5b57\u4e32 \nG0w1n!C0ngr4t5!!", 
            "title": "inBINcible"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#inbincible", 
            "text": "Challenge Link: Nope  Category: reverse  Writeup:  inBINcible   Get the key. The flag is: \u201cNcN_\u201d + sha1sum(key)  inbincible", 
            "title": "inBINcible"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#_1", 
            "text": "\u9019\u652f\u7a0b\u5f0f\u57f7\u884c\u5f8c\u76f4\u63a5\u8f38\u51fa  Nope!  \uff0c\u6c92\u6709\u4efb\u4f55\u8f38\u5165  % ./inbincible                   \nNope!", 
            "title": "\u89c0\u5bdf"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#_2", 
            "text": "\u9019\u500b\u57f7\u884c\u6a94\u662f 32 \u4f4d\u5143\u7684\uff0c\u4e14\u662f static link  % file inbincible\ninbincible: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, not stripped  \u767c\u73fe  main.main  \u61c9\u8a72\u662f go \u7684\u57f7\u884c\u6a94  % objdump -M intel -d inbincible\ninbincible\uff1a     \u6a94\u6848\u683c\u5f0f elf32-i386\n\n\nDisassembly of section .text:\n\n08048c00  main.main :\n 8048c00:       65 8b 0d 00 00 00 00    mov    ecx,DWORD PTR gs:0x0\n 8048c07:       8b 89 f8 ff ff ff       mov    ecx,DWORD PTR [ecx-0x8]\n 8048c0d:       8d 44 24 c0             lea    eax,[esp-0x40]\n 8048c11:       3b 01                   cmp    eax,DWORD PTR [ecx]\n 8048c13:       77 0b                   ja     8048c20  main.main+0x20 \n 8048c15:       31 ff                   xor    edi,edi\n 8048c17:       31 c0                   xor    eax,eax\n ...", 
            "title": "\u8d77\u624b\u5f0f"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#go", 
            "text": "\u7e3d\u5171\u6709\u5169\u500b\u51fd\u5f0f\u5728 main package \u4e2d  % go tool objdump inbincible | grep  TEXT main\\.  \nTEXT main.main(SB) /home/n/ctf/ncn_quals_2014/rev400/main.go\nTEXT main.func.001(SB) /home/n/ctf/ncn_quals_2014/rev400/main.go\nTEXT main.init(SB) /home/n/ctf/ncn_quals_2014/rev400/main.go", 
            "title": "go \u8d77\u624b\u5f0f"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#main", 
            "text": "\u904e\u7a0b\u4e2d\u767c\u73fe\u6709\u53d6\u51fa  os.Args \uff0c\u53ef\u80fd\u662f\u85c9\u7531\u53c3\u6578\u8f38\u5165     0x8048ef1  main.main+753 :   cmp    DWORD PTR ds:0x814e17c,0x1\n   0x8048ef8  main.main+760 :   jbe    0x804937d  main.main+1917 \n=  0x8048efe  main.main+766 :   mov    ebx,DWORD PTR ds:0x814e178\n   0x8048f04  main.main+772 :   add    ebx,0x8\n   0x8048f07  main.main+775 :   mov    esi,DWORD PTR [ebx+0x4]  gdb-peda$ x/10gx 0x814e178\n0x814e178  os.Args :    0x0000000218300000      0x0000000000000002\n0x814e188  persistent : 0xf7fc91a400000000      0x00000000f7ff9000\n0x814e198  reflect.dummy :      0x0000000000000000      0x0000000000000000\n0x814e1a8  sync.allPools :      0x000000000814e03c      0x0000000000000000\n0x814e1b8  syscall.envs :       0x0000004e1830e000      0x000000000000004e  \u63a5\u8457\u6bd4\u8f03  esi  \u548c  ebp  \uff0c\u6b64\u6642\u7684  ebp  \u662f\u56fa\u5b9a\u7684  0x10  \uff0c\u800c  esi  \u662f\u53c3\u6578\u7684\u9577\u5ea6  \u731c\u6e2c\u53c3\u6578\u9577\u5ea6\u61c9\u8a72\u8981\u662f  0x10     0x8048f07  main.main+775 :   mov    esi,DWORD PTR [ebx+0x4]\n   0x8048f0a  main.main+778 :   mov    ebx,DWORD PTR [esp+0x6c]\n   0x8048f0e  main.main+782 :   mov    ebp,DWORD PTR [ebx+0x4]\n=  0x8048f11  main.main+785 :   cmp    esi,ebp\n   0x8048f13  main.main+787 :   je     0x8049048  main.main+1096 \n   0x8048f19  main.main+793 :   xor    ecx,ecx\n   0x8048f1b  main.main+795 :   mov    ebp,DWORD PTR [esp+0x88]", 
            "title": "\u5206\u6790 main"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#func001", 
            "text": "\u5728\u4e2d\u9593\u767c\u73fe reverse \u984c\u5e38\u898b\u7684 xor \uff0c\u76ee\u6a19\u662f  ecx  \u53ca  ebp    \u6b64\u6642\u7684  ecx  \u662f  0x12  \uff0c ebp  \u5247\u662f\u53c3\u6578\u7684\u7b2c\u4e00\u500b\u5b57 x47 ( 'G' )  0x8049456  main.func+150 :   xor    ecx,ebp  \u63a5\u8457\u6bd4\u8f03\u4e86  cl  \u53ca  al  \u6b64\u6642\u7684  cl  \u662f xor \u7684\u7d50\u679c\uff0c al  \u662f\u524d\u9762\u53d6\u51fa\u7684\u503c  0x804946a  main.func+170 :   cmp    cl,al  \u5982\u679c\u5169\u8005\u4e00\u6a23\u7684\u8a71\uff0c\u6703\u900f\u904e go channel \u9001\u51fa 0x1 \u7d66 main  \u731c\u6e2c\u53ef\u80fd\u662f\u53ea\u8981 16 \u500b\u5b57\u7d93\u904e xor \u4ee5\u5f8c\u90fd\u4e00\u6a23\u5c31\u53ef\u4ee5\u901a\u904e\u4e86", 
            "title": "\u5206\u6790 func.001"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#_3", 
            "text": "\u56e0\u70ba xor \u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e00\u6a23\u7684 key \u4f86\u627e\u5230\u539f\u59cb\u5b57\u4e32\uff0c\u6240\u4ee5\u53ea\u8981\u53d6\u51fa xor key \u4ee5\u53ca\u6700\u5f8c\u7684\u7b54\u6848\u5c31\u53ef\u4ee5\u4e86", 
            "title": "\u89e3\u6cd5"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#xor-key", 
            "text": "\u5be6\u969b\u67e5\u770b\u8a72\u4f4d\u7f6e\u5f8c\u767c\u73fe key \u53ea\u6709 5 bytes \uff0c\u7d93\u904e\u6e2c\u8a66\u5f8c\u767c\u73fe\u9019 5 bytes \u6703\u4e00\u76f4\u5faa\u74b0  \u4e5f\u5c31\u662f  0x12, 0x45, 0x33, 0x87, 0x65, 0x12, 0x45, 0x33, 0x87, 0x65, 0x12, 0x45, 0x33, 0x87, 0x65, 0x12  gdb-peda$ x/2gx 0x18300024-0x8\n0x1830001c:     0x4533876500000000      0x0000000000000012", 
            "title": "xor key"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#ans", 
            "text": "gdb-peda$ x/2gx 0x18300040\n0x18300040:     0x0306330bb6447555      0x3344b247716002e9", 
            "title": "ans"
        }, 
        {
            "location": "/Writeups/2014/NoConName_qual/inBINcible/#xor", 
            "text": "\u5c07\u5169\u500b\u5b57\u4e32\u7d93\u904e xor \u4ee5\u5f8c\u5c31\u53ef\u4ee5\u5f97\u5230\u539f\u5b57\u4e32  G0w1n!C0ngr4t5!!", 
            "title": "xor"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/", 
            "text": "Delphi\n\n\n\n\nChallenge link: Nope\n\n\nCategory: reverse\n\n\nWriteup: \nDelphi\n\n\n\n\ndelphi\n\n\nlibtwenty.so\n\n\nObservation\n\n\n\u56e0\u70ba\u6709\u984d\u5916\u7d66\u7684 Library \uff0c\u6240\u4ee5\u8981\u57f7\u884c(\u5206\u6790)\u7684\u6642\u5019\u8981\u642d\u914d \nLD_LIBRARY_PATH=.\n \u5c07\u7576\u524d\u8cc7\u6599\u593e\u6307\u5b9a\u7d66 Library \u8def\u5f91\n\n\n$ \nLD_LIBRARY_PATH\n=\n. ./delphi \nWelcome!\n\nAre you ready to play \n20\n questions? No? Perfect!\nI\nm thinking of something big, metal, and orange. Go!\n\n\n test\n\n\nWho\ns that?\n\n deadbeef\nWho\ns that?\n\n\n\n\n\n\nfile\n\n\n$ file ./delphi \n./delphi: ELF \n64\n-bit LSB executable, x86-64, version \n1\n \n(\nSYSV\n)\n, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, \nfor\n GNU/Linux \n2\n.6.32, BuildID\n[\nsha1\n]=\n70886b932f383987896e371d422ab8a4089bd148, not stripped\n\n\n\n\ngo binary\n\n\nObjdump \u5f8c\u767c\u73fe \nmain.main\n \uff0c\u662f go \u7684 binary \u6a94\uff0c\u5176\u4e2d\u5728 main package \u4e2d\u6709\u5169\u500b\u6bd4\u8f03\u7279\u5225\u7684 function\n\n\n\n\nmain.doTheMagic\n\n\nmain._Cfunc_check_answer (cgo \u7684 function)\n\n\n\n\n$ objdump -d delphi \n|\n grep \n.*main.*\n:\n\n0000000000400df0 \n__libc_start_main@plt\n:\n\n0000000000401280\n \nmain.main\n:\n0000000000401c30 \nmain.doTheMagic\n:\n0000000000401df0 \nmain.init\n:\n00000000004021c0 \nmain._Cfunc_CString\n:\n\n0000000000402230\n \nmain._Cfunc_check_answer\n:\n\n0000000000402270\n \nmain._Cfunc_free\n:\n0000000000411b20 \nruntime.main\n:\n00000000004295b0 \nmain\n:\n\n\n\n\nSolution\n\n\nInput\n\n\n\u4e00\u958b\u59cb\u5148\u627e\u770b\u770b\u8f38\u5165\u7684\u5730\u65b9\n\n\n$ go tool objdump delphi \n|\n grep \n.*main\\.go.*Scan\n\n        main.go:34      0x4016ee        bd30b74f00                      MOVL \n$bufio\n.ScanLines.f\n(\nSB\n)\n, BP\n        main.go:35      0x401755        e816b80200                      CALL bufio.\n(\n*Scanner\n)\n.Scan\n(\nSB\n)\n\n\n\n\n\n   0x401747 \nmain.main+1223\n:   mov    QWORD PTR \n[\nrsp+0x48\n]\n,rax\n   0x40174c \nmain.main+1228\n:   mov    rbx,QWORD PTR \n[\nrsp+0x48\n]\n\n   0x401751 \nmain.main+1233\n:   mov    QWORD PTR \n[\nrsp\n]\n,rbx\n\n=\n 0x401755 \nmain.main+1237\n:   call   0x42cf70 \nbufio.\n(\n*Scanner\n)\n.Scan\n\n   0x40175a \nmain.main+1242\n:   movzx  rbx,BYTE PTR \n[\nrsp+0x8\n]\n\n   0x401760 \nmain.main+1248\n:   cmp    bl,0x0\n   0x401763 \nmain.main+1251\n:   je     0x4018b1 \nmain.main+1585\n\n   0x401769 \nmain.main+1257\n:   mov    rdi,QWORD PTR \n[\nrsp+0x48\n]\n\nGuessed arguments:\narg\n[\n0\n]\n: 0xc208028130 --\n 0x0 \narg\n[\n1\n]\n: 0x7ffff7e20df0 --\n 0xc208020000 --\n 0x0 \n\n\n\n\n\u8f38\u5165 deadbeef \u5f8c\u7e7c\u7e8c\u89c0\u5bdf\n\n\n\u767c\u73fe\u5f8c\u9762\u51fa\u73fe\u4e00\u6bb5\u6709\u8da3\u7684\u6bd4\u8f03\uff0c\u6b64\u6642\u7684 \nrdx\n \u662f\u8f38\u5165\u7684\u9577\u5ea6\uff0c\nrax\n \u662f 'go' \u7684\u9577\u5ea6\n\n\n\u7531\u5e95\u4e0b \njl\n \u548c \njb\n \u53ef\u77e5 \n\u8f38\u5165\u4e0d\u80fd\u5c0f\u65bc 2 \n\n\nRAX: 0x2 \nRBX: 0x4d7f60 --\n 0x4d7f70 --\n 0x6f67 \n(\ngo\n)\n\nRCX: 0x66656562 \n(\nbeef\n)\n\nRDX: 0x8 \nRSI: 0x4d7f70 --\n 0x6f67 \n(\ngo\n)\n\nRDI: 0xc208000260 \n(\ndeadbeef\n)\n\nRBP: 0x7ffff7fb3000 --\n 0x781d28 \n(\n0x00007ffff7fb3000\n)\n\nRSP: 0x7ffff7e20dc0 --\n 0xc208013000 \n(\ndeadbeef\\n\n)\n\n\n[\n-------------------------------------code-------------------------------------\n]\n\n   0x401939 \nmain.main+1721\n:   mov    rax,QWORD PTR \n[\nrbx+0x8\n]\n\n   0x40193d \nmain.main+1725\n:   mov    QWORD PTR \n[\nrsp+0x90\n]\n,rdx\n   0x401945 \nmain.main+1733\n:   mov    QWORD PTR \n[\nrsp+0xb0\n]\n,rax\n\n=\n 0x40194d \nmain.main+1741\n:   cmp    rdx,rax\n   0x401950 \nmain.main+1744\n:   jl     0x401baa \nmain.main+2346\n\n   0x401956 \nmain.main+1750\n:   cmp    rdx,rax\n   0x401959 \nmain.main+1753\n:   jb     0x401bb2 \nmain.main+2354\n\n   0x40195f \nmain.main+1759\n:   mov    QWORD PTR \n[\nrsp+0xb8\n]\n,rdi\n\n\n\n\n\u518d\u5f80\u4e0b\u770b\uff0c\u51fa\u73fe\u4e86 \nruntime.eqstring\n \n\n\n\u6bd4\u8f03\u7684\u76ee\u6a19\u662f \u8f38\u5165 ( 'deadbeef' ) \u4ee5\u53ca 'go' \u7684\u524d\u5169\u500b byte (0x2)\n\n\n   0x401986 \nmain.main+1798\n:   mov    QWORD PTR \n[\nrsp+0x18\n]\n,rax\n\n=\n 0x40198b \nmain.main+1803\n:   call   0x425600 \nruntime.eqstring\n\n   0x401990 \nmain.main+1808\n:   movzx  rbx,BYTE PTR \n[\nrsp+0x20\n]\n\n\n[\n------------------------------------stack-------------------------------------\n]\n\n\n0000\n|\n 0x7ffff7e20dc0 --\n 0xc208000260 \n(\ndeadbeef\n)\n\n\n0008\n|\n 0x7ffff7e20dc8 --\n 0x2 \n\n0016\n|\n 0x7ffff7e20dd0 --\n 0x4d7f70 --\n 0x6f67 \n(\ngo\n)\n\n\n0024\n|\n 0x7ffff7e20dd8 --\n 0x2\n\n\n\n\n\u5be6\u969b\u6e2c\u8a66\u4e00\u4e0b\uff0c\u679c\u7136\u8f38\u5165\u958b\u982d\u662f go \u7684\u8a71\u5c31\u6703\u51fa\u73fe\u4e0d\u4e00\u6a23\u7684\u7d50\u679c\n\n\nLD_LIBRARY_PATH\n=\n. ./delphi \nWelcome!\n\nAre you ready to play \n20\n questions? No? Perfect!\nI\nm thinking of something big, metal, and orange. Go!\n\n\n goabcd\n\n\nSneaky, sneaky. Go where? How fast?\n\n\n go\n\n\nSneaky, sneaky. Go where? How fast?\n\n\n abcd\n\n\nWho\ns that?\n\n \n\n\n\n\n\u6bd4\u5c0d\u6b63\u78ba\u5f8c\u5c31\u6703\u9032\u5165 \nmain.doTheMagic\n \u4e86\n\n\n   0x401a0d \nmain.main+1933\n:   mov    QWORD PTR \n[\nrsp+0x8\n]\n,rax\n\n=\n 0x401a12 \nmain.main+1938\n:   call   0x401c30 \nmain.doTheMagic\n\n   0x401a17 \nmain.main+1943\n:   lea    rbx,ds:0x4d4060\n\n\n\n\ndoTheMagic\n\n\n\u7e7c\u7e8c\u5f80\u4e0b\u770b\uff0c\u767c\u73fe \nstrings.Split\n \uff0c\u4ee5\u7a7a\u683c( ' ' )\u4f5c\u70ba\u5207\u5272\u9ede\n\n\n\u7e7c\u7e8c\u57f7\u884c\u5f8c\u5c31\u7d50\u675f\u4e86\n\n\n   0x401c77 \nmain.doTheMagic+71\n:       mov    rdi,rbp\n   0x401c7a \nmain.doTheMagic+74\n:       movs   QWORD PTR es:\n[\nrdi\n]\n,QWORD PTR ds:\n[\nrsi\n]\n\n   0x401c7c \nmain.doTheMagic+76\n:       movs   QWORD PTR es:\n[\nrdi\n]\n,QWORD PTR ds:\n[\nrsi\n]\n\n\n=\n 0x401c7e \nmain.doTheMagic+78\n:       call   0x44a480 \nstrings.Split\n\n   0x401c83 \nmain.doTheMagic+83\n:       mov    rdx,QWORD PTR \n[\nrsp+0x20\n]\n\n   0x401c88 \nmain.doTheMagic+88\n:       mov    rax,QWORD PTR \n[\nrsp+0x28\n]\n\n   0x401c8d \nmain.doTheMagic+93\n:       mov    rcx,QWORD PTR \n[\nrsp+0x30\n]\n\n   0x401c92 \nmain.doTheMagic+98\n:       mov    QWORD PTR \n[\nrsp+0x68\n]\n,rdx\nGuessed arguments:\narg\n[\n0\n]\n: 0x7ffff7e20d40 --\n 0x8 \narg\n[\n1\n]\n: 0x4d37d0 --\n 0x20 \n(\n \n)\n\n\n\n\n\n\u53e6\u5916\u5728\u5f8c\u9762\u53ef\u4ee5\u627e\u5230 \nmain._Cfunc_check_answer\n\n\n401dbf:       e8 6c \n04\n \n00\n \n00\n          callq  \n402230\n \nmain._Cfunc_check_answer\n\n\n\n\n\n\u6211\u731c\u53ef\u80fd\u8f38\u5165\u8981\u7528\u7a7a\u683c\u5206\u6210\u597d\u5e7e\u6bb5\uff0c\u56e0\u6b64\u6211\u5728 \nmain._Cfunc_check_answer\n \u8a2d\u65b7\u9ede\uff0c\u4e26\u586b\u5165\u4e0d\u540c\u6578\u76ee\u7684\u8f38\u5165\u6e2c\u8a66\uff0c\u6700\u5f8c\u767c\u73fe\u9700\u8981\u8f38\u5165\u5171\u4e09\u6bb5\u5c31\u6703\u7d93\u904e\u65b7\u9ede\uff0c\u8f38\u5165\u683c\u5f0f\u5982\u4e0b\n\n\ngo \nsomething\n \nsomething\n\n\n\n\n\ncheck_answer\n\n\n\u5f80\u4e0b\u770b\u767c\u73fe\u4ed6\u5229\u7528 \ncgocall\n \u547c\u53eb\u4e86 \n0x400f80\n\n\n=\n 0x402249 \nmain._Cfunc_check_answer+25\n:      mov    eax,0x400f80\n   0x40224e \nmain._Cfunc_check_answer+30\n:      mov    QWORD PTR \n[\nrsp\n]\n,rax\n   0x402252 \nmain._Cfunc_check_answer+34\n:      lea    rax,\n[\nrsp+0x18\n]\n\n   0x402257 \nmain._Cfunc_check_answer+39\n:      mov    QWORD PTR \n[\nrsp+0x8\n]\n,rax\n   0x40225c \nmain._Cfunc_check_answer+44\n:      call   0x404da0 \nruntime.cgocall\n\n\n\n\n\ngdb-peda$ x/5gi 0x400f80\n   0x400f80 \n_cgo_de3376964270_Cfunc_check_answer\n:     mov    rsi,QWORD PTR \n[\nrdi+0x8\n]\n\n   0x400f84 \n_cgo_de3376964270_Cfunc_check_answer+4\n:   mov    edi,DWORD PTR \n[\nrdi\n]\n\n   0x400f86 \n_cgo_de3376964270_Cfunc_check_answer+6\n:   jmp    0x400de0 \ncheck_answer@plt\n\n   0x400f8b:    nop    DWORD PTR \n[\nrax+rax*1+0x0\n]\n\n   0x400f90 \n_cgo_de3376964270_Cfunc_free\n:     mov    rdi,QWORD PTR \n[\nrdi\n]\n\n\n\n\n\n\u8981\u8ffd\u9032\u53bb\u7684\u8a71\uff0c\u5efa\u8b70\u662f\u5728 \n0x400f80\n \u8a2d\u65b7\u9ede\uff0c\u63a5\u8457 continue \u904e\u53bb\uff0c\u907f\u514d\u4e2d\u9014\u6c92\u8ddf\u5230\n\n\n\u6700\u5f8c\u6703\u56de\u5230 check_answer\n\n\n=\n 0x7ffff7bd5758 \ncheck_answer\n:       push   rbp\n   0x7ffff7bd5759 \ncheck_answer+1\n:     mov    rbp,rsp\n   0x7ffff7bd575c \ncheck_answer+4\n:     sub    rsp,0xa0\n   0x7ffff7bd5763 \ncheck_answer+11\n:    mov    DWORD PTR \n[\nrbp-0x94\n]\n,edi\n   0x7ffff7bd5769 \ncheck_answer+17\n:    mov    QWORD PTR \n[\nrbp-0xa0\n]\n,rsi\n\n\n\n\n\u5f80\u4e0b\u8ffd\u6703\u51fa\u73fe\u4e00\u500b\u6709\u8da3\u7684\u6771\u897f\n\n\n\u6b64\u6642\u7684 \neax\n \u662f\u6700\u5f8c\u4e00\u6bb5\u8f38\u5165\u7684\u503c\uff0c\u56e0\u70ba\u6211\u8f38\u5165\u7684\u662f \ngo abc def\n \uff0c\u6240\u4ee5\u9019\u908a\u7684 eax \u56e0\u7232\u8f49\u4e0d\u51fa\u4f86\u6240\u4ee5\u8b8a\u6210 0\n\n\nadd \u5f8c\u8b8a\u6210 42\uff0c\u7531\u6b64\u53ef\u77e5 [rbp-0x2] \u539f\u59cb\u503c\u61c9\u8a72\u662f 42\n\n\n   0x7ffff7bd5789 \ncheck_answer+49\n:    mov    eax,DWORD PTR \n[\nrbp-0x94\n]\n\n\n=\n 0x7ffff7bd578f \ncheck_answer+55\n:    add    WORD PTR \n[\nrbp-0x2\n]\n,ax\n   0x7ffff7bd5793 \ncheck_answer+59\n:    movzx  eax,WORD PTR \n[\nrbp-0x2\n]\n\n   0x7ffff7bd5797 \ncheck_answer+63\n:    cmp    eax,0x4\n   0x7ffff7bd579a \ncheck_answer+66\n:    ja     0x7ffff7bd57ed \ncheck_answer+149\n\n\n\n\n\n\u5982\u679c\u6bd4\u8f03\u7b26\u5408\u5f8c\u8df3\u904e\u53bb\uff0c\u6703\u51fa\u73fe \nstrcat\n \u4ee5\u53ca \nsystem\n \n\n\n\u5728 stack \u4e2d\u53ef\u4ee5\u770b\u5230 \u2019echo' \u4ee5\u53ca\u7b2c\u4e8c\u6bb5\u8f38\u5165 'abc' \uff0c\u770b\u4f86\u662f\u5408\u6210 'echo abc' \u4ee5\u5f8c\u5229\u7528 system \u57f7\u884c\n\n\n=\n 0x7ffff7bd57d7 \ncheck_answer+127\n:   call   0x7ffff7bd5650 \nstrcat@plt\n\n   0x7ffff7bd57dc \ncheck_answer+132\n:   lea    rax,\n[\nrbp-0x90\n]\n\n   0x7ffff7bd57e3 \ncheck_answer+139\n:   mov    rdi,rax\n   0x7ffff7bd57e6 \ncheck_answer+142\n:   call   0x7ffff7bd5630 \nsystem@plt\n\n\n[\n------------------------------------stack-------------------------------------\n]\n\n\n0000\n|\n 0x7fffffffe4f0 --\n 0x788170 --\n 0x636261 \n(\nabc\n)\n\n\n0008\n|\n 0x7fffffffe4f8 --\n 0x0 \n\n0016\n|\n 0x7fffffffe500 --\n 0x206f686365 \n(\necho \n)\n\n\n\n\n\n\u7d9c\u5408\u4e0a\u8ff0\uff0c\u6211\u5011\u61c9\u8a72\u8981\u4f7f 42 + {number} \n= 4\n\n\n\u9019\u88e1\u6709\u500b\u6709\u8da3\u7684\u5730\u65b9\uff0c\u4ed6\u5728\u53d6\u503c\u7684\u6642\u5019\u662f\u4f7f\u7528 WORD (2 bytes) \u4f86\u53d6\uff0c\u7576\u9019\u88e1\u7684\u503c\u8d85\u904e WORD \u4e0a\u9650\u6642\u5c31\u6703\u6b78\u96f6\uff0c\u6211\u5011\u53ef\u4ee5\u5229\u7528\u9019\u500b\u9ede\u4f86\u9054\u6210\u4e0a\u8ff0\u7684\u689d\u4ef6\n\n\nnumber = 2^16 - 42 + eax\n\n\n\n\ncommand injection\n\n\n\u524d\u9762\u6709\u770b\u5230\u7d44\u5408\u7684 'echo abc' \uff0c\u6b64\u6642\u53ef\u4ee5\u5229\u7528 \n;\n \u4f86\u9032\u884c command injection \u4f86\u62ff\u5230 shell\n\n\n$ \nLD_LIBRARY_PATH\n=\n. ./delphi \nWelcome!\n\nAre you ready to play \n20\n questions? No? Perfect!\nI\nm thinking of something big, metal, and orange. Go!\n\n go abc\n;\n/bin/sh \n65498\n              \n# 2^16 - 42 + 4 (eax = 4)\n\nabc\n$ ls\ndelphi  libtwenty.so  peda-session-delphi.txt\n$", 
            "title": "Delphi"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#delphi", 
            "text": "Challenge link: Nope  Category: reverse  Writeup:  Delphi   delphi  libtwenty.so", 
            "title": "Delphi"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#observation", 
            "text": "\u56e0\u70ba\u6709\u984d\u5916\u7d66\u7684 Library \uff0c\u6240\u4ee5\u8981\u57f7\u884c(\u5206\u6790)\u7684\u6642\u5019\u8981\u642d\u914d  LD_LIBRARY_PATH=.  \u5c07\u7576\u524d\u8cc7\u6599\u593e\u6307\u5b9a\u7d66 Library \u8def\u5f91  $  LD_LIBRARY_PATH = . ./delphi \nWelcome!\n\nAre you ready to play  20  questions? No? Perfect!\nI m thinking of something big, metal, and orange. Go!   test  Who s that?  deadbeef\nWho s that?", 
            "title": "Observation"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#file", 
            "text": "$ file ./delphi \n./delphi: ELF  64 -bit LSB executable, x86-64, version  1   ( SYSV ) , dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2,  for  GNU/Linux  2 .6.32, BuildID [ sha1 ]= 70886b932f383987896e371d422ab8a4089bd148, not stripped", 
            "title": "file"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#go-binary", 
            "text": "Objdump \u5f8c\u767c\u73fe  main.main  \uff0c\u662f go \u7684 binary \u6a94\uff0c\u5176\u4e2d\u5728 main package \u4e2d\u6709\u5169\u500b\u6bd4\u8f03\u7279\u5225\u7684 function   main.doTheMagic  main._Cfunc_check_answer (cgo \u7684 function)   $ objdump -d delphi  |  grep  .*main.* : \n0000000000400df0  __libc_start_main@plt : 0000000000401280   main.main :\n0000000000401c30  main.doTheMagic :\n0000000000401df0  main.init :\n00000000004021c0  main._Cfunc_CString : 0000000000402230   main._Cfunc_check_answer : 0000000000402270   main._Cfunc_free :\n0000000000411b20  runtime.main :\n00000000004295b0  main :", 
            "title": "go binary"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#solution", 
            "text": "", 
            "title": "Solution"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#input", 
            "text": "\u4e00\u958b\u59cb\u5148\u627e\u770b\u770b\u8f38\u5165\u7684\u5730\u65b9  $ go tool objdump delphi  |  grep  .*main\\.go.*Scan \n        main.go:34      0x4016ee        bd30b74f00                      MOVL  $bufio .ScanLines.f ( SB ) , BP\n        main.go:35      0x401755        e816b80200                      CALL bufio. ( *Scanner ) .Scan ( SB )      0x401747  main.main+1223 :   mov    QWORD PTR  [ rsp+0x48 ] ,rax\n   0x40174c  main.main+1228 :   mov    rbx,QWORD PTR  [ rsp+0x48 ] \n   0x401751  main.main+1233 :   mov    QWORD PTR  [ rsp ] ,rbx =  0x401755  main.main+1237 :   call   0x42cf70  bufio. ( *Scanner ) .Scan \n   0x40175a  main.main+1242 :   movzx  rbx,BYTE PTR  [ rsp+0x8 ] \n   0x401760  main.main+1248 :   cmp    bl,0x0\n   0x401763  main.main+1251 :   je     0x4018b1  main.main+1585 \n   0x401769  main.main+1257 :   mov    rdi,QWORD PTR  [ rsp+0x48 ] \nGuessed arguments:\narg [ 0 ] : 0xc208028130 --  0x0 \narg [ 1 ] : 0x7ffff7e20df0 --  0xc208020000 --  0x0   \u8f38\u5165 deadbeef \u5f8c\u7e7c\u7e8c\u89c0\u5bdf  \u767c\u73fe\u5f8c\u9762\u51fa\u73fe\u4e00\u6bb5\u6709\u8da3\u7684\u6bd4\u8f03\uff0c\u6b64\u6642\u7684  rdx  \u662f\u8f38\u5165\u7684\u9577\u5ea6\uff0c rax  \u662f 'go' \u7684\u9577\u5ea6  \u7531\u5e95\u4e0b  jl  \u548c  jb  \u53ef\u77e5  \u8f38\u5165\u4e0d\u80fd\u5c0f\u65bc 2   RAX: 0x2 \nRBX: 0x4d7f60 --  0x4d7f70 --  0x6f67  ( go ) \nRCX: 0x66656562  ( beef ) \nRDX: 0x8 \nRSI: 0x4d7f70 --  0x6f67  ( go ) \nRDI: 0xc208000260  ( deadbeef ) \nRBP: 0x7ffff7fb3000 --  0x781d28  ( 0x00007ffff7fb3000 ) \nRSP: 0x7ffff7e20dc0 --  0xc208013000  ( deadbeef\\n )  [ -------------------------------------code------------------------------------- ] \n   0x401939  main.main+1721 :   mov    rax,QWORD PTR  [ rbx+0x8 ] \n   0x40193d  main.main+1725 :   mov    QWORD PTR  [ rsp+0x90 ] ,rdx\n   0x401945  main.main+1733 :   mov    QWORD PTR  [ rsp+0xb0 ] ,rax =  0x40194d  main.main+1741 :   cmp    rdx,rax\n   0x401950  main.main+1744 :   jl     0x401baa  main.main+2346 \n   0x401956  main.main+1750 :   cmp    rdx,rax\n   0x401959  main.main+1753 :   jb     0x401bb2  main.main+2354 \n   0x40195f  main.main+1759 :   mov    QWORD PTR  [ rsp+0xb8 ] ,rdi  \u518d\u5f80\u4e0b\u770b\uff0c\u51fa\u73fe\u4e86  runtime.eqstring    \u6bd4\u8f03\u7684\u76ee\u6a19\u662f \u8f38\u5165 ( 'deadbeef' ) \u4ee5\u53ca 'go' \u7684\u524d\u5169\u500b byte (0x2)     0x401986  main.main+1798 :   mov    QWORD PTR  [ rsp+0x18 ] ,rax =  0x40198b  main.main+1803 :   call   0x425600  runtime.eqstring \n   0x401990  main.main+1808 :   movzx  rbx,BYTE PTR  [ rsp+0x20 ]  [ ------------------------------------stack------------------------------------- ]  0000 |  0x7ffff7e20dc0 --  0xc208000260  ( deadbeef )  0008 |  0x7ffff7e20dc8 --  0x2  0016 |  0x7ffff7e20dd0 --  0x4d7f70 --  0x6f67  ( go )  0024 |  0x7ffff7e20dd8 --  0x2  \u5be6\u969b\u6e2c\u8a66\u4e00\u4e0b\uff0c\u679c\u7136\u8f38\u5165\u958b\u982d\u662f go \u7684\u8a71\u5c31\u6703\u51fa\u73fe\u4e0d\u4e00\u6a23\u7684\u7d50\u679c  LD_LIBRARY_PATH = . ./delphi \nWelcome!\n\nAre you ready to play  20  questions? No? Perfect!\nI m thinking of something big, metal, and orange. Go!   goabcd  Sneaky, sneaky. Go where? How fast?   go  Sneaky, sneaky. Go where? How fast?   abcd  Who s that?    \u6bd4\u5c0d\u6b63\u78ba\u5f8c\u5c31\u6703\u9032\u5165  main.doTheMagic  \u4e86     0x401a0d  main.main+1933 :   mov    QWORD PTR  [ rsp+0x8 ] ,rax =  0x401a12  main.main+1938 :   call   0x401c30  main.doTheMagic \n   0x401a17  main.main+1943 :   lea    rbx,ds:0x4d4060", 
            "title": "Input"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#dothemagic", 
            "text": "\u7e7c\u7e8c\u5f80\u4e0b\u770b\uff0c\u767c\u73fe  strings.Split  \uff0c\u4ee5\u7a7a\u683c( ' ' )\u4f5c\u70ba\u5207\u5272\u9ede  \u7e7c\u7e8c\u57f7\u884c\u5f8c\u5c31\u7d50\u675f\u4e86     0x401c77  main.doTheMagic+71 :       mov    rdi,rbp\n   0x401c7a  main.doTheMagic+74 :       movs   QWORD PTR es: [ rdi ] ,QWORD PTR ds: [ rsi ] \n   0x401c7c  main.doTheMagic+76 :       movs   QWORD PTR es: [ rdi ] ,QWORD PTR ds: [ rsi ]  =  0x401c7e  main.doTheMagic+78 :       call   0x44a480  strings.Split \n   0x401c83  main.doTheMagic+83 :       mov    rdx,QWORD PTR  [ rsp+0x20 ] \n   0x401c88  main.doTheMagic+88 :       mov    rax,QWORD PTR  [ rsp+0x28 ] \n   0x401c8d  main.doTheMagic+93 :       mov    rcx,QWORD PTR  [ rsp+0x30 ] \n   0x401c92  main.doTheMagic+98 :       mov    QWORD PTR  [ rsp+0x68 ] ,rdx\nGuessed arguments:\narg [ 0 ] : 0x7ffff7e20d40 --  0x8 \narg [ 1 ] : 0x4d37d0 --  0x20  (   )   \u53e6\u5916\u5728\u5f8c\u9762\u53ef\u4ee5\u627e\u5230  main._Cfunc_check_answer  401dbf:       e8 6c  04   00   00           callq   402230   main._Cfunc_check_answer   \u6211\u731c\u53ef\u80fd\u8f38\u5165\u8981\u7528\u7a7a\u683c\u5206\u6210\u597d\u5e7e\u6bb5\uff0c\u56e0\u6b64\u6211\u5728  main._Cfunc_check_answer  \u8a2d\u65b7\u9ede\uff0c\u4e26\u586b\u5165\u4e0d\u540c\u6578\u76ee\u7684\u8f38\u5165\u6e2c\u8a66\uff0c\u6700\u5f8c\u767c\u73fe\u9700\u8981\u8f38\u5165\u5171\u4e09\u6bb5\u5c31\u6703\u7d93\u904e\u65b7\u9ede\uff0c\u8f38\u5165\u683c\u5f0f\u5982\u4e0b  go  something   something", 
            "title": "doTheMagic"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#check_answer", 
            "text": "\u5f80\u4e0b\u770b\u767c\u73fe\u4ed6\u5229\u7528  cgocall  \u547c\u53eb\u4e86  0x400f80  =  0x402249  main._Cfunc_check_answer+25 :      mov    eax,0x400f80\n   0x40224e  main._Cfunc_check_answer+30 :      mov    QWORD PTR  [ rsp ] ,rax\n   0x402252  main._Cfunc_check_answer+34 :      lea    rax, [ rsp+0x18 ] \n   0x402257  main._Cfunc_check_answer+39 :      mov    QWORD PTR  [ rsp+0x8 ] ,rax\n   0x40225c  main._Cfunc_check_answer+44 :      call   0x404da0  runtime.cgocall   gdb-peda$ x/5gi 0x400f80\n   0x400f80  _cgo_de3376964270_Cfunc_check_answer :     mov    rsi,QWORD PTR  [ rdi+0x8 ] \n   0x400f84  _cgo_de3376964270_Cfunc_check_answer+4 :   mov    edi,DWORD PTR  [ rdi ] \n   0x400f86  _cgo_de3376964270_Cfunc_check_answer+6 :   jmp    0x400de0  check_answer@plt \n   0x400f8b:    nop    DWORD PTR  [ rax+rax*1+0x0 ] \n   0x400f90  _cgo_de3376964270_Cfunc_free :     mov    rdi,QWORD PTR  [ rdi ]   \u8981\u8ffd\u9032\u53bb\u7684\u8a71\uff0c\u5efa\u8b70\u662f\u5728  0x400f80  \u8a2d\u65b7\u9ede\uff0c\u63a5\u8457 continue \u904e\u53bb\uff0c\u907f\u514d\u4e2d\u9014\u6c92\u8ddf\u5230  \u6700\u5f8c\u6703\u56de\u5230 check_answer  =  0x7ffff7bd5758  check_answer :       push   rbp\n   0x7ffff7bd5759  check_answer+1 :     mov    rbp,rsp\n   0x7ffff7bd575c  check_answer+4 :     sub    rsp,0xa0\n   0x7ffff7bd5763  check_answer+11 :    mov    DWORD PTR  [ rbp-0x94 ] ,edi\n   0x7ffff7bd5769  check_answer+17 :    mov    QWORD PTR  [ rbp-0xa0 ] ,rsi  \u5f80\u4e0b\u8ffd\u6703\u51fa\u73fe\u4e00\u500b\u6709\u8da3\u7684\u6771\u897f  \u6b64\u6642\u7684  eax  \u662f\u6700\u5f8c\u4e00\u6bb5\u8f38\u5165\u7684\u503c\uff0c\u56e0\u70ba\u6211\u8f38\u5165\u7684\u662f  go abc def  \uff0c\u6240\u4ee5\u9019\u908a\u7684 eax \u56e0\u7232\u8f49\u4e0d\u51fa\u4f86\u6240\u4ee5\u8b8a\u6210 0  add \u5f8c\u8b8a\u6210 42\uff0c\u7531\u6b64\u53ef\u77e5 [rbp-0x2] \u539f\u59cb\u503c\u61c9\u8a72\u662f 42     0x7ffff7bd5789  check_answer+49 :    mov    eax,DWORD PTR  [ rbp-0x94 ]  =  0x7ffff7bd578f  check_answer+55 :    add    WORD PTR  [ rbp-0x2 ] ,ax\n   0x7ffff7bd5793  check_answer+59 :    movzx  eax,WORD PTR  [ rbp-0x2 ] \n   0x7ffff7bd5797  check_answer+63 :    cmp    eax,0x4\n   0x7ffff7bd579a  check_answer+66 :    ja     0x7ffff7bd57ed  check_answer+149   \u5982\u679c\u6bd4\u8f03\u7b26\u5408\u5f8c\u8df3\u904e\u53bb\uff0c\u6703\u51fa\u73fe  strcat  \u4ee5\u53ca  system    \u5728 stack \u4e2d\u53ef\u4ee5\u770b\u5230 \u2019echo' \u4ee5\u53ca\u7b2c\u4e8c\u6bb5\u8f38\u5165 'abc' \uff0c\u770b\u4f86\u662f\u5408\u6210 'echo abc' \u4ee5\u5f8c\u5229\u7528 system \u57f7\u884c  =  0x7ffff7bd57d7  check_answer+127 :   call   0x7ffff7bd5650  strcat@plt \n   0x7ffff7bd57dc  check_answer+132 :   lea    rax, [ rbp-0x90 ] \n   0x7ffff7bd57e3  check_answer+139 :   mov    rdi,rax\n   0x7ffff7bd57e6  check_answer+142 :   call   0x7ffff7bd5630  system@plt  [ ------------------------------------stack------------------------------------- ]  0000 |  0x7fffffffe4f0 --  0x788170 --  0x636261  ( abc )  0008 |  0x7fffffffe4f8 --  0x0  0016 |  0x7fffffffe500 --  0x206f686365  ( echo  )   \u7d9c\u5408\u4e0a\u8ff0\uff0c\u6211\u5011\u61c9\u8a72\u8981\u4f7f 42 + {number}  = 4  \u9019\u88e1\u6709\u500b\u6709\u8da3\u7684\u5730\u65b9\uff0c\u4ed6\u5728\u53d6\u503c\u7684\u6642\u5019\u662f\u4f7f\u7528 WORD (2 bytes) \u4f86\u53d6\uff0c\u7576\u9019\u88e1\u7684\u503c\u8d85\u904e WORD \u4e0a\u9650\u6642\u5c31\u6703\u6b78\u96f6\uff0c\u6211\u5011\u53ef\u4ee5\u5229\u7528\u9019\u500b\u9ede\u4f86\u9054\u6210\u4e0a\u8ff0\u7684\u689d\u4ef6  number = 2^16 - 42 + eax", 
            "title": "check_answer"
        }, 
        {
            "location": "/Writeups/2015/B-Sides_Vancouver/Delphi/#command-injection", 
            "text": "\u524d\u9762\u6709\u770b\u5230\u7d44\u5408\u7684 'echo abc' \uff0c\u6b64\u6642\u53ef\u4ee5\u5229\u7528  ;  \u4f86\u9032\u884c command injection \u4f86\u62ff\u5230 shell  $  LD_LIBRARY_PATH = . ./delphi \nWelcome!\n\nAre you ready to play  20  questions? No? Perfect!\nI m thinking of something big, metal, and orange. Go!  go abc ; /bin/sh  65498                # 2^16 - 42 + 4 (eax = 4) \nabc\n$ ls\ndelphi  libtwenty.so  peda-session-delphi.txt\n$", 
            "title": "command injection"
        }
    ]
}